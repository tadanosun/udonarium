(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{2745:(Xe,N,q)=>{"use strict";function M(t){return"function"==typeof t}function O(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const D=O(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function f(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class p{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(M(i))try{i()}catch(o){n=o instanceof D?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{S(o)}catch(s){n=null!=n?n:[],s instanceof D?n=[...n,...s.errors]:n.push(s)}}if(n)throw new D(n)}}add(n){var e;if(n&&n!==this)if(this.closed)S(n);else{if(n instanceof p){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&f(e,n)}remove(n){const{_finalizers:e}=this;e&&f(e,n),n instanceof p&&n._removeParent(this)}}p.EMPTY=(()=>{const t=new p;return t.closed=!0,t})();const C=p.EMPTY;function x(t){return t instanceof p||t&&"closed"in t&&M(t.remove)&&M(t.add)&&M(t.unsubscribe)}function S(t){M(t)?t():t.unsubscribe()}const m={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(t,n,...e){const{delegate:i}=d;return(null==i?void 0:i.setTimeout)?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=d;return((null==n?void 0:n.clearTimeout)||clearTimeout)(t)},delegate:void 0};function _(t){d.setTimeout(()=>{const{onUnhandledError:n}=m;if(!n)throw t;n(t)})}function v(){}const I=Y("C",void 0,void 0);function Y(t,n,e){return{kind:t,value:n,error:e}}let oe=null;function B(t){if(m.useDeprecatedSynchronousErrorHandling){const n=!oe;if(n&&(oe={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=oe;if(oe=null,e)throw i}}else t()}class z extends p{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,x(n)&&n.add(this)):this.destination=fe}static create(n,e,i){return new Ce(n,e,i)}next(n){this.isStopped?b(function L(t){return Y("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?b(function T(t){return Y("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?b(I,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const te=Function.prototype.bind;function ne(t,n){return te.call(t,n)}class K{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){$(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){$(i)}else $(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){$(e)}}}class Ce extends z{constructor(n,e,i){let r;if(super(),M(n)||!n)r={next:null!=n?n:void 0,error:null!=e?e:void 0,complete:null!=i?i:void 0};else{let o;this&&m.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&ne(n.next,o),error:n.error&&ne(n.error,o),complete:n.complete&&ne(n.complete,o)}):r=n}this.destination=new K(r)}}function $(t){m.useDeprecatedSynchronousErrorHandling?function j(t){m.useDeprecatedSynchronousErrorHandling&&oe&&(oe.errorThrown=!0,oe.error=t)}(t):_(t)}function b(t,n){const{onStoppedNotification:e}=m;e&&d.setTimeout(()=>e(t,n))}const fe={closed:!0,next:v,error:function ae(t){throw t},complete:v},Ne="function"==typeof Symbol&&Symbol.observable||"@@observable";function ce(t){return t}let xe=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function Je(t){return t&&t instanceof z||function pe(t){return t&&M(t.next)&&M(t.error)&&M(t.complete)}(t)&&x(t)}(e)?e:new Ce(e,i,r);return B(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=he(i))((r,o)=>{const s=new Ce({next:a=>{try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[Ne](){return this}pipe(...e){return function _e(t){return 0===t.length?ce:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=he(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function he(t){var n;return null!==(n=null!=t?t:m.Promise)&&void 0!==n?n:Promise}const Ve=O(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Re=(()=>{class t extends xe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Wt(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Ve}next(e){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?C:(this.currentObservers=null,o.push(e),new p(()=>{this.currentObservers=null,f(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new xe;return e.source=this,e}}return t.create=(n,e)=>new Wt(n,e),t})();class Wt extends Re{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:C}}function De(t){return n=>{if(function Le(t){return M(null==t?void 0:t.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Pe(t,n,e,i,r){return new ut(t,n,e,i,r)}class ut extends z{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function tt(t,n){return De((e,i)=>{let r=0;e.subscribe(Pe(i,o=>{i.next(t.call(n,o,r++))}))})}function X(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function Dt(t){return this instanceof Dt?(this.v=t,this):new Dt(t)}function Mi(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(g){i[g]&&(r[g]=function(w){return new Promise(function(R,Z){o.push([g,w,R,Z])>1||a(g,w)})})}function a(g,w){try{!function l(g){g.value instanceof Dt?Promise.resolve(g.value.v).then(c,u):h(o[0][2],g)}(i[g](w))}catch(R){h(o[0][3],R)}}function c(g){a("next",g)}function u(g){a("throw",g)}function h(g,w){g(w),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Vi(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function Fe(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}(a,l,(s=t[o](s)).done,s.value)})}}}const Xa=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Ka(t){return M(null==t?void 0:t.then)}function ia(t){return M(t[Ne])}function hr(t){return Symbol.asyncIterator&&M(null==t?void 0:t[Symbol.asyncIterator])}function Xo(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Ec=function Xf(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function xc(t){return M(null==t?void 0:t[Ec])}function Qa(t){return Mi(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Dt(e.read());if(r)return yield Dt(void 0);yield yield Dt(i)}}finally{e.releaseLock()}})}function sd(t){return M(null==t?void 0:t.getReader)}function _o(t){if(t instanceof xe)return t;if(null!=t){if(ia(t))return function Kf(t){return new xe(n=>{const e=t[Ne]();if(M(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Xa(t))return function ad(t){return new xe(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Ka(t))return function Qf(t){return new xe(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,_)})}(t);if(hr(t))return ld(t);if(xc(t))return function Jf(t){return new xe(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(sd(t))return function Ja(t){return ld(Qa(t))}(t)}throw Xo(t)}function ld(t){return new xe(n=>{(function ep(t,n){var e,i,r,o;return function se(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(u){try{c(i.next(u))}catch(h){s(h)}}function l(u){try{c(i.throw(u))}catch(h){s(h)}}function c(u){u.done?o(u.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,l)}c((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Vi(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function vo(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function el(t,n,e=1/0){return M(n)?el((i,r)=>tt((o,s)=>n(i,o,r,s))(_o(t(i,r))),e):("number"==typeof n&&(e=n),De((i,r)=>function cd(t,n,e,i,r,o,s,a){const l=[];let c=0,u=0,h=!1;const g=()=>{h&&!l.length&&!c&&n.complete()},w=Z=>c<i?R(Z):l.push(Z),R=Z=>{o&&n.next(Z),c++;let re=!1;_o(e(Z,u++)).subscribe(Pe(n,le=>{null==r||r(le),o?w(le):n.next(le)},()=>{re=!0},void 0,()=>{if(re)try{for(c--;l.length&&c<i;){const le=l.shift();s?vo(n,s,()=>R(le)):R(le)}g()}catch(le){n.error(le)}}))};return t.subscribe(Pe(n,w,()=>{h=!0,g()})),()=>{null==a||a()}}(i,r,t,e)))}const Tc=new xe(t=>t.complete());function tl(t){return t[t.length-1]}function vs(t,n=0){return De((e,i)=>{e.subscribe(Pe(i,r=>vo(i,t,()=>i.next(r),n),()=>vo(i,t,()=>i.complete(),n),r=>vo(i,t,()=>i.error(r),n)))})}function ys(t,n=0){return De((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function ra(t,n){if(!t)throw new Error("Iterable cannot be null");return new xe(e=>{vo(e,n,()=>{const i=t[Symbol.asyncIterator]();vo(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function qr(t,n){return n?function bs(t,n){if(null!=t){if(ia(t))return function nl(t,n){return _o(t).pipe(ys(n),vs(n))}(t,n);if(Xa(t))return function np(t,n){return new xe(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(Ka(t))return function Sc(t,n){return _o(t).pipe(ys(n),vs(n))}(t,n);if(hr(t))return ra(t,n);if(xc(t))return function ip(t,n){return new xe(e=>{let i;return vo(e,n,()=>{i=t[Ec](),vo(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>M(null==i?void 0:i.return)&&i.return()})}(t,n);if(sd(t))return function tr(t,n){return ra(Qa(t),n)}(t,n)}throw Xo(t)}(t,n):_o(t)}function Xr(...t){const n=function Dc(t){return function dd(t){return t&&M(t.schedule)}(tl(t))?t.pop():void 0}(t),e=function Ko(t,n){return"number"==typeof tl(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?_o(i[0]):function tp(t=1/0){return el(ce,t)}(e)(qr(i,n)):Tc}function nr(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new Ce({next:()=>{i.unsubscribe(),t()}});return n(...e).subscribe(i)}function Vt(t){for(let n in t)if(t[n]===Vt)return n;throw Error("Could not find renamed property on target object.")}function il(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Jt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Jt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function Cs(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const fr=Vt({__forward_ref__:Vt});function nn(t){return t.__forward_ref__=nn,t.toString=function(){return Jt(this())},t}function xt(t){return rl(t)?t():t}function rl(t){return"function"==typeof t&&t.hasOwnProperty(fr)&&t.__forward_ref__===nn}class Ke extends Error{constructor(n,e){super(function ws(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function dt(t){return"string"==typeof t?t:null==t?"":String(t)}function ei(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():dt(t)}function ol(t,n){const e=n?` in ${n}`:"";throw new Ke(-201,`No provider for ${ei(t)} found${e}`)}function pr(t,n){null==t&&function hn(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function It(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function yo(t){return{providers:t.providers||[],imports:t.imports||[]}}function op(t){return W0(t,md)||W0(t,Y0)}function W0(t,n){return t.hasOwnProperty(n)?t[n]:null}function Z0(t){return t&&(t.hasOwnProperty(sp)||t.hasOwnProperty(GS))?t[sp]:null}const md=Vt({\u0275prov:Vt}),sp=Vt({\u0275inj:Vt}),Y0=Vt({ngInjectableDef:Vt}),GS=Vt({ngInjectorDef:Vt});var Ot=(()=>((Ot=Ot||{})[Ot.Default=0]="Default",Ot[Ot.Host=1]="Host",Ot[Ot.Self=2]="Self",Ot[Ot.SkipSelf=4]="SkipSelf",Ot[Ot.Optional=8]="Optional",Ot))();let ap;function Es(t){const n=ap;return ap=t,n}function q0(t,n,e){const i=op(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Ot.Optional?null:void 0!==n?n:void ol(Jt(t),"Injector")}function xs(t){return{toString:t}.toString()}var Kr=(()=>((Kr=Kr||{})[Kr.OnPush=0]="OnPush",Kr[Kr.Default=1]="Default",Kr))(),Qr=(()=>{return(t=Qr||(Qr={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",Qr;var t})();const WS="undefined"!=typeof globalThis&&globalThis,ZS="undefined"!=typeof window&&window,YS="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,dn=WS||"undefined"!=typeof global&&global||ZS||YS,sl={},fn=[],_d=Vt({\u0275cmp:Vt}),lp=Vt({\u0275dir:Vt}),cp=Vt({\u0275pipe:Vt}),X0=Vt({\u0275mod:Vt}),Qo=Vt({\u0275fac:Vt}),Mc=Vt({__NG_ELEMENT_ID__:Vt});let qS=0;function Bt(t){return xs(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Kr.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||fn,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Qr.Emulated,id:"c",styles:t.styles||fn,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,o=t.features,s=t.pipes;return i.id+=qS++,i.inputs=ev(t.inputs,e),i.outputs=ev(t.outputs),o&&o.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(K0):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(Q0):null,i})}function K0(t){return Ai(t)||function Ts(t){return t[lp]||null}(t)}function Q0(t){return function sa(t){return t[cp]||null}(t)}const J0={};function Jo(t){return xs(()=>{const n={type:t.type,bootstrap:t.bootstrap||fn,declarations:t.declarations||fn,imports:t.imports||fn,exports:t.exports||fn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(J0[t.id]=t.type),n})}function ev(t,n){if(null==t)return sl;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,n&&(n[r]=o)}return e}const gt=Bt;function ji(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function Ai(t){return t[_d]||null}function Ar(t,n){const e=t[X0]||null;if(!e&&!0===n)throw new Error(`Type ${Jt(t)} does not have '\u0275mod' property.`);return e}function bo(t){return Array.isArray(t)&&"object"==typeof t[1]}function eo(t){return Array.isArray(t)&&!0===t[1]}function hp(t){return 0!=(8&t.flags)}function Cd(t){return 2==(2&t.flags)}function wd(t){return 1==(1&t.flags)}function to(t){return null!==t.template}function tM(t){return 0!=(512&t[2])}function ua(t,n){return t.hasOwnProperty(Qo)?t[Qo]:null}class rM{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function no(){return nv}function nv(t){return t.type.prototype.ngOnChanges&&(t.setInput=sM),oM}function oM(){const t=rv(this),n=null==t?void 0:t.current;if(n){const e=t.previous;if(e===sl)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function sM(t,n,e,i){const r=rv(t)||function aM(t,n){return t[iv]=n}(t,{previous:sl,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[e],l=s[a];o[a]=new rM(l&&l.currentValue,n,s===sl),t[i]=n}no.ngInherit=!0;const iv="__ngSimpleChanges__";function rv(t){return t[iv]||null}let _p;function kn(t){return!!t.listen}const ov={createRenderer:(t,n)=>function vp(){return void 0!==_p?_p:"undefined"!=typeof document?document:void 0}()};function Zn(t){for(;Array.isArray(t);)t=t[0];return t}function Ed(t,n){return Zn(n[t])}function Pr(t,n){return Zn(n[t.index])}function yp(t,n){return t.data[n]}function dl(t,n){return t[n]}function mr(t,n){const e=n[t];return bo(e)?e:e[0]}function sv(t){return 4==(4&t[2])}function bp(t){return 128==(128&t[2])}function Ds(t,n){return null==n?null:t[n]}function av(t){t[18]=0}function Cp(t,n){t[5]+=n;let e=t,i=t[3];for(;null!==i&&(1===n&&1===e[5]||-1===n&&0===e[5]);)i[5]+=n,e=i,i=i[3]}const St={lFrame:mv(null),bindingsEnabled:!0};function cv(){return St.bindingsEnabled}function Se(){return St.lFrame.lView}function Kt(){return St.lFrame.tView}function Te(t){return St.lFrame.contextLView=t,t[8]}function ii(){let t=uv();for(;null!==t&&64===t.type;)t=t.parent;return t}function uv(){return St.lFrame.currentTNode}function Co(t,n){const e=St.lFrame;e.currentTNode=t,e.isParent=n}function wp(){return St.lFrame.isParent}function Ep(){St.lFrame.isParent=!1}function Hi(){const t=St.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function hl(){return St.lFrame.bindingIndex++}function ts(t){const n=St.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function xM(t,n){const e=St.lFrame;e.bindingIndex=e.bindingRootIndex=t,xp(n)}function xp(t){St.lFrame.currentDirectiveIndex=t}function fv(){return St.lFrame.currentQueryIndex}function Dp(t){St.lFrame.currentQueryIndex=t}function DM(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function pv(t,n,e){if(e&Ot.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&Ot.Host||(r=DM(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;n=r,t=o}const i=St.lFrame=gv();return i.currentTNode=n,i.lView=t,!0}function Td(t){const n=gv(),e=t[1];St.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function gv(){const t=St.lFrame,n=null===t?null:t.child;return null===n?mv(t):n}function mv(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function _v(){const t=St.lFrame;return St.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const vv=_v;function Dd(){const t=_v();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Gi(){return St.lFrame.selectedIndex}function Ss(t){St.lFrame.selectedIndex=t}function An(){const t=St.lFrame;return yp(t.tView,t.selectedIndex)}function Sd(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(t.contentHooks||(t.contentHooks=[])).push(-e,s),a&&((t.contentHooks||(t.contentHooks=[])).push(e,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,a)),l&&(t.viewHooks||(t.viewHooks=[])).push(-e,l),c&&((t.viewHooks||(t.viewHooks=[])).push(e,c),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,c)),null!=u&&(t.destroyHooks||(t.destroyHooks=[])).push(e,u)}}function Md(t,n,e){yv(t,n,3,e)}function kd(t,n,e,i){(3&t[2])===e&&yv(t,n,e,i)}function Sp(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function yv(t,n,e,i){const o=null!=i?i:-1,s=n.length-1;let a=0;for(let l=void 0!==i?65535&t[18]:0;l<s;l++)if("number"==typeof n[l+1]){if(a=n[l],null!=i&&a>=i)break}else n[l]<0&&(t[18]+=65536),(a<o||-1==o)&&(NM(t,e,n,l),t[18]=(4294901760&t[18])+l+2),l++}function NM(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class Pc{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Ad(t,n,e){const i=kn(t);let r=0;for(;r<e.length;){const o=e[r];if("number"==typeof o){if(0!==o)break;r++;const s=e[r++],a=e[r++],l=e[r++];i?t.setAttribute(n,a,l,s):n.setAttributeNS(s,a,l)}else{const s=o,a=e[++r];kp(s)?i&&t.setProperty(n,s,a):i?t.setAttribute(n,s,a):n.setAttribute(s,a),r++}}return r}function bv(t){return 3===t||4===t||6===t}function kp(t){return 64===t.charCodeAt(0)}function Id(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||Cv(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function Cv(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}function wv(t){return-1!==t}function fl(t){return 32767&t}function pl(t,n){let e=function VM(t){return t>>16}(t),i=n;for(;e>0;)i=i[15],e--;return i}let Ap=!0;function Od(t){const n=Ap;return Ap=t,n}let UM=0;function Nc(t,n){const e=Op(t,n);if(-1!==e)return e;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,Ip(i.data,t),Ip(n,null),Ip(i.blueprint,null));const r=Pd(t,n),o=t.injectorIndex;if(wv(r)){const s=fl(r),a=pl(r,n),l=a[1].data;for(let c=0;c<8;c++)n[o+c]=a[s+c]|l[s+c]}return n[o+8]=r,o}function Ip(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Op(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Pd(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){const o=r[1],s=o.type;if(i=2===s?o.declTNode:1===s?r[6]:null,null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function Fd(t,n,e){!function jM(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Mc)&&(i=e[Mc]),null==i&&(i=e[Mc]=UM++);const r=255&i;n.data[t+(r>>5)]|=1<<r}(t,n,e)}function Tv(t,n,e){if(e&Ot.Optional)return t;ol(n,"NodeInjector")}function Dv(t,n,e,i){if(e&Ot.Optional&&void 0===i&&(i=null),0==(e&(Ot.Self|Ot.Host))){const r=t[9],o=Es(void 0);try{return r?r.get(n,i,e&Ot.Optional):q0(n,i,e&Ot.Optional)}finally{Es(o)}}return Tv(i,n,e)}function Sv(t,n,e,i=Ot.Default,r){if(null!==t){const o=function WM(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Mc)?t[Mc]:void 0;return"number"==typeof n?n>=0?255&n:GM:n}(e);if("function"==typeof o){if(!pv(n,t,i))return i&Ot.Host?Tv(r,e,i):Dv(n,e,i,r);try{const s=o(i);if(null!=s||i&Ot.Optional)return s;ol(e)}finally{vv()}}else if("number"==typeof o){let s=null,a=Op(t,n),l=-1,c=i&Ot.Host?n[16][6]:null;for((-1===a||i&Ot.SkipSelf)&&(l=-1===a?Pd(t,n):n[a+8],-1!==l&&Av(i,!1)?(s=n[1],a=fl(l),n=pl(l,n)):a=-1);-1!==a;){const u=n[1];if(kv(o,a,u.data)){const h=$M(a,n,e,s,i,c);if(h!==Mv)return h}l=n[a+8],-1!==l&&Av(i,n[1].data[a+8]===c)&&kv(o,a,n)?(s=u,a=fl(l),n=pl(l,n)):a=-1}}}return Dv(n,e,i,r)}const Mv={};function GM(){return new gl(ii(),Se())}function $M(t,n,e,i,r,o){const s=n[1],a=s.data[t+8],u=Nd(a,s,e,null==i?Cd(a)&&Ap:i!=s&&0!=(3&a.type),r&Ot.Host&&o===a);return null!==u?Rc(n,s,u,a):Mv}function Nd(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,l=t.directiveStart,u=o>>20,g=r?a+u:t.directiveEnd;for(let w=i?a:a+u;w<g;w++){const R=s[w];if(w<l&&e===R||w>=l&&R.type===e)return w}if(r){const w=s[l];if(w&&to(w)&&w.type===e)return l}return null}function Rc(t,n,e,i){let r=t[e];const o=n.data;if(function RM(t){return t instanceof Pc}(r)){const s=r;s.resolving&&function pd(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new Ke(-200,`Circular dependency in DI detected for ${t}${e}`)}(ei(o[e]));const a=Od(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Es(s.injectImpl):null;pv(t,i,Ot.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function FM(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=nv(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),o&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],n)}finally{null!==l&&Es(l),Od(a),s.resolving=!1,vv()}}return r}function kv(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function Av(t,n){return!(t&Ot.Self||t&Ot.Host&&n)}class gl{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return Sv(this._tNode,this._lView,n,i,e)}}function Oi(t){return xs(()=>{const n=t.prototype.constructor,e=n[Qo]||Pp(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[Qo]||Pp(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Pp(t){return rl(t)?()=>{const n=Pp(xt(t));return n&&n()}:ua(t)}const _l="__parameters__";function yl(t,n,e){return xs(()=>{const i=function Np(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,c,u){const h=l.hasOwnProperty(_l)?l[_l]:Object.defineProperty(l,_l,{value:[]})[_l];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(s),l}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class Yt{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=It({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Fr(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let i=t[e];Array.isArray(i)?(n===t&&(n=t.slice(0,e)),Fr(i,n)):n!==t&&n.push(i)}return n}function wo(t,n){t.forEach(e=>Array.isArray(e)?wo(e,n):n(e))}function Ov(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Rd(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function zc(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function _r(t,n,e){let i=bl(t,n);return i>=0?t[1|i]=e:(i=~i,function XM(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function Lp(t,n){const e=bl(t,n);if(e>=0)return t[1|e]}function bl(t,n){return function Nv(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const Vc={},zp="__NG_DI_FLAG__",Bd="ngTempTokenPath",i2=/\n/gm,Lv="__source",o2=Vt({provide:String,useValue:Vt});let Uc;function Bv(t){const n=Uc;return Uc=t,n}function s2(t,n=Ot.Default){if(void 0===Uc)throw new Ke(203,"");return null===Uc?q0(t,void 0,n):Uc.get(t,n&Ot.Optional?null:void 0,n)}function Ct(t,n=Ot.Default){return(function $S(){return ap}()||s2)(xt(t),n)}const a2=Ct;function Vp(t){const n=[];for(let e=0;e<t.length;e++){const i=xt(t[e]);if(Array.isArray(i)){if(0===i.length)throw new Ke(900,"");let r,o=Ot.Default;for(let s=0;s<i.length;s++){const a=i[s],l=l2(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}n.push(Ct(r,o))}else n.push(Ct(i))}return n}function jc(t,n){return t[zp]=n,t.prototype[zp]=n,t}function l2(t){return t[zp]}const zd=jc(yl("Optional"),8),Vd=jc(yl("SkipSelf"),4);let jd;function wl(t){var n;return(null===(n=function Hp(){if(void 0===jd&&(jd=null,dn.trustedTypes))try{jd=dn.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return jd}())||void 0===n?void 0:n.createHTML(t))||t}class da{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class C2 extends da{getTypeName(){return"HTML"}}class w2 extends da{getTypeName(){return"Style"}}class E2 extends da{getTypeName(){return"Script"}}class x2 extends da{getTypeName(){return"URL"}}class T2 extends da{getTypeName(){return"ResourceURL"}}function vr(t){return t instanceof da?t.changingThisBreaksApplicationSecurity:t}function Eo(t,n){const e=Zv(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===n}function Zv(t){return t instanceof da&&t.getTypeName()||null}class I2{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(wl(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class O2{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(n){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=wl(n),e;const i=this.inertDocument.createElement("body");return i.innerHTML=wl(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(n){const e=n.attributes;for(let r=e.length-1;0<r;r--){const s=e.item(r).name;("xmlns:ns1"===s||0===s.indexOf("ns1:"))&&n.removeAttribute(s)}let i=n.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const F2=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,N2=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Gc(t){return(t=String(t)).match(F2)||t.match(N2)?t:"unsafe:"+t}function qv(t){return(t=String(t)).split(",").map(n=>Gc(n.trim())).join(", ")}function xo(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function $c(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const Xv=xo("area,br,col,hr,img,wbr"),Kv=xo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Qv=xo("rp,rt"),$p=$c(Xv,$c(Kv,xo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$c(Qv,xo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$c(Qv,Kv)),Wp=xo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Zp=xo("srcset"),Jv=$c(Wp,Zp,xo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),xo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),R2=xo("script,style,template");class L2{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!$p.hasOwnProperty(e))return this.sanitizedSomething=!0,!R2.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!Jv.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;Wp[a]&&(l=Gc(l)),Zp[a]&&(l=qv(l)),this.buf.push(" ",s,'="',ey(l),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();$p.hasOwnProperty(e)&&!Xv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(ey(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const B2=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,z2=/([^\#-~ |!])/g;function ey(t){return t.replace(/&/g,"&amp;").replace(B2,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(z2,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Gd;function ty(t,n){let e=null;try{Gd=Gd||function Yv(t){const n=new O2(t);return function P2(){try{return!!(new window.DOMParser).parseFromString(wl(""),"text/html")}catch(t){return!1}}()?new I2(n):n}(t);let i=n?String(n):"";e=Gd.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Gd.getInertBodyElement(i)}while(i!==o);return wl((new L2).sanitizeChildren(Yp(e)||e))}finally{if(e){const i=Yp(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Yp(t){return"content"in t&&function V2(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var mn=(()=>((mn=mn||{})[mn.NONE=0]="NONE",mn[mn.HTML=1]="HTML",mn[mn.STYLE=2]="STYLE",mn[mn.SCRIPT=3]="SCRIPT",mn[mn.URL=4]="URL",mn[mn.RESOURCE_URL=5]="RESOURCE_URL",mn))();function Ln(t){const n=function Wc(){const t=Se();return t&&t[12]}();return n?n.sanitize(mn.URL,t)||"":Eo(t,"URL")?vr(t):Gc(dt(t))}const ry="__ngContext__";function Pi(t,n){t[ry]=n}function Xp(t){const n=function Zc(t){return t[ry]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function Qp(t){return t.ngOriginalError}function ik(t,...n){t.error(...n)}class Yc{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n),i=function nk(t){return t&&t.ngErrorLogger||ik}(n);i(this._console,"ERROR",n),e&&i(this._console,"ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Qp(n);for(;e&&Qp(e);)e=Qp(e);return e||null}}const fk=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(dn))();function $d(t){return t.ownerDocument}function To(t){return t instanceof Function?t():t}var yr=(()=>((yr=yr||{})[yr.Important=1]="Important",yr[yr.DashCase=2]="DashCase",yr))();function eg(t,n){return undefined(t,n)}function qc(t){const n=t[3];return eo(n)?n[3]:n}function tg(t){return fy(t[13])}function ng(t){return fy(t[4])}function fy(t){for(;null!==t&&!eo(t);)t=t[4];return t}function xl(t,n,e,i,r){if(null!=i){let o,s=!1;eo(i)?o=i:bo(i)&&(s=!0,i=i[0]);const a=Zn(i);0===t&&null!==e?null==r?yy(n,e,a):ha(n,e,a,r||null,!0):1===t&&null!==e?ha(n,e,a,r||null,!0):2===t?function Dy(t,n,e){const i=Wd(t,n);i&&function Dk(t,n,e,i){kn(t)?t.removeChild(n,e,i):n.removeChild(e)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function kk(t,n,e,i,r){const o=e[7];o!==Zn(e)&&xl(n,t,i,o,r);for(let a=10;a<e.length;a++){const l=e[a];Xc(l[1],l,t,n,i,o)}}(n,t,o,e,r)}}function rg(t,n,e){if(kn(t))return t.createElement(n,e);{const i=null!==e?function dM(t){const n=t.toLowerCase();return"svg"===n?"http://www.w3.org/2000/svg":"math"===n?"http://www.w3.org/1998/MathML/":null}(e):null;return null===i?t.createElement(n):t.createElementNS(i,n)}}function gy(t,n){const e=t[9],i=e.indexOf(n),r=n[3];1024&n[2]&&(n[2]&=-1025,Cp(r,-1)),e.splice(i,1)}function og(t,n){if(t.length<=10)return;const e=10+n,i=t[e];if(i){const r=i[17];null!==r&&r!==t&&gy(r,i),n>0&&(t[e-1][4]=i[4]);const o=Rd(t,10+n);!function vk(t,n){Xc(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const s=o[19];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function my(t,n){if(!(256&n[2])){const e=n[11];kn(e)&&e.destroyNode&&Xc(t,n,e,3,null,null),function Ck(t){let n=t[13];if(!n)return sg(t[1],t);for(;n;){let e=null;if(bo(n))e=n[13];else{const i=n[10];i&&(e=i)}if(!e){for(;n&&!n[4]&&n!==t;)bo(n)&&sg(n[1],n),n=n[3];null===n&&(n=t),bo(n)&&sg(n[1],n),e=n&&n[4]}n=e}}(n)}}function sg(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function Tk(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof Pc)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];try{l.call(a)}finally{}}else try{o.call(r)}finally{}}}}(t,n),function xk(t,n){const e=t.cleanup,i=n[7];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+1],a="function"==typeof s?s(n):Zn(n[s]),l=i[r=e[o+2]],c=e[o+3];"boolean"==typeof c?a.removeEventListener(e[o],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)i[o]();n[7]=null}}(t,n),1===n[1].type&&kn(n[11])&&n[11].destroy();const e=n[17];if(null!==e&&eo(n[3])){e!==n[3]&&gy(e,n);const i=n[19];null!==i&&i.detachView(t)}}}function _y(t,n,e){return function vy(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===Qr.None||r===Qr.Emulated)return null}return Pr(i,e)}(t,n.parent,e)}function ha(t,n,e,i,r){kn(t)?t.insertBefore(n,e,i,r):n.insertBefore(e,i,r)}function yy(t,n,e){kn(t)?t.appendChild(n,e):n.appendChild(e)}function by(t,n,e,i,r){null!==i?ha(t,n,e,i,r):yy(t,n,e)}function Wd(t,n){return kn(t)?t.parentNode(n):n.parentNode}function Cy(t,n,e){return Ey(t,n,e)}let Ey=function wy(t,n,e){return 40&t.type?Pr(t,e):null};function Zd(t,n,e,i){const r=_y(t,i,n),o=n[11],a=Cy(i.parent||n[6],i,n);if(null!=r)if(Array.isArray(e))for(let l=0;l<e.length;l++)by(o,r,e[l],a,!1);else by(o,r,e,a,!1)}function Yd(t,n){if(null!==n){const e=n.type;if(3&e)return Pr(n,t);if(4&e)return lg(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Yd(t,i);{const r=t[n.index];return eo(r)?lg(-1,r):Zn(r)}}if(32&e)return eg(n,t)()||Zn(t[n.index]);{const i=Ty(t,n);return null!==i?Array.isArray(i)?i[0]:Yd(qc(t[16]),i):Yd(t,n.next)}}return null}function Ty(t,n){return null!==n?t[16][6].projection[n.projection]:null}function lg(t,n){const e=10+t+1;if(e<n.length){const i=n[e],r=i[1].firstChild;if(null!==r)return Yd(i,r)}return n[7]}function cg(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],l=e.type;if(s&&0===n&&(a&&Pi(Zn(a),i),e.flags|=4),64!=(64&e.flags))if(8&l)cg(t,n,e.child,i,r,o,!1),xl(n,t,r,a,o);else if(32&l){const c=eg(e,i);let u;for(;u=c();)xl(n,t,r,u,o);xl(n,t,r,a,o)}else 16&l?Sy(t,n,i,e,r,o):xl(n,t,r,a,o);e=s?e.projectionNext:e.next}}function Xc(t,n,e,i,r,o){cg(e,i,t.firstChild,n,r,o,!1)}function Sy(t,n,e,i,r,o){const s=e[16],l=s[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)xl(n,t,r,l[c],o);else cg(t,n,l,s[3],r,o,!0)}function My(t,n,e){kn(t)?t.setAttribute(n,"style",e):n.style.cssText=e}function ug(t,n,e){kn(t)?""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e):n.className=e}function ky(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}const Ay="ng-template";function Ik(t,n,e){let i=0;for(;i<t.length;){let r=t[i++];if(e&&"class"===r){if(r=t[i],-1!==ky(r.toLowerCase(),n,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function Iy(t){return 4===t.type&&t.value!==Ay}function Ok(t,n,e){return n===(4!==t.type||e?t.value:Ay)}function Pk(t,n,e){let i=4;const r=t.attrs||[],o=function Rk(t){for(let n=0;n<t.length;n++)if(bv(t[n]))return n;return t.length}(r);let s=!1;for(let a=0;a<n.length;a++){const l=n[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!Ok(t,l,e)||""===l&&1===n.length){if(io(i))return!1;s=!0}}else{const c=8&i?l:n[++a];if(8&i&&null!==t.attrs){if(!Ik(t.attrs,c,e)){if(io(i))return!1;s=!0}continue}const h=Fk(8&i?"class":l,r,Iy(t),e);if(-1===h){if(io(i))return!1;s=!0;continue}if(""!==c){let g;g=h>o?"":r[h+1].toLowerCase();const w=8&i?g:null;if(w&&-1!==ky(w,c,0)||2&i&&c!==g){if(io(i))return!1;s=!0}}}}else{if(!s&&!io(i)&&!io(l))return!1;if(s&&io(l))continue;s=!1,i=l|1&i}}return io(i)||s}function io(t){return 0==(1&t)}function Fk(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function Lk(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function Oy(t,n,e=!1){for(let i=0;i<n.length;i++)if(Pk(t,n[i],e))return!0;return!1}function Bk(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function Py(t,n){return t?":not("+n.trim()+")":n}function zk(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!io(s)&&(n+=Py(o,r),r=""),i=s,o=o||!io(i);e++}return""!==r&&(n+=Py(o,r)),n}const Mt={};function k(t){Fy(Kt(),Se(),Gi()+t,!1)}function Fy(t,n,e,i){if(!i)if(3==(3&n[2])){const o=t.preOrderCheckHooks;null!==o&&Md(n,o,e)}else{const o=t.preOrderHooks;null!==o&&kd(n,o,0,e)}Ss(e)}function qd(t,n){return t<<17|n<<2}function ro(t){return t>>17&32767}function dg(t){return 2|t}function ns(t){return(131068&t)>>2}function hg(t,n){return-131069&t|n<<2}function fg(t){return 1|t}function $y(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],o=e[i+1];if(-1!==o){const s=t.data[o];Dp(r),s.contentQueries(2,n[o],o)}}}function Kc(t,n,e,i,r,o,s,a,l,c){const u=n.blueprint.slice();return u[0]=r,u[2]=140|i,av(u),u[3]=u[15]=t,u[8]=e,u[10]=s||t&&t[10],u[11]=a||t&&t[11],u[12]=l||t&&t[12]||null,u[9]=c||t&&t[9]||null,u[6]=o,u[16]=2==n.type?t[16]:u,u}function Tl(t,n,e,i,r){let o=t.data[n];if(null===o)o=function wg(t,n,e,i,r){const o=uv(),s=wp(),l=t.data[n]=function iA(t,n,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l)),l}(t,n,e,i,r),function EM(){return St.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function Oc(){const t=St.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return Co(o,!0),o}function Dl(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function Qc(t,n,e){Td(n);try{const i=t.viewQuery;null!==i&&Ig(1,i,e);const r=t.template;null!==r&&Wy(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&$y(t,n),t.staticViewQueries&&Ig(2,t.viewQuery,e);const o=t.components;null!==o&&function eA(t,n){for(let e=0;e<n.length;e++)CA(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,Dd()}}function Sl(t,n,e,i){const r=n[2];if(256!=(256&r)){Td(n);try{av(n),function dv(t){return St.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Wy(t,n,e,2,i);const s=3==(3&r);if(s){const c=t.preOrderCheckHooks;null!==c&&Md(n,c,null)}else{const c=t.preOrderHooks;null!==c&&kd(n,c,0,null),Sp(n,0)}if(function yA(t){for(let n=tg(t);null!==n;n=ng(n)){if(!n[2])continue;const e=n[9];for(let i=0;i<e.length;i++){const r=e[i],o=r[3];0==(1024&r[2])&&Cp(o,1),r[2]|=1024}}}(n),function vA(t){for(let n=tg(t);null!==n;n=ng(n))for(let e=10;e<n.length;e++){const i=n[e],r=i[1];bp(i)&&Sl(r,i,r.template,i[8])}}(n),null!==t.contentQueries&&$y(t,n),s){const c=t.contentCheckHooks;null!==c&&Md(n,c)}else{const c=t.contentHooks;null!==c&&kd(n,c,1),Sp(n,1)}!function Qk(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ss(~r);else{const o=r,s=e[++i],a=e[++i];xM(s,o),a(2,n[o])}}}finally{Ss(-1)}}(t,n);const a=t.components;null!==a&&function Jk(t,n){for(let e=0;e<n.length;e++)bA(t,n[e])}(n,a);const l=t.viewQuery;if(null!==l&&Ig(2,l,i),s){const c=t.viewCheckHooks;null!==c&&Md(n,c)}else{const c=t.viewHooks;null!==c&&kd(n,c,2),Sp(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[2]&=-73,1024&n[2]&&(n[2]&=-1025,Cp(n[3],-1))}finally{Dd()}}}function tA(t,n,e,i){const r=n[10],s=sv(n);try{!s&&r.begin&&r.begin(),s&&Qc(t,n,i),Sl(t,n,e,i)}finally{!s&&r.end&&r.end()}}function Wy(t,n,e,i,r){const o=Gi(),s=2&i;try{Ss(-1),s&&n.length>20&&Fy(t,n,20,!1),e(i,r)}finally{Ss(o)}}function Zy(t,n,e){if(hp(n)){const r=n.directiveEnd;for(let o=n.directiveStart;o<r;o++){const s=t.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function Eg(t,n,e){!cv()||(function uA(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;t.firstCreatePass||Nc(e,n),Pi(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const l=t.data[a],c=to(l);c&&gA(n,e,l);const u=Rc(n,t,a,e);Pi(u,n),null!==s&&mA(0,a-r,u,l,0,s),c&&(mr(e.index,n)[8]=u)}}(t,n,e,Pr(e,n)),128==(128&e.flags)&&function dA(t,n,e){const i=e.directiveStart,r=e.directiveEnd,s=e.index,a=function TM(){return St.lFrame.currentDirectiveIndex}();try{Ss(s);for(let l=i;l<r;l++){const c=t.data[l],u=n[l];xp(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&tb(c,u)}}finally{Ss(-1),xp(a)}}(t,n,e))}function xg(t,n,e=Pr){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function Yy(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Qd(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Qd(t,n,e,i,r,o,s,a,l,c){const u=20+i,h=u+r,g=function nA(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:Mt);return e}(u,h),w="function"==typeof c?c():c;return g[1]={type:t,blueprint:g,template:e,queries:null,viewQuery:a,declTNode:n,data:g.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:w,incompleteFirstPass:!1}}function Ky(t,n,e,i){const r=ab(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&lb(t).push(i,r.length-1))}function Qy(t,n,e){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(n,r):e[i]=[n,r]}return e}function br(t,n,e,i,r,o,s,a){const l=Pr(n,e);let u,c=n.inputs;!a&&null!=c&&(u=c[i])?(db(t,e,u,i,r),Cd(n)&&function sA(t,n){const e=mr(n,t);16&e[2]||(e[2]|=64)}(e,n.index)):3&n.type&&(i=function oA(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,kn(o)?o.setProperty(l,i,r):kp(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function Tg(t,n,e,i){let r=!1;if(cv()){const o=function hA(t,n,e){const i=t.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];Oy(e,s.selectors,!1)&&(r||(r=[]),Fd(Nc(e,n),t,s.type),to(s)?(nb(t,e),r.unshift(s)):r.push(s))}return r}(t,n,e),s=null===i?null:{"":-1};if(null!==o){r=!0,ib(e,t.data.length,o.length);for(let u=0;u<o.length;u++){const h=o[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Dl(t,n,o.length,null);for(let u=0;u<o.length;u++){const h=o[u];e.mergedAttrs=Id(e.mergedAttrs,h.hostAttrs),rb(t,e,n,c,h),pA(c,h,s),null!==h.contentQueries&&(e.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(e.flags|=128);const g=h.type.prototype;!a&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),a=!0),!l&&(g.ngOnChanges||g.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),l=!0),c++}!function rA(t,n){const i=n.directiveEnd,r=t.data,o=n.attrs,s=[];let a=null,l=null;for(let c=n.directiveStart;c<i;c++){const u=r[c],h=u.inputs,g=null===o||Iy(n)?null:_A(h,o);s.push(g),a=Qy(h,c,a),l=Qy(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(n.flags|=16),a.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=s,n.inputs=a,n.outputs=l}(t,e)}s&&function fA(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new Ke(-301,!1);i.push(n[r],o)}}}(e,i,s)}return e.mergedAttrs=Id(e.mergedAttrs,e.attrs),r}function eb(t,n,e,i,r,o){const s=o.hostBindings;if(s){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const l=~n.index;(function cA(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=l&&a.push(l),a.push(i,r,s)}}function tb(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function nb(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function pA(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;to(n)&&(e[""]=t)}}function ib(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function rb(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=ua(r.type)),s=new Pc(o,to(r),null);t.blueprint[i]=s,e[i]=s,eb(t,n,0,i,Dl(t,e,r.hostVars,Mt),r)}function gA(t,n,e){const i=Pr(n,t),r=Yy(e),o=t[10],s=Jd(t,Kc(t,r,null,e.onPush?64:16,i,n,o,o.createRenderer(i,e),null,null));t[n.index]=s}function Do(t,n,e,i,r,o){const s=Pr(t,n);!function Dg(t,n,e,i,r,o,s){if(null==o)kn(t)?t.removeAttribute(n,r,e):n.removeAttribute(r);else{const a=null==s?dt(o):s(o,i||"",r);kn(t)?t.setAttribute(n,r,a,e):e?n.setAttributeNS(e,r,a):n.setAttribute(r,a)}}(n[11],s,o,t.value,e,i,r)}function mA(t,n,e,i,r,o){const s=o[n];if(null!==s){const a=i.setInput;for(let l=0;l<s.length;){const c=s[l++],u=s[l++],h=s[l++];null!==a?i.setInput(e,h,c,u):e[u]=h}}}function _A(t,n){let e=null,i=0;for(;i<n.length;){const r=n[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,t[r],n[i+1])),i+=2}else i+=2;else i+=4}return e}function ob(t,n,e,i){return new Array(t,!0,!1,n,null,0,i,e,null,null)}function bA(t,n){const e=mr(n,t);if(bp(e)){const i=e[1];80&e[2]?Sl(i,e,i.template,e[8]):e[5]>0&&Sg(e)}}function Sg(t){for(let i=tg(t);null!==i;i=ng(i))for(let r=10;r<i.length;r++){const o=i[r];if(1024&o[2]){const s=o[1];Sl(s,o,s.template,o[8])}else o[5]>0&&Sg(o)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=mr(e[i],t);bp(r)&&r[5]>0&&Sg(r)}}function CA(t,n){const e=mr(n,t),i=e[1];(function wA(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),Qc(i,e,e[8])}function Jd(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function Mg(t){for(;t;){t[2]|=64;const n=qc(t);if(tM(t)&&!n)return t;t=n}return null}function sb(t){!function kg(t){for(let n=0;n<t.components.length;n++){const e=t.components[n],i=Xp(e),r=i[1];tA(r,i,r.template,e)}}(t[8])}function Ig(t,n,e){Dp(0),n(t,e)}const xA=(()=>Promise.resolve(null))();function ab(t){return t[7]||(t[7]=[])}function lb(t){return t.cleanup||(t.cleanup=[])}function ub(t,n){const e=t[9],i=e?e.get(Yc,null):null;i&&i.handleError(n)}function db(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],l=n[s],c=t.data[s];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function is(t,n,e){const i=Ed(n,t);!function py(t,n,e){kn(t)?t.setValue(n,e):n.textContent=e}(t[11],i,e)}function eh(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=Cs(r,a):2==o&&(i=Cs(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}const Og=new Yt("INJECTOR",-1);class hb{get(n,e=Vc){if(e===Vc){const i=new Error(`NullInjectorError: No provider for ${Jt(n)}!`);throw i.name="NullInjectorError",i}return e}}const Pg=new Yt("Set Injector scope."),Jc={},SA={};let Fg;function fb(){return void 0===Fg&&(Fg=new hb),Fg}function pb(t,n=null,e=null,i){const r=gb(t,n,e,i);return r._resolveInjectorDefTypes(),r}function gb(t,n=null,e=null,i){return new MA(t,e,n||fb(),i)}class MA{constructor(n,e,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];e&&wo(e,a=>this.processProvider(a,n,e)),wo([n],a=>this.processInjectorType(a,[],o)),this.records.set(Og,Ml(void 0,this));const s=this.records.get(Pg);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof n?null:Jt(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,e=Vc,i=Ot.Default){this.assertNotDestroyed();const r=Bv(this),o=Es(void 0);try{if(!(i&Ot.SkipSelf)){let a=this.records.get(n);if(void 0===a){const l=function RA(t){return"function"==typeof t||"object"==typeof t&&t instanceof Yt}(n)&&op(n);a=l&&this.injectableDefInScope(l)?Ml(Ng(n),Jc):null,this.records.set(n,a)}if(null!=a)return this.hydrate(n,a)}return(i&Ot.Self?fb():this.parent).get(n,e=i&Ot.Optional&&e===Vc?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[Bd]=s[Bd]||[]).unshift(Jt(n)),r)throw s;return function c2(t,n,e,i){const r=t[Bd];throw n[Lv]&&r.unshift(n[Lv]),t.message=function u2(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=Jt(n);if(Array.isArray(n))r=n.map(Jt).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Jt(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(i2,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[Bd]=null,t}(s,n,"R3InjectorError",this.source)}throw s}finally{Es(o),Bv(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((i,r)=>n.push(Jt(r))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ke(205,!1)}processInjectorType(n,e,i){if(!(n=xt(n)))return!1;let r=Z0(n);const o=null==r&&n.ngModule||void 0,s=void 0===o?n:o,a=-1!==i.indexOf(s);if(void 0!==o&&(r=Z0(o)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(s);try{wo(r.imports,h=>{this.processInjectorType(h,e,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:g,providers:w}=u[h];wo(w,R=>this.processProvider(R,g,w||fn))}}this.injectorDefTypes.add(s);const l=ua(s)||(()=>new s);this.records.set(s,Ml(l,Jc));const c=r.providers;if(null!=c&&!a){const u=n;wo(c,h=>this.processProvider(h,u,c))}return void 0!==o&&void 0!==n.providers}processProvider(n,e,i){let r=kl(n=xt(n))?n:xt(n&&n.provide);const o=function AA(t,n,e){return _b(t)?Ml(void 0,t.useValue):Ml(mb(t),Jc)}(n);if(kl(n)||!0!==n.multi)this.records.get(r);else{let s=this.records.get(r);s||(s=Ml(void 0,Jc,!0),s.factory=()=>Vp(s.multi),this.records.set(r,s)),r=n,s.multi.push(n)}this.records.set(r,o)}hydrate(n,e){return e.value===Jc&&(e.value=SA,e.value=e.factory()),"object"==typeof e.value&&e.value&&function NA(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=xt(n.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function Ng(t){const n=op(t),e=null!==n?n.factory:ua(t);if(null!==e)return e;if(t instanceof Yt)throw new Ke(204,!1);if(t instanceof Function)return function kA(t){const n=t.length;if(n>0)throw zc(n,"?"),new Ke(204,!1);const e=function jS(t){const n=t&&(t[md]||t[Y0]);if(n){const e=function HS(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Ke(204,!1)}function mb(t,n,e){let i;if(kl(t)){const r=xt(t);return ua(r)||Ng(r)}if(_b(t))i=()=>xt(t.useValue);else if(function OA(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...Vp(t.deps||[]));else if(function IA(t){return!(!t||!t.useExisting)}(t))i=()=>Ct(xt(t.useExisting));else{const r=xt(t&&(t.useClass||t.provide));if(!function FA(t){return!!t.deps}(t))return ua(r)||Ng(r);i=()=>new r(...Vp(t.deps))}return i}function Ml(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function _b(t){return null!==t&&"object"==typeof t&&o2 in t}function kl(t){return"function"==typeof t}let Cr=(()=>{class t{static create(e,i){var r;if(Array.isArray(e))return pb({name:""},i,e,"");{const o=null!==(r=e.name)&&void 0!==r?r:"";return pb({name:o},e.parent,e.providers,o)}}}return t.THROW_IF_NOT_FOUND=Vc,t.NULL=new hb,t.\u0275prov=It({token:t,providedIn:"any",factory:()=>Ct(Og)}),t.__NG_ELEMENT_ID__=-1,t})();function GA(t,n){Sd(Xp(t)[1],ii())}function cn(t){let n=function kb(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(to(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Ke(903,"");r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=Bg(t.inputs),s.declaredInputs=Bg(t.declaredInputs),s.outputs=Bg(t.outputs);const a=r.hostBindings;a&&YA(t,a);const l=r.viewQuery,c=r.contentQueries;if(l&&WA(t,l),c&&ZA(t,c),il(t.inputs,r.inputs),il(t.declaredInputs,r.declaredInputs),il(t.outputs,r.outputs),to(r)&&r.data.animation){const u=t.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===cn&&(e=!1)}}n=Object.getPrototypeOf(n)}!function $A(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Id(r.hostAttrs,e=Id(e,r.hostAttrs))}}(i)}function Bg(t){return t===sl?{}:t===fn?[]:t}function WA(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function ZA(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function YA(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}let th=null;function Al(){if(!th){const t=dn.Symbol;if(t&&t.iterator)th=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const i=n[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(th=i)}}}return th}function eu(t){return!!zg(t)&&(Array.isArray(t)||!(t instanceof Map)&&Al()in t)}function zg(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function So(t,n,e){return t[n]=e}function Fi(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function fa(t,n,e,i){const r=Fi(t,n,e);return Fi(t,n+1,i)||r}function Rr(t,n,e,i){const r=Se();return Fi(r,hl(),n)&&(Kt(),Do(An(),r,t,n,e,i)),Rr}function Ol(t,n,e,i){return Fi(t,hl(),e)?n+dt(e)+i:Mt}function Pl(t,n,e,i,r,o){const a=fa(t,function es(){return St.lFrame.bindingIndex}(),e,r);return ts(2),a?n+dt(e)+i+dt(r)+o:Mt}function Q(t,n,e,i,r,o,s,a){const l=Se(),c=Kt(),u=t+20,h=c.firstCreatePass?function tI(t,n,e,i,r,o,s,a,l){const c=n.consts,u=Tl(n,t,4,s||null,Ds(c,a));Tg(n,e,u,Ds(c,l)),Sd(n,u);const h=u.tViews=Qd(2,u,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c);return null!==n.queries&&(n.queries.template(n,u),h.queries=n.queries.embeddedTView(u)),u}(u,c,l,n,e,i,r,o,s):c.data[u];Co(h,!1);const g=l[11].createComment("");Zd(c,l,g,h),Pi(g,l),Jd(l,l[u]=ob(g,l,g,h)),wd(h)&&Eg(c,l,h),null!=s&&xg(l,h,a)}function en(t){return dl(function wM(){return St.lFrame.contextLView}(),20+t)}function ee(t,n=Ot.Default){const e=Se();return null===e?Ct(t,n):Sv(ii(),e,xt(t),n)}function A(t,n,e){const i=Se();return Fi(i,hl(),n)&&br(Kt(),An(),i,t,n,i[11],e,!1),A}function Gg(t,n,e,i,r){const s=r?"class":"style";db(t,e,n.inputs[s],s,i)}function E(t,n,e,i){const r=Se(),o=Kt(),s=20+t,a=r[11],l=r[s]=rg(a,n,function PM(){return St.lFrame.currentNamespace}()),c=o.firstCreatePass?function EI(t,n,e,i,r,o,s){const a=n.consts,c=Tl(n,t,2,r,Ds(a,o));return Tg(n,e,c,Ds(a,s)),null!==c.attrs&&eh(c,c.attrs,!1),null!==c.mergedAttrs&&eh(c,c.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,c),c}(s,o,r,0,n,e,i):o.data[s];Co(c,!0);const u=c.mergedAttrs;null!==u&&Ad(a,l,u);const h=c.classes;null!==h&&ug(a,l,h);const g=c.styles;return null!==g&&My(a,l,g),64!=(64&c.flags)&&Zd(o,r,l,c),0===function _M(){return St.lFrame.elementDepthCount}()&&Pi(l,r),function vM(){St.lFrame.elementDepthCount++}(),wd(c)&&(Eg(o,r,c),Zy(o,c,r)),null!==i&&xg(r,c),E}function P(){let t=ii();wp()?Ep():(t=t.parent,Co(t,!1));const n=t;!function yM(){St.lFrame.elementDepthCount--}();const e=Kt();return e.firstCreatePass&&(Sd(e,t),hp(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function BM(t){return 0!=(16&t.flags)}(n)&&Gg(e,n,Se(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function zM(t){return 0!=(32&t.flags)}(n)&&Gg(e,n,Se(),n.stylesWithoutHost,!1),P}function $e(t,n,e,i){return E(t,n,e,i),P(),$e}function Be(t,n,e){const i=Se(),r=Kt(),o=t+20,s=r.firstCreatePass?function xI(t,n,e,i,r){const o=n.consts,s=Ds(o,i),a=Tl(n,t,8,"ng-container",s);return null!==s&&eh(a,s,!0),Tg(n,e,a,Ds(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];Co(s,!0);const a=i[o]=i[11].createComment("");return Zd(r,i,a,s),Pi(a,i),wd(s)&&(Eg(r,i,s),Zy(r,s,i)),null!=e&&xg(i,s),Be}function ze(){let t=ii();const n=Kt();return wp()?Ep():(t=t.parent,Co(t,!1)),n.firstCreatePass&&(Sd(n,t),hp(t)&&n.queries.elementEnd(t)),ze}function wn(t,n,e){return Be(t,n,e),ze(),wn}function et(){return Se()}function rh(t){return!!t&&"function"==typeof t.then}const Xb=function qb(t){return!!t&&"function"==typeof t.subscribe};function ue(t,n,e,i){const r=Se(),o=Kt(),s=ii();return function Qb(t,n,e,i,r,o,s,a){const l=wd(i),u=t.firstCreatePass&&lb(t),h=n[8],g=ab(n);let w=!0;if(3&i.type||a){const re=Pr(i,n),le=a?a(re):re,J=g.length,be=a?ye=>a(Zn(ye[i.index])):i.index;if(kn(e)){let ye=null;if(!a&&l&&(ye=function TI(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[7],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==ye)(ye.__ngLastListenerFn__||ye).__ngNextListenerFn__=o,ye.__ngLastListenerFn__=o,w=!1;else{o=$g(i,n,h,o,!1);const Ue=e.listen(le,r,o);g.push(o,Ue),u&&u.push(r,be,J,J+1)}}else o=$g(i,n,h,o,!0),le.addEventListener(r,o,s),g.push(o),u&&u.push(r,be,J,s)}else o=$g(i,n,h,o,!1);const R=i.outputs;let Z;if(w&&null!==R&&(Z=R[r])){const re=Z.length;if(re)for(let le=0;le<re;le+=2){const wt=n[Z[le]][Z[le+1]].subscribe(o),Ge=g.length;g.push(o,wt),u&&u.push(r,i.index,Ge,-(Ge+1))}}}(o,r,r[11],s,t,n,!!e,i),ue}function Jb(t,n,e,i){try{return!1!==e(i)}catch(r){return ub(t,r),!1}}function $g(t,n,e,i,r){return function o(s){if(s===Function)return i;const a=2&t.flags?mr(t.index,n):n;0==(32&n[2])&&Mg(a);let l=Jb(n,0,i,s),c=o.__ngNextListenerFn__;for(;c;)l=Jb(n,0,c,s)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(s.preventDefault(),s.returnValue=!1),l}}function G(t=1){return function SM(t){return(St.lFrame.contextLView=function MM(t,n){for(;t>0;)n=n[15],t--;return n}(t,St.lFrame.contextLView))[8]}(t)}function DI(t,n){let e=null;const i=function Nk(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(0==(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?Oy(t,o,!0):Bk(i,o))return r}else e=r}return e}function Wg(t){const n=Se()[16][6];if(!n.projection){const i=n.projection=zc(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?DI(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function Zg(t,n=0,e){const i=Se(),r=Kt(),o=Tl(r,20+t,16,null,e||null);null===o.projection&&(o.projection=n),Ep(),64!=(64&o.flags)&&function Mk(t,n,e){Sy(n[11],0,n,e,_y(t,e,n),Cy(e.parent||n[6],e,n))}(r,i,o)}function sn(t,n,e){return Yg(t,"",n,"",e),sn}function Yg(t,n,e,i,r){const o=Se(),s=Ol(o,n,e,i);return s!==Mt&&br(Kt(),An(),o,t,s,o[11],r,!1),Yg}function l1(t,n,e,i,r){const o=t[e+1],s=null===n;let a=i?ro(o):ns(o),l=!1;for(;0!==a&&(!1===l||s);){const u=t[a+1];kI(t[a],n)&&(l=!0,t[a+1]=i?fg(u):dg(u)),a=i?ro(u):ns(u)}l&&(t[e+1]=i?dg(o):fg(o))}function kI(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&bl(t,n)>=0}const oi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function c1(t){return t.substring(oi.key,oi.keyEnd)}function AI(t){return t.substring(oi.value,oi.valueEnd)}function d1(t,n){const e=oi.textEnd;let i=oi.key=Ul(t,n,e);return e===i?-1:(i=oi.keyEnd=function FI(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=f1(t,i,e),i=oi.value=Ul(t,i,e),i=oi.valueEnd=function NI(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const l=t.charCodeAt(s++);if(59===l)return a;34===l||39===l?a=s=p1(t,l,s,e):n===s-4&&85===o&&82===r&&76===i&&40===l?a=s=p1(t,41,s,e):l>32&&(a=s),o=r,r=i,i=-33&l}return a}(t,i,e),f1(t,i,e))}function Ul(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function f1(t,n,e,i){return(n=Ul(t,n,e))<e&&n++,n}function p1(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function an(t,n,e){return so(t,n,e,!1),an}function oh(t,n){return so(t,n,null,!0),oh}function wr(t){!function ao(t,n,e,i){const r=Kt(),o=ts(2);r.firstUpdatePass&&m1(r,null,o,i);const s=Se();if(e!==Mt&&Fi(s,o,e)){const a=r.data[Gi()];if(b1(a,i)&&!g1(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=Cs(l,e||"")),Gg(r,a,s,e,i)}else!function HI(t,n,e,i,r,o,s,a){r===Mt&&(r=fn);let l=0,c=0,u=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;null!==u||null!==h;){const g=l<r.length?r[l+1]:void 0,w=c<o.length?o[c+1]:void 0;let Z,R=null;u===h?(l+=2,c+=2,g!==w&&(R=h,Z=w)):null===h||null!==u&&u<h?(l+=2,R=u):(c+=2,R=h,Z=w),null!==R&&v1(t,n,e,i,R,Z,s,a),u=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function jI(t,n,e){if(null==e||""===e)return fn;const i=[],r=vr(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}(_1,RI,t,!1)}function RI(t,n){for(let e=function OI(t){return function h1(t){oi.key=0,oi.keyEnd=0,oi.value=0,oi.valueEnd=0,oi.textEnd=t.length}(t),d1(t,Ul(t,0,oi.textEnd))}(n);e>=0;e=d1(n,e))_1(t,c1(n),AI(n))}function so(t,n,e,i){const r=Se(),o=Kt(),s=ts(2);o.firstUpdatePass&&m1(o,t,s,i),n!==Mt&&Fi(r,s,n)&&v1(o,o.data[Gi()],r,r[11],t,r[s+1]=function GI(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Jt(vr(t)))),t}(n,e),i,s)}function g1(t,n){return n>=t.expandoStartIndex}function m1(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[Gi()],s=g1(t,e);b1(o,i)&&null===n&&!s&&(n=!1),n=function BI(t,n,e,i){const r=function Tp(t){const n=St.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=nu(e=qg(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=qg(r,t,n,e,i),null===o){let l=function zI(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==ns(i))return t[ro(i)]}(t,n,i);void 0!==l&&Array.isArray(l)&&(l=qg(null,t,n,l[1],i),l=nu(l,n.attrs,i),function VI(t,n,e,i){t[ro(e?n.classBindings:n.styleBindings)]=i}(t,n,i,l))}else o=function UI(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=nu(i,t[o].hostAttrs,e);return nu(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function SI(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=ro(s),l=ns(s);t[i]=e;let u,c=!1;if(Array.isArray(e)){const h=e;u=h[1],(null===u||bl(h,u)>0)&&(c=!0)}else u=e;if(r)if(0!==l){const g=ro(t[a+1]);t[i+1]=qd(g,a),0!==g&&(t[g+1]=hg(t[g+1],i)),t[a+1]=function jk(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=qd(a,0),0!==a&&(t[a+1]=hg(t[a+1],i)),a=i;else t[i+1]=qd(l,0),0===a?a=i:t[l+1]=hg(t[l+1],i),l=i;c&&(t[i+1]=dg(t[i+1])),l1(t,u,i,!0),l1(t,u,i,!1),function MI(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&bl(o,n)>=0&&(e[i+1]=fg(e[i+1]))}(n,u,t,i,o),s=qd(a,l),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function qg(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=nu(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function nu(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),_r(t,s,!!e||n[++o]))}return void 0===t?null:t}function _1(t,n,e){_r(t,n,vr(e))}function v1(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const l=t.data,c=l[a+1];sh(function Ly(t){return 1==(1&t)}(c)?y1(l,n,e,r,ns(c),s):void 0)||(sh(o)||function Ry(t){return 2==(2&t)}(c)&&(o=y1(l,null,e,r,a,s)),function Ak(t,n,e,i,r){const o=kn(t);if(n)r?o?t.addClass(e,i):e.classList.add(i):o?t.removeClass(e,i):e.classList.remove(i);else{let s=-1===i.indexOf("-")?void 0:yr.DashCase;if(null==r)o?t.removeStyle(e,i,s):e.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),s|=yr.Important),o?t.setStyle(e,i,r,s):e.style.setProperty(i,r,a?"important":"")}}}(i,s,Ed(Gi(),e),r,o))}function y1(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const l=t[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let g=e[r+1];g===Mt&&(g=h?fn:void 0);let w=h?Lp(g,i):u===i?g:void 0;if(c&&!sh(w)&&(w=Lp(l,i)),sh(w)&&(a=w,s))return a;const R=t[r+1];r=s?ro(R):ns(R)}if(null!==n){let l=o?n.residualClasses:n.residualStyles;null!=l&&(a=Lp(l,i))}return a}function sh(t){return void 0!==t}function b1(t,n){return 0!=(t.flags&(n?16:32))}function W(t,n=""){const e=Se(),i=Kt(),r=t+20,o=i.firstCreatePass?Tl(i,r,1,n,null):i.data[r],s=e[r]=function ig(t,n){return kn(t)?t.createText(n):t.createTextNode(n)}(e[11],n);Zd(i,e,s,o),Co(o,!1)}function ht(t){return Bn("",t,""),ht}function Bn(t,n,e){const i=Se(),r=Ol(i,t,n,e);return r!==Mt&&is(i,Gi(),r),Bn}function jl(t,n,e,i,r){const o=Se(),s=Pl(o,t,n,e,i,r);return s!==Mt&&is(o,Gi(),s),jl}const pa=void 0;var uO=["en",[["a","p"],["AM","PM"],pa],[["AM","PM"],pa,pa],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pa,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pa,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pa,"{1} 'at' {0}",pa],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function cO(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Hl={};function Wi(t){const n=function dO(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=V1(n);if(e)return e;const i=n.split("-")[0];if(e=V1(i),e)return e;if("en"===i)return uO;throw new Error(`Missing locale data for the locale "${t}".`)}function V1(t){return t in Hl||(Hl[t]=dn.ng&&dn.ng.common&&dn.ng.common.locales&&dn.ng.common.locales[t]),Hl[t]}var qe=(()=>((qe=qe||{})[qe.LocaleId=0]="LocaleId",qe[qe.DayPeriodsFormat=1]="DayPeriodsFormat",qe[qe.DayPeriodsStandalone=2]="DayPeriodsStandalone",qe[qe.DaysFormat=3]="DaysFormat",qe[qe.DaysStandalone=4]="DaysStandalone",qe[qe.MonthsFormat=5]="MonthsFormat",qe[qe.MonthsStandalone=6]="MonthsStandalone",qe[qe.Eras=7]="Eras",qe[qe.FirstDayOfWeek=8]="FirstDayOfWeek",qe[qe.WeekendRange=9]="WeekendRange",qe[qe.DateFormat=10]="DateFormat",qe[qe.TimeFormat=11]="TimeFormat",qe[qe.DateTimeFormat=12]="DateTimeFormat",qe[qe.NumberSymbols=13]="NumberSymbols",qe[qe.NumberFormats=14]="NumberFormats",qe[qe.CurrencyCode=15]="CurrencyCode",qe[qe.CurrencySymbol=16]="CurrencySymbol",qe[qe.CurrencyName=17]="CurrencyName",qe[qe.Currencies=18]="Currencies",qe[qe.Directionality=19]="Directionality",qe[qe.PluralCase=20]="PluralCase",qe[qe.ExtraData=21]="ExtraData",qe))();const ah="en-US";let U1=ah;function Qg(t,n,e,i,r){if(t=xt(t),Array.isArray(t))for(let o=0;o<t.length;o++)Qg(t[o],n,e,i,r);else{const o=Kt(),s=Se();let a=kl(t)?t:xt(t.provide),l=mb(t);const c=ii(),u=1048575&c.providerIndexes,h=c.directiveStart,g=c.providerIndexes>>20;if(kl(t)||!t.multi){const w=new Pc(l,r,ee),R=em(a,n,r?u:u+g,h);-1===R?(Fd(Nc(c,s),o,a),Jg(o,t,n.length),n.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(w),s.push(w)):(e[R]=w,s[R]=w)}else{const w=em(a,n,u+g,h),R=em(a,n,u,u+g),Z=w>=0&&e[w],re=R>=0&&e[R];if(r&&!re||!r&&!Z){Fd(Nc(c,s),o,a);const le=function c3(t,n,e,i,r){const o=new Pc(t,e,ee);return o.multi=[],o.index=n,o.componentProviders=0,dC(o,r,i&&!e),o}(r?l3:a3,e.length,r,i,l);!r&&re&&(e[R].providerFactory=le),Jg(o,t,n.length,0),n.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(le),s.push(le)}else Jg(o,t,w>-1?w:R,dC(e[r?R:w],l,!r&&i));!r&&i&&re&&e[R].componentProviders++}}}function Jg(t,n,e,i){const r=kl(n),o=function PA(t){return!!t.useClass}(n);if(r||o){const l=(o?xt(n.useClass):n).prototype.ngOnDestroy;if(l){const c=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const u=c.indexOf(e);-1===u?c.push(e,[i,l]):c[u+1].push(i,l)}else c.push(e,l)}}}function dC(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function em(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function a3(t,n,e,i){return tm(this.multi,[])}function l3(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Rc(e,e[1],this.providerFactory.index,i);o=a.slice(0,s),tm(r,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],tm(r,o);return o}function tm(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function En(t,n=[]){return e=>{e.providersResolver=(i,r)=>function s3(t,n,e){const i=Kt();if(i.firstCreatePass){const r=to(t);Qg(e,i.data,i.blueprint,r,!0),Qg(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class hC{}class h3{resolveComponentFactory(n){throw function d3(t){const n=Error(`No component factory found for ${Jt(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let Is=(()=>{class t{}return t.NULL=new h3,t})();function f3(){return $l(ii(),Se())}function $l(t,n){return new On(Pr(t,n))}let On=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=f3,t})();function p3(t){return t instanceof On?t.nativeElement:t}class au{}let ga=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function m3(){const t=Se(),e=mr(ii().index,t);return function g3(t){return t[11]}(bo(e)?e:t)}(),t})(),_3=(()=>{class t{}return t.\u0275prov=It({token:t,providedIn:"root",factory:()=>null}),t})();class hh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const v3=new hh("13.3.11"),nm={};function fh(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];if(null!==o&&i.push(Zn(o)),eo(o))for(let a=10;a<o.length;a++){const l=o[a],c=l[1].firstChild;null!==c&&fh(l[1],l,c,i)}const s=e.type;if(8&s)fh(t,n,e.child,i);else if(32&s){const a=eg(e,n);let l;for(;l=a();)i.push(l)}else if(16&s){const a=Ty(n,e);if(Array.isArray(a))i.push(...a);else{const l=qc(n[16]);fh(l[1],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class lu{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return fh(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(eo(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(og(n,i),Rd(e,i))}this._attachedToViewContainer=!1}my(this._lView[1],this._lView)}onDestroy(n){Ky(this._lView[1],this._lView,null,n)}markForCheck(){Mg(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function Ag(t,n,e){const i=n[10];i.begin&&i.begin();try{Sl(t,n,t.template,e)}catch(r){throw ub(n,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ke(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function bk(t,n){Xc(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Ke(902,"");this._appRef=n}}class y3 extends lu{constructor(n){super(n),this._view=n}detectChanges(){sb(this._view)}checkNoChanges(){}get context(){return null}}class pC extends Is{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Ai(n);return new im(e,this.ngModule)}}function gC(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class im extends hC{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function Vk(t){return t.map(zk).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return gC(this.componentDef.inputs)}get outputs(){return gC(this.componentDef.outputs)}create(n,e,i,r){const o=(r=r||this.ngModule)?function C3(t,n){return{get:(e,i,r)=>{const o=t.get(e,nm,r);return o!==nm||i===nm?o:n.get(e,i,r)}}}(n,r.injector):n,s=o.get(au,ov),a=o.get(_3,null),l=s.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function Xy(t,n,e){if(kn(t))return t.selectRootElement(n,e===Qr.ShadowDom);let i="string"==typeof n?t.querySelector(n):n;return i.textContent="",i}(l,i,this.componentDef.encapsulation):rg(s.createRenderer(null,this.componentDef),c,function b3(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(c)),h=this.componentDef.onPush?576:528,g=function Mb(t,n){return{components:[],scheduler:t||fk,clean:xA,playerHandler:n||null,flags:0}}(),w=Qd(0,null,null,1,0,null,null,null,null,null),R=Kc(null,w,g,h,null,null,s,l,a,o);let Z,re;Td(R);try{const le=function Db(t,n,e,i,r,o){const s=e[1];e[20]=t;const l=Tl(s,20,2,"#host",null),c=l.mergedAttrs=n.hostAttrs;null!==c&&(eh(l,c,!0),null!==t&&(Ad(r,t,c),null!==l.classes&&ug(r,t,l.classes),null!==l.styles&&My(r,t,l.styles)));const u=i.createRenderer(t,n),h=Kc(e,Yy(n),null,n.onPush?64:16,e[20],l,i,u,o||null,null);return s.firstCreatePass&&(Fd(Nc(l,e),s,n.type),nb(s,l),ib(l,e.length,1)),Jd(e,h),e[20]=h}(u,this.componentDef,R,s,l);if(u)if(i)Ad(l,u,["ng-version",v3.full]);else{const{attrs:J,classes:be}=function Uk(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!io(r))break;r=o}i++}return{attrs:n,classes:e}}(this.componentDef.selectors[0]);J&&Ad(l,u,J),be&&be.length>0&&ug(l,u,be.join(" "))}if(re=yp(w,20),void 0!==e){const J=re.projection=[];for(let be=0;be<this.ngContentSelectors.length;be++){const ye=e[be];J.push(null!=ye?Array.from(ye):null)}}Z=function Sb(t,n,e,i,r){const o=e[1],s=function lA(t,n,e){const i=ii();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),rb(t,i,n,Dl(t,n,1,null),e));const r=Rc(n,t,i.directiveStart,i);Pi(r,n);const o=Pr(i,n);return o&&Pi(o,n),r}(o,e,n);if(i.components.push(s),t[8]=s,r&&r.forEach(l=>l(s,n)),n.contentQueries){const l=ii();n.contentQueries(1,s,l.directiveStart)}const a=ii();return!o.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Ss(a.index),eb(e[1],a,0,a.directiveStart,a.directiveEnd,n),tb(n,s)),s}(le,this.componentDef,R,g,[GA]),Qc(w,R,null)}finally{Dd()}return new E3(this.componentType,Z,$l(re,R),R,re)}}class E3 extends class u3{}{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new y3(r),this.componentType=n}get injector(){return new gl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}class Wl{}const Zl=new Map;class vC extends Wl{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new pC(this);const i=Ar(n);this._bootstrapComponents=To(i.bootstrap),this._r3Injector=gb(n,e,[{provide:Wl,useValue:this},{provide:Is,useValue:this.componentFactoryResolver}],Jt(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,e=Cr.THROW_IF_NOT_FOUND,i=Ot.Default){return n===Cr||n===Wl||n===Og?this:this._r3Injector.get(n,e,i)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class rm extends class T3{}{constructor(n){super(),this.moduleType=n,null!==Ar(n)&&function D3(t){const n=new Set;!function e(i){const r=Ar(i,!0),o=r.id;null!==o&&(function mC(t,n,e){if(n&&n!==e)throw new Error(`Duplicate module registered for ${t} - ${Jt(n)} vs ${Jt(n.name)}`)}(o,Zl.get(o),i),Zl.set(o,i));const s=To(r.imports);for(const a of s)n.has(a)||(n.add(a),e(a))}(t)}(n)}create(n){return new vC(this.moduleType,n)}}function ma(t,n,e){const i=Hi()+t,r=Se();return r[i]===Mt?So(r,i,e?n.call(e):n()):function tu(t,n){return t[n]}(r,i)}function Pt(t,n,e,i){return function yC(t,n,e,i,r,o){const s=n+e;return Fi(t,s,r)?So(t,s+1,o?i.call(o,r):i(r)):cu(t,s+1)}(Se(),Hi(),t,n,e,i)}function vi(t,n,e,i,r){return bC(Se(),Hi(),t,n,e,i,r)}function ph(t,n,e,i,r,o){return function CC(t,n,e,i,r,o,s,a){const l=n+e;return function nh(t,n,e,i,r){const o=fa(t,n,e,i);return Fi(t,n+2,r)||o}(t,l,r,o,s)?So(t,l+3,a?i.call(a,r,o,s):i(r,o,s)):cu(t,l+3)}(Se(),Hi(),t,n,e,i,r,o)}function cu(t,n){const e=t[n];return e===Mt?void 0:e}function bC(t,n,e,i,r,o,s){const a=n+e;return fa(t,a,r,o)?So(t,a+2,s?i.call(s,r,o):i(r,o)):cu(t,a+2)}function Ut(t,n){const e=Kt();let i;const r=t+20;e.firstCreatePass?(i=function P3(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=ua(i.type)),s=Es(ee);try{const a=Od(!1),l=o();return Od(a),function nI(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,Se(),r,l),l}finally{Es(s)}}function jt(t,n,e,i){const r=t+20,o=Se(),s=dl(o,r);return function uu(t,n){return t[1].data[n].pure}(o,r)?bC(o,Hi(),n,s.transform,e,i,s):s.transform(e,i)}function om(t){return n=>{setTimeout(t,void 0,n)}}const Rt=class B3 extends Re{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){var r,o,s;let a=n,l=e||(()=>null),c=i;if(n&&"object"==typeof n){const h=n;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(o=h.error)||void 0===o?void 0:o.bind(h),c=null===(s=h.complete)||void 0===s?void 0:s.bind(h)}this.__isAsync&&(l=om(l),a&&(a=om(a)),c&&(c=om(c)));const u=super.subscribe({next:a,error:l,complete:c});return n instanceof p&&n.add(u),u}};function z3(){return this._results[Al()]()}class sm{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Al(),i=sm.prototype;i[e]||(i[e]=z3)}get changes(){return this._changes||(this._changes=new Rt)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=Fr(n);(this._changesDetected=!function YM(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let rs=(()=>{class t{}return t.__NG_ELEMENT_ID__=j3,t})();const V3=rs,U3=class extends V3{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n){const e=this._declarationTContainer.tViews,i=Kc(this._declarationLView,e,n,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(i[19]=o.createEmbeddedView(e)),Qc(e,i,n),new lu(i)}};function j3(){return gh(ii(),Se())}function gh(t,n){return 4&t.type?new U3(n,t,$l(t,n)):null}let Zi=(()=>{class t{}return t.__NG_ELEMENT_ID__=H3,t})();function H3(){return DC(ii(),Se())}const G3=Zi,xC=class extends G3{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return $l(this._hostTNode,this._hostLView)}get injector(){return new gl(this._hostTNode,this._hostLView)}get parentInjector(){const n=Pd(this._hostTNode,this._hostLView);if(wv(n)){const e=pl(n,this._hostLView),i=fl(n);return new gl(e[1].data[i+8],e)}return new gl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=TC(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,i){const r=n.createEmbeddedView(e||{});return this.insert(r,i),r}createComponent(n,e,i,r,o){const s=n&&!function Bc(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const h=e||{};a=h.index,i=h.injector,r=h.projectableNodes,o=h.ngModuleRef}const l=s?n:new im(Ai(n)),c=i||this.parentInjector;if(!o&&null==l.ngModule){const g=(s?c:this.parentInjector).get(Wl,null);g&&(o=g)}const u=l.create(c,r,void 0,o);return this.insert(u.hostView,a),u}insert(n,e){const i=n._lView,r=i[1];if(function mM(t){return eo(t[3])}(i)){const u=this.indexOf(n);if(-1!==u)this.detach(u);else{const h=i[3],g=new xC(h,h[6],h[3]);g.detach(g.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;!function wk(t,n,e,i){const r=10+i,o=e.length;i>0&&(e[r-1][4]=n),i<o-10?(n[4]=e[r],Ov(e,10+i,n)):(e.push(n),n[4]=null),n[3]=e;const s=n[17];null!==s&&e!==s&&function Ek(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(s,n);const a=n[19];null!==a&&a.insertView(t),n[2]|=128}(r,i,s,o);const a=lg(o,s),l=i[11],c=Wd(l,s[7]);return null!==c&&function yk(t,n,e,i,r,o){i[0]=r,i[6]=n,Xc(t,i,e,1,r,o)}(r,s[6],l,i,c,a),n.attachToViewContainerRef(),Ov(am(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=TC(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=og(this._lContainer,e);i&&(Rd(am(this._lContainer),e),my(i[1],i))}detach(n){const e=this._adjustIndex(n,-1),i=og(this._lContainer,e);return i&&null!=Rd(am(this._lContainer),e)?new lu(i):null}_adjustIndex(n,e=0){return null==n?this.length+e:n}};function TC(t){return t[8]}function am(t){return t[8]||(t[8]=[])}function DC(t,n){let e;const i=n[t.index];if(eo(i))e=i;else{let r;if(8&t.type)r=Zn(i);else{const o=n[11];r=o.createComment("");const s=Pr(t,n);ha(o,Wd(o,s),r,function Sk(t,n){return kn(t)?t.nextSibling(n):n.nextSibling}(o,s),!1)}n[t.index]=e=ob(i,n,r,t),Jd(n,e)}return new xC(e,t,n)}class lm{constructor(n){this.queryList=n,this.matches=null}clone(){return new lm(this.queryList)}setDirty(){this.queryList.setDirty()}}class cm{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new cm(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==IC(n,e).matches&&this.queries[e].setDirty()}}class SC{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class um{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new um(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class dm{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new dm(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,Z3(e,o)),this.matchTNodeWithReadOption(n,e,Nd(e,n,o,!1,!1))}else i===rs?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Nd(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===On||r===Zi||r===rs&&4&e.type)this.addMatch(e.index,-2);else{const o=Nd(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function Z3(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function q3(t,n,e,i){return-1===e?function Y3(t,n){return 11&t.type?$l(t,n):4&t.type?gh(t,n):null}(n,t):-2===e?function X3(t,n,e){return e===On?$l(n,t):e===rs?gh(n,t):e===Zi?DC(n,t):void 0}(t,n,i):Rc(t,t[1],e,n)}function MC(t,n,e,i){const r=n[19].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let l=0;l<s.length;l+=2){const c=s[l];a.push(c<0?null:q3(n,o[c],s[l+1],e.metadata.read))}r.matches=a}return r.matches}function hm(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=MC(t,n,r,e);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const c=o[a+1],u=n[-l];for(let h=10;h<u.length;h++){const g=u[h];g[17]===g[3]&&hm(g[1],g,c,i)}if(null!==u[9]){const h=u[9];for(let g=0;g<h.length;g++){const w=h[g];hm(w[1],w,c,i)}}}}}return i}function zn(t){const n=Se(),e=Kt(),i=fv();Dp(i+1);const r=IC(e,i);if(t.dirty&&sv(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?hm(e,n,i,[]):MC(e,n,r,i);t.reset(o,p3),t.notifyOnChanges()}return!0}return!1}function Vn(t,n,e){const i=Kt();i.firstCreatePass&&(function AC(t,n,e){null===t.queries&&(t.queries=new um),t.queries.track(new dm(n,e))}(i,new SC(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function kC(t,n,e){const i=new sm(4==(4&e));Ky(t,n,i,i.destroy),null===n[19]&&(n[19]=new cm),n[19].queries.push(new lm(i))}(i,Se(),n)}function Un(){return function Q3(t,n){return t[19].queries[n].queryList}(Se(),fv())}function IC(t,n){return t.queries.getByIndex(n)}function Pn(t,n){return gh(t,n)}function vh(...t){}const YC=new Yt("Application Initializer");let vm=(()=>{class t{constructor(e){this.appInits=e,this.resolve=vh,this.reject=vh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(rh(o))e.push(o);else if(Xb(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Ct(YC,8))},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const hu=new Yt("AppId",{providedIn:"root",factory:function qC(){return`${ym()}${ym()}${ym()}`}});function ym(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const XC=new Yt("Platform Initializer"),KC=new Yt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),mP=new Yt("appBootstrapListener"),Os=new Yt("LocaleId",{providedIn:"root",factory:()=>a2(Os,Ot.Optional|Ot.SkipSelf)||function _P(){return"undefined"!=typeof $localize&&$localize.locale||ah}()}),CP=(()=>Promise.resolve(0))();function bm(t){"undefined"==typeof Zone?CP.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Gt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Rt(!1),this.onMicrotaskEmpty=new Rt(!1),this.onStable=new Rt(!1),this.onError=new Rt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function wP(){let t=dn.requestAnimationFrame,n=dn.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function TP(t){const n=()=>{!function xP(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(dn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,wm(t),t.isCheckStableRunning=!0,Cm(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),wm(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return QC(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),JC(t)}},onInvoke:(e,i,r,o,s,a,l)=>{try{return QC(t),e.invoke(r,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&n(),JC(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,wm(t),Cm(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Gt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Gt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,EP,vh,vh);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const EP={};function Cm(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function wm(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function QC(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function JC(t){t._nesting--,Cm(t)}class DP{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Rt,this.onMicrotaskEmpty=new Rt,this.onStable=new Rt,this.onError=new Rt}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}let Em=(()=>{class t{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Gt.assertNotInAngularZone(),bm(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())bm(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(Ct(Gt))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})(),SP=(()=>{class t{constructor(){this._applications=new Map,xm.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return xm.findTestabilityInTree(this,e,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();class MP{addToWindow(n){}findTestabilityInTree(n,e,i){return null}}let xm=new MP,_a=null;const ew=new Yt("AllowMultipleToken"),tw=new Yt("PlatformOnDestroy");function nw(t,n,e=[]){const i=`Platform: ${n}`,r=new Yt(i);return(o=[])=>{let s=Tm();if(!s||s.injector.get(ew,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function OP(t){if(_a&&!_a.get(ew,!1))throw new Ke(400,"");_a=t;const n=t.get(iw),e=t.get(XC,null);e&&e.forEach(i=>i())}(function FP(t=[],n){return Cr.create({name:n,providers:[{provide:Pg,useValue:"platform"},{provide:tw,useValue:()=>_a=null},...t]})}(a,i))}return function PP(t){const n=Tm();if(!n)throw new Ke(401,"");return n}()}}function Tm(){var t;return null!==(t=null==_a?void 0:_a.get(iw))&&void 0!==t?t:null}let iw=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const a=function NP(t,n){let e;return e="noop"===t?new DP:("zone.js"===t?void 0:t)||new Gt({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==n?void 0:n.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==n?void 0:n.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:Gt,useValue:a}];return a.run(()=>{const c=Cr.create({providers:l,parent:this.injector,name:e.moduleType.name}),u=e.create(c),h=u.injector.get(Yc,null);if(!h)throw new Ke(402,"");return a.runOutsideAngular(()=>{const g=a.onError.subscribe({next:w=>{h.handleError(w)}});u.onDestroy(()=>{Dm(this._modules,u),g.unsubscribe()})}),function RP(t,n,e){try{const i=e();return rh(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(h,a,()=>{const g=u.injector.get(vm);return g.runInitializers(),g.donePromise.then(()=>(function gO(t){pr(t,"Expected localeId to be defined"),"string"==typeof t&&(U1=t.toLowerCase().replace(/_/g,"-"))}(u.injector.get(Os,ah)||ah),this._moduleDoBootstrap(u),u))})})}bootstrapModule(e,i=[]){const r=rw({},i);return function AP(t,n,e){const i=new rm(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(ow);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Ke(403,"");e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ke(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(tw,null);null==e||e(),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Ct(Cr))},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function rw(t,n){return Array.isArray(n)?n.reduce(rw,t):Object.assign(Object.assign({},t),n)}let ow=(()=>{class t{constructor(e,i,r,o){this._zone=e,this._injector=i,this._exceptionHandler=r,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new xe(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new xe(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{Gt.assertNotInAngularZone(),bm(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const u=this._zone.onUnstable.subscribe(()=>{Gt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),u.unsubscribe()}});this.isStable=Xr(s,a.pipe(function oa(t={}){const{connector:n=(()=>new Re),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return o=>{let s,a,l,c=0,u=!1,h=!1;const g=()=>{null==a||a.unsubscribe(),a=void 0},w=()=>{g(),s=l=void 0,u=h=!1},R=()=>{const Z=s;w(),null==Z||Z.unsubscribe()};return De((Z,re)=>{c++,!h&&!u&&g();const le=l=null!=l?l:n();re.add(()=>{c--,0===c&&!h&&!u&&(a=nr(R,r))}),le.subscribe(re),!s&&c>0&&(s=new Ce({next:J=>le.next(J),error:J=>{h=!0,g(),a=nr(w,e,J),le.error(J)},complete:()=>{u=!0,g(),a=nr(w,i),le.complete()}}),_o(Z).subscribe(s))})(o)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new Ke(405,"");let r;r=e instanceof hC?e:this._injector.get(Is).resolveComponentFactory(e),this.componentTypes.push(r.componentType);const o=function IP(t){return t.isBoundToModule}(r)?void 0:this._injector.get(Wl),a=r.create(Cr.NULL,[],i||r.selector,o),l=a.location.nativeElement,c=a.injector.get(Em,null),u=c&&a.injector.get(SP);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),Dm(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Ke(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Dm(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(mP,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Ct(Gt),Ct(Cr),Ct(Yc),Ct(vm))},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Dm(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let aw=!0,Ni=(()=>{class t{}return t.__NG_ELEMENT_ID__=zP,t})();function zP(t){return function VP(t,n,e){if(Cd(t)&&!e){const i=mr(t.index,n);return new lu(i,i)}return 47&t.type?new lu(n[16],n):null}(ii(),Se(),16==(16&t))}class hw{constructor(){}supports(n){return eu(n)}create(n){return new WP(n)}}const $P=(t,n)=>n;class WP{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||$P}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<pw(i,r,o)?e:i,a=pw(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const c=a-r,u=l-r;if(c!=u){for(let g=0;g<c;g++){const w=g<o.length?o[g]:o[g]=0,R=w+g;u<=R&&R<c&&(o[g]=w+1)}o[s.previousIndex]=u-c}}a!==l&&n(s,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!eu(n))throw new Ke(900,"");return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function eI(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Al()]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new ZP(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new fw),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new fw),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class ZP{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class YP{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class fw{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new YP,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function pw(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class gw{constructor(){}supports(n){return n instanceof Map||zg(n)}create(){return new qP}}class qP{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||zg(n)))throw new Ke(900,"")}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new XP(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class XP{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function mw(){return new Ch([new hw])}let Ch=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||mw()),deps:[[t,new Vd,new zd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new Ke(901,"")}}return t.\u0275prov=It({token:t,providedIn:"root",factory:mw}),t})();function _w(){return new fu([new gw])}let fu=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||_w()),deps:[[t,new Vd,new zd]]}}find(e){const i=this.factories.find(o=>o.supports(e));if(i)return i;throw new Ke(901,"")}}return t.\u0275prov=It({token:t,providedIn:"root",factory:_w}),t})();const JP=nw(null,"core",[]);let eF=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(Ct(ow))},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({}),t})(),wh=null;function ya(){return wh}const rr=new Yt("DocumentToken");var jn=(()=>((jn=jn||{})[jn.Format=0]="Format",jn[jn.Standalone=1]="Standalone",jn))(),Ht=(()=>((Ht=Ht||{})[Ht.Narrow=0]="Narrow",Ht[Ht.Abbreviated=1]="Abbreviated",Ht[Ht.Wide=2]="Wide",Ht[Ht.Short=3]="Short",Ht))(),Dn=(()=>((Dn=Dn||{})[Dn.Short=0]="Short",Dn[Dn.Medium=1]="Medium",Dn[Dn.Long=2]="Long",Dn[Dn.Full=3]="Full",Dn))(),ft=(()=>((ft=ft||{})[ft.Decimal=0]="Decimal",ft[ft.Group=1]="Group",ft[ft.List=2]="List",ft[ft.PercentSign=3]="PercentSign",ft[ft.PlusSign=4]="PlusSign",ft[ft.MinusSign=5]="MinusSign",ft[ft.Exponential=6]="Exponential",ft[ft.SuperscriptingExponent=7]="SuperscriptingExponent",ft[ft.PerMille=8]="PerMille",ft[ft.Infinity=9]="Infinity",ft[ft.NaN=10]="NaN",ft[ft.TimeSeparator=11]="TimeSeparator",ft[ft.CurrencyDecimal=12]="CurrencyDecimal",ft[ft.CurrencyGroup=13]="CurrencyGroup",ft))();function Eh(t,n){return Br(Wi(t)[qe.DateFormat],n)}function xh(t,n){return Br(Wi(t)[qe.TimeFormat],n)}function Th(t,n){return Br(Wi(t)[qe.DateTimeFormat],n)}function Lr(t,n){const e=Wi(t),i=e[qe.NumberSymbols][n];if(void 0===i){if(n===ft.CurrencyDecimal)return e[qe.NumberSymbols][ft.Decimal];if(n===ft.CurrencyGroup)return e[qe.NumberSymbols][ft.Group]}return i}function Cw(t){if(!t[qe.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[qe.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Br(t,n){for(let e=n;e>-1;e--)if(void 0!==t[e])return t[e];throw new Error("Locale data API: locale data undefined")}function Om(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const yF=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,pu={},bF=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var si=(()=>((si=si||{})[si.Short=0]="Short",si[si.ShortGMT=1]="ShortGMT",si[si.Long=2]="Long",si[si.Extended=3]="Extended",si))(),mt=(()=>((mt=mt||{})[mt.FullYear=0]="FullYear",mt[mt.Month=1]="Month",mt[mt.Date=2]="Date",mt[mt.Hours=3]="Hours",mt[mt.Minutes=4]="Minutes",mt[mt.Seconds=5]="Seconds",mt[mt.FractionalSeconds=6]="FractionalSeconds",mt[mt.Day=7]="Day",mt))(),Nt=(()=>((Nt=Nt||{})[Nt.DayPeriods=0]="DayPeriods",Nt[Nt.Days=1]="Days",Nt[Nt.Months=2]="Months",Nt[Nt.Eras=3]="Eras",Nt))();function CF(t,n,e,i){let r=function AF(t){if(xw(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return Dh(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(yF))return function IF(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,l,c),n}(i)}const n=new Date(t);if(!xw(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=os(e,n)||n;let a,s=[];for(;n;){if(a=bF.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const u=s.pop();if(!u)break;n=u}}let l=r.getTimezoneOffset();i&&(l=Ew(i,l),r=function kF(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function MF(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(Ew(n,r)-r))}(r,i,!0));let c="";return s.forEach(u=>{const h=function SF(t){if(Fm[t])return Fm[t];let n;switch(t){case"G":case"GG":case"GGG":n=_n(Nt.Eras,Ht.Abbreviated);break;case"GGGG":n=_n(Nt.Eras,Ht.Wide);break;case"GGGGG":n=_n(Nt.Eras,Ht.Narrow);break;case"y":n=qn(mt.FullYear,1,0,!1,!0);break;case"yy":n=qn(mt.FullYear,2,0,!0,!0);break;case"yyy":n=qn(mt.FullYear,3,0,!1,!0);break;case"yyyy":n=qn(mt.FullYear,4,0,!1,!0);break;case"Y":n=Ah(1);break;case"YY":n=Ah(2,!0);break;case"YYY":n=Ah(3);break;case"YYYY":n=Ah(4);break;case"M":case"L":n=qn(mt.Month,1,1);break;case"MM":case"LL":n=qn(mt.Month,2,1);break;case"MMM":n=_n(Nt.Months,Ht.Abbreviated);break;case"MMMM":n=_n(Nt.Months,Ht.Wide);break;case"MMMMM":n=_n(Nt.Months,Ht.Narrow);break;case"LLL":n=_n(Nt.Months,Ht.Abbreviated,jn.Standalone);break;case"LLLL":n=_n(Nt.Months,Ht.Wide,jn.Standalone);break;case"LLLLL":n=_n(Nt.Months,Ht.Narrow,jn.Standalone);break;case"w":n=Pm(1);break;case"ww":n=Pm(2);break;case"W":n=Pm(1,!0);break;case"d":n=qn(mt.Date,1);break;case"dd":n=qn(mt.Date,2);break;case"c":case"cc":n=qn(mt.Day,1);break;case"ccc":n=_n(Nt.Days,Ht.Abbreviated,jn.Standalone);break;case"cccc":n=_n(Nt.Days,Ht.Wide,jn.Standalone);break;case"ccccc":n=_n(Nt.Days,Ht.Narrow,jn.Standalone);break;case"cccccc":n=_n(Nt.Days,Ht.Short,jn.Standalone);break;case"E":case"EE":case"EEE":n=_n(Nt.Days,Ht.Abbreviated);break;case"EEEE":n=_n(Nt.Days,Ht.Wide);break;case"EEEEE":n=_n(Nt.Days,Ht.Narrow);break;case"EEEEEE":n=_n(Nt.Days,Ht.Short);break;case"a":case"aa":case"aaa":n=_n(Nt.DayPeriods,Ht.Abbreviated);break;case"aaaa":n=_n(Nt.DayPeriods,Ht.Wide);break;case"aaaaa":n=_n(Nt.DayPeriods,Ht.Narrow);break;case"b":case"bb":case"bbb":n=_n(Nt.DayPeriods,Ht.Abbreviated,jn.Standalone,!0);break;case"bbbb":n=_n(Nt.DayPeriods,Ht.Wide,jn.Standalone,!0);break;case"bbbbb":n=_n(Nt.DayPeriods,Ht.Narrow,jn.Standalone,!0);break;case"B":case"BB":case"BBB":n=_n(Nt.DayPeriods,Ht.Abbreviated,jn.Format,!0);break;case"BBBB":n=_n(Nt.DayPeriods,Ht.Wide,jn.Format,!0);break;case"BBBBB":n=_n(Nt.DayPeriods,Ht.Narrow,jn.Format,!0);break;case"h":n=qn(mt.Hours,1,-12);break;case"hh":n=qn(mt.Hours,2,-12);break;case"H":n=qn(mt.Hours,1);break;case"HH":n=qn(mt.Hours,2);break;case"m":n=qn(mt.Minutes,1);break;case"mm":n=qn(mt.Minutes,2);break;case"s":n=qn(mt.Seconds,1);break;case"ss":n=qn(mt.Seconds,2);break;case"S":n=qn(mt.FractionalSeconds,1);break;case"SS":n=qn(mt.FractionalSeconds,2);break;case"SSS":n=qn(mt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=Mh(si.Short);break;case"ZZZZZ":n=Mh(si.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=Mh(si.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=Mh(si.Long);break;default:return null}return Fm[t]=n,n}(u);c+=h?h(r,e,l):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Dh(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function os(t,n){const e=function aF(t){return Wi(t)[qe.LocaleId]}(t);if(pu[e]=pu[e]||{},pu[e][n])return pu[e][n];let i="";switch(n){case"shortDate":i=Eh(t,Dn.Short);break;case"mediumDate":i=Eh(t,Dn.Medium);break;case"longDate":i=Eh(t,Dn.Long);break;case"fullDate":i=Eh(t,Dn.Full);break;case"shortTime":i=xh(t,Dn.Short);break;case"mediumTime":i=xh(t,Dn.Medium);break;case"longTime":i=xh(t,Dn.Long);break;case"fullTime":i=xh(t,Dn.Full);break;case"short":const r=os(t,"shortTime"),o=os(t,"shortDate");i=Sh(Th(t,Dn.Short),[r,o]);break;case"medium":const s=os(t,"mediumTime"),a=os(t,"mediumDate");i=Sh(Th(t,Dn.Medium),[s,a]);break;case"long":const l=os(t,"longTime"),c=os(t,"longDate");i=Sh(Th(t,Dn.Long),[l,c]);break;case"full":const u=os(t,"fullTime"),h=os(t,"fullDate");i=Sh(Th(t,Dn.Full),[u,h])}return i&&(pu[e][n]=i),i}function Sh(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function lo(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.substr(s.length-n)),o+s}function qn(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function EF(t,n){switch(t){case mt.FullYear:return n.getFullYear();case mt.Month:return n.getMonth();case mt.Date:return n.getDate();case mt.Hours:return n.getHours();case mt.Minutes:return n.getMinutes();case mt.Seconds:return n.getSeconds();case mt.FractionalSeconds:return n.getMilliseconds();case mt.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===mt.Hours)0===a&&-12===e&&(a=12);else if(t===mt.FractionalSeconds)return function wF(t,n){return lo(t,3).substr(0,n)}(a,n);const l=Lr(s,ft.MinusSign);return lo(a,n,l,i,r)}}function _n(t,n,e=jn.Format,i=!1){return function(r,o){return function xF(t,n,e,i,r,o){switch(e){case Nt.Months:return function uF(t,n,e){const i=Wi(t),o=Br([i[qe.MonthsFormat],i[qe.MonthsStandalone]],n);return Br(o,e)}(n,r,i)[t.getMonth()];case Nt.Days:return function cF(t,n,e){const i=Wi(t),o=Br([i[qe.DaysFormat],i[qe.DaysStandalone]],n);return Br(o,e)}(n,r,i)[t.getDay()];case Nt.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const c=function pF(t){const n=Wi(t);return Cw(n),(n[qe.ExtraData][2]||[]).map(i=>"string"==typeof i?Om(i):[Om(i[0]),Om(i[1])])}(n),u=function gF(t,n,e){const i=Wi(t);Cw(i);const o=Br([i[qe.ExtraData][0],i[qe.ExtraData][1]],n)||[];return Br(o,e)||[]}(n,r,i),h=c.findIndex(g=>{if(Array.isArray(g)){const[w,R]=g,Z=s>=w.hours&&a>=w.minutes,re=s<R.hours||s===R.hours&&a<R.minutes;if(w.hours<R.hours){if(Z&&re)return!0}else if(Z||re)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(-1!==h)return u[h]}return function lF(t,n,e){const i=Wi(t),o=Br([i[qe.DayPeriodsFormat],i[qe.DayPeriodsStandalone]],n);return Br(o,e)}(n,r,i)[s<12?0:1];case Nt.Eras:return function dF(t,n){return Br(Wi(t)[qe.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function Mh(t){return function(n,e,i){const r=-1*i,o=Lr(e,ft.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case si.Short:return(r>=0?"+":"")+lo(s,2,o)+lo(Math.abs(r%60),2,o);case si.ShortGMT:return"GMT"+(r>=0?"+":"")+lo(s,1,o);case si.Long:return"GMT"+(r>=0?"+":"")+lo(s,2,o)+":"+lo(Math.abs(r%60),2,o);case si.Extended:return 0===i?"Z":(r>=0?"+":"")+lo(s,2,o)+":"+lo(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}function ww(t){return Dh(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function Pm(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=ww(e),s=function DF(t){const n=Dh(t,0,1).getDay();return Dh(t,0,1+(n<=4?4:11)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return lo(r,t,Lr(i,ft.MinusSign))}}function Ah(t,n=!1){return function(e,i){return lo(ww(e).getFullYear(),t,Lr(i,ft.MinusSign),n)}}const Fm={};function Ew(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function xw(t){return t instanceof Date&&!isNaN(t.valueOf())}let yi=(()=>{class t{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(eu(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Jt(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(ee(Ch),ee(fu),ee(On),ee(ga))},t.\u0275dir=gt({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class $F{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Fn=(()=>{class t{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new $F(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),Mw(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{Mw(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(ee(Zi),ee(rs),ee(Ch))},t.\u0275dir=gt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function Mw(t,n){t.context.$implicit=n.item}let un=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new WF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){kw("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){kw("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(ee(Zi),ee(rs))},t.\u0275dir=gt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class WF{constructor(){this.$implicit=null,this.ngIf=null}}function kw(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Jt(n)}'.`)}class Vm{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let ba=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=gt({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),mu=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new Vm(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(ee(Zi),ee(rs),ee(ba,9))},t.\u0275dir=gt({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),_u=(()=>{class t{constructor(e,i,r){r._addDefault(new Vm(e,i))}}return t.\u0275fac=function(e){return new(e||t)(ee(Zi),ee(rs),ee(ba,9))},t.\u0275dir=gt({type:t,selectors:[["","ngSwitchDefault",""]]}),t})(),Ca=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split(".");null!=(i=null!=i&&o?`${i}${o}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(ee(On),ee(fu),ee(ga))},t.\u0275dir=gt({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),vu=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(ee(Zi))},t.\u0275dir=gt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[no]}),t})();const iN=new Yt("DATE_PIPE_DEFAULT_TIMEZONE");let Iw=(()=>{class t{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,o){var s;if(null==e||""===e||e!=e)return null;try{return CF(e,i,o||this.locale,null!==(s=null!=r?r:this.defaultTimezone)&&void 0!==s?s:void 0)}catch(a){throw function co(t,n){return new Ke(2100,"")}()}}}return t.\u0275fac=function(e){return new(e||t)(ee(Os,16),ee(iN,24))},t.\u0275pipe=ji({name:"date",type:t,pure:!0}),t})(),Pw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({}),t})();class Hm extends class yN extends class iF{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function nF(t){wh||(wh=t)}(new Hm)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function bN(){return yu=yu||document.querySelector("base"),yu?yu.getAttribute("href"):null}();return null==e?null:function CN(t){Oh=Oh||document.createElement("a"),Oh.setAttribute("href",t);const n=Oh.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){yu=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function HF(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let Oh,yu=null;const Rw=new Yt("TRANSITION_ID"),EN=[{provide:YC,useFactory:function wN(t,n,e){return()=>{e.get(vm).donePromise.then(()=>{const i=ya(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[Rw,rr,Cr],multi:!0}];class Gm{static init(){!function kP(t){xm=t}(new Gm)}addToWindow(n){dn.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},dn.getAllAngularTestabilities=()=>n.getAllTestabilities(),dn.getAllAngularRootElements=()=>n.getAllRootElements(),dn.frameworkStabilizers||(dn.frameworkStabilizers=[]),dn.frameworkStabilizers.push(i=>{const r=dn.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(l){s=s||l,o--,0==o&&i(s)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(n,e,i){if(null==e)return null;const r=n.getTestability(e);return null!=r?r:i?ya().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null}}let xN=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();const Ph=new Yt("EventManagerPlugins");let Fh=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(Ct(Ph),Ct(Gt))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();class Lw{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=ya().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let Bw=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})(),bu=(()=>{class t extends Bw{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,r.push(i.appendChild(s))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(zw),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(zw))}}return t.\u0275fac=function(e){return new(e||t)(Ct(rr))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();function zw(t){ya().remove(t)}const $m={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Wm=/%COMP%/g;function Nh(t,n,e){for(let i=0;i<n.length;i++){let r=n[i];Array.isArray(r)?Nh(t,r,e):(r=r.replace(Wm,t),e.push(r))}return e}function jw(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let Rh=(()=>{class t{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Zm(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case Qr.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new AN(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case Qr.ShadowDom:return new IN(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=Nh(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Ct(Fh),Ct(bu),Ct(hu))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();class Zm{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS($m[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){n.appendChild(e)}insertBefore(n,e,i){n&&n.insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=$m[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=$m[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(yr.DashCase|yr.Important)?n.style.setProperty(e,i,r&yr.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&yr.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,jw(i)):this.eventManager.addEventListener(n,e,jw(i))}}class AN extends Zm{constructor(n,e,i,r){super(n),this.component=i;const o=Nh(r+"-"+i.id,i.styles,[]);e.addStyles(o),this.contentAttr=function SN(t){return"_ngcontent-%COMP%".replace(Wm,t)}(r+"-"+i.id),this.hostAttr=function MN(t){return"_nghost-%COMP%".replace(Wm,t)}(r+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}class IN extends Zm{constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Nh(r.id,r.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let ON=(()=>{class t extends Lw{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)(Ct(rr))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();const Gw=["alt","control","meta","shift"],FN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$w={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},NN={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let RN=(()=>{class t extends Lw{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ya().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="";if(Gw.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),s+=l+".")}),s+=o,0!=i.length||0===o.length)return null;const a={};return a.domEventName=r,a.fullKey=s,a}static getEventFullKey(e){let i="",r=function LN(t){let n=t.key;if(null==n){if(n=t.keyIdentifier,null==n)return"Unidentified";n.startsWith("U+")&&(n=String.fromCharCode(parseInt(n.substring(2),16)),3===t.location&&$w.hasOwnProperty(n)&&(n=$w[n]))}return FN[n]||n}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Gw.forEach(o=>{o!=r&&NN[o](e)&&(i+=o+".")}),i+=r,i}static eventCallback(e,i,r){return o=>{t.getEventFullKey(o)===e&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(Ct(rr))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();const UN=nw(JP,"browser",[{provide:KC,useValue:"browser"},{provide:XC,useValue:function BN(){Hm.makeCurrent(),Gm.init()},multi:!0},{provide:rr,useFactory:function VN(){return function hM(t){_p=t}(document),document},deps:[]}]),jN=[{provide:Pg,useValue:"root"},{provide:Yc,useFactory:function zN(){return new Yc},deps:[]},{provide:Ph,useClass:ON,multi:!0,deps:[rr,Gt,KC]},{provide:Ph,useClass:RN,multi:!0,deps:[rr]},{provide:Rh,useClass:Rh,deps:[Fh,bu,hu]},{provide:au,useExisting:Rh},{provide:Bw,useExisting:bu},{provide:bu,useClass:bu,deps:[rr]},{provide:Em,useClass:Em,deps:[Gt]},{provide:Fh,useClass:Fh,deps:[Ph,Gt]},{provide:class vN{},useClass:xN,deps:[]}];let Ww=(()=>{class t{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:hu,useValue:e.appId},{provide:Rw,useExisting:hu},EN]}}}return t.\u0275fac=function(e){return new(e||t)(Ct(t,12))},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({providers:jN,imports:[Pw,eF]}),t})();"undefined"!=typeof window&&window;let qw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:function(e){let i=null;return i=e?new(e||t):Ct(Xw),i},providedIn:"root"}),t})(),Xw=(()=>{class t extends qw{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case mn.NONE:return i;case mn.HTML:return Eo(i,"HTML")?vr(i):ty(this._doc,String(i)).toString();case mn.STYLE:return Eo(i,"Style")?vr(i):i;case mn.SCRIPT:if(Eo(i,"Script"))return vr(i);throw new Error("unsafe value used in a script context");case mn.URL:return Zv(i),Eo(i,"URL")?vr(i):Gc(String(i));case mn.RESOURCE_URL:if(Eo(i,"ResourceURL"))return vr(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function D2(t){return new C2(t)}(e)}bypassSecurityTrustStyle(e){return function S2(t){return new w2(t)}(e)}bypassSecurityTrustScript(e){return function M2(t){return new E2(t)}(e)}bypassSecurityTrustUrl(e){return function k2(t){return new x2(t)}(e)}bypassSecurityTrustResourceUrl(e){return function A2(t){return new T2(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(Ct(rr))},t.\u0275prov=It({token:t,factory:function(e){let i=null;return i=e?new e:function QN(t){return new Xw(t.get(rr))}(Ct(Cr)),i},providedIn:"root"}),t})();q(5386);const{isArray:JN}=Array,{getPrototypeOf:eR,prototype:tR,keys:nR}=Object;const{isArray:oR}=Array;function lR(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}function cR(...t){const n=function hd(t){return M(tl(t))?t.pop():void 0}(t),{args:e,keys:i}=function iR(t){if(1===t.length){const n=t[0];if(JN(n))return{args:n,keys:null};if(function rR(t){return t&&"object"==typeof t&&eR(t)===tR}(n)){const e=nR(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}(t),r=new xe(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let l=s,c=s;for(let u=0;u<s;u++){let h=!1;_o(e[u]).subscribe(Pe(o,g=>{h||(h=!0,c--),a[u]=g},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?lR(i,a):a),o.complete())}))}});return n?r.pipe(function aR(t){return tt(n=>function sR(t,n){return oR(n)?t(...n):t(n)}(t,n))}(n)):r}let Kw=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(ee(ga),ee(On))},t.\u0275dir=gt({type:t}),t})(),wa=(()=>{class t extends Kw{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,features:[cn]}),t})();const ko=new Yt("NgValueAccessor"),uR={provide:ko,useExisting:nn(()=>qm),multi:!0};let qm=(()=>{class t extends wa{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&ue("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[En([uR]),cn]}),t})();const dR={provide:ko,useExisting:nn(()=>bi),multi:!0},fR=new Yt("CompositionEventMode");let bi=(()=>{class t extends Kw{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function hR(){const t=ya()?ya().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(ee(ga),ee(On),ee(fR,8))},t.\u0275dir=gt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&ue("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[En([dR]),cn]}),t})();function Fs(t){return null==t||0===t.length}function Qw(t){return null!=t&&"number"==typeof t.length}const Ri=new Yt("NgValidators"),Ns=new Yt("NgAsyncValidators");function tE(t){return Fs(t.value)?{required:!0}:null}function Lh(t){return null}function aE(t){return null!=t}function lE(t){const n=rh(t)?qr(t):t;return Xb(n),n}function cE(t){let n={};return t.forEach(e=>{n=null!=e?Object.assign(Object.assign({},n),e):n}),0===Object.keys(n).length?null:n}function uE(t,n){return n.map(e=>e(t))}function dE(t){return t.map(n=>function gR(t){return!t.validate}(n)?n:e=>n.validate(e))}function Xm(t){return null!=t?function hE(t){if(!t)return null;const n=t.filter(aE);return 0==n.length?null:function(e){return cE(uE(e,n))}}(dE(t)):null}function Km(t){return null!=t?function fE(t){if(!t)return null;const n=t.filter(aE);return 0==n.length?null:function(e){return cR(uE(e,n).map(lE)).pipe(tt(cE))}}(dE(t)):null}function pE(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function Qm(t){return t?Array.isArray(t)?t:[t]:[]}function Bh(t,n){return Array.isArray(t)?t.includes(n):t===n}function _E(t,n){const e=Qm(n);return Qm(t).forEach(r=>{Bh(e,r)||e.push(r)}),e}function vE(t,n){return Qm(n).filter(e=>!Bh(t,e))}class yE{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=Xm(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=Km(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Rs extends yE{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class qi extends yE{get formDirective(){return null}get path(){return null}}class bE{constructor(n){this._cd=n}is(n){var e,i,r;return"submitted"===n?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[n])}}let Li=(()=>{class t extends bE{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(ee(Rs,2))},t.\u0275dir=gt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&oh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[cn]}),t})(),ql=(()=>{class t extends bE{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(ee(qi,10))},t.\u0275dir=gt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&oh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[cn]}),t})();function Cu(t,n){t_(t,n),n.valueAccessor.writeValue(t.value),function ER(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&wE(t,n)})}(t,n),function TR(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function xR(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&wE(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function wR(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function jh(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function t_(t,n){const e=function gE(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(pE(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function mE(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(pE(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();jh(n._rawValidators,r),jh(n._rawAsyncValidators,r)}function wE(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function r_(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}const wu="VALID",Gh="INVALID",Xl="PENDING",Eu="DISABLED";function s_(t){return($h(t)?t.validators:t)||null}function DE(t){return Array.isArray(t)?Xm(t):t||null}function a_(t,n){return($h(n)?n.asyncValidators:t)||null}function SE(t){return Array.isArray(t)?Km(t):t||null}function $h(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}const l_=t=>t instanceof u_;function kE(t){return(t=>t instanceof OE)(t)?t.value:t.getRawValue()}function AE(t,n){const e=l_(t),i=t.controls;if(!(e?Object.keys(i):i).length)throw new Ke(1e3,"");if(!i[n])throw new Ke(1001,"")}function IE(t,n){l_(t),t._forEachChild((i,r)=>{if(void 0===n[r])throw new Ke(1002,"")})}class c_{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=e,this._composedValidatorFn=DE(this._rawValidators),this._composedAsyncValidatorFn=SE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===wu}get invalid(){return this.status===Gh}get pending(){return this.status==Xl}get disabled(){return this.status===Eu}get enabled(){return this.status!==Eu}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=DE(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=SE(n)}addValidators(n){this.setValidators(_E(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(_E(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(vE(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(vE(n,this._rawAsyncValidators))}hasValidator(n){return Bh(this._rawValidators,n)}hasAsyncValidator(n){return Bh(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Xl,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Eu,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=wu,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===wu||this.status===Xl)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Eu:wu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Xl,this._hasOwnPendingAsyncValidator=!0;const e=lE(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){return function kR(t,n,e){if(null==n||(Array.isArray(n)||(n=n.split(e)),Array.isArray(n)&&0===n.length))return null;let i=t;return n.forEach(r=>{i=l_(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(t=>t instanceof IR)(i)&&i.at(r)||null}),i}(this,n,".")}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Rt,this.statusChanges=new Rt}_calculateStatus(){return this._allControlsDisabled()?Eu:this.errors?Gh:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Xl)?Xl:this._anyControlsHaveStatus(Gh)?Gh:wu}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_isBoxedValue(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){$h(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class OE extends c_{constructor(n=null,e,i){super(s_(e),a_(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$h(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){r_(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){r_(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){this._isBoxedValue(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}}class u_ extends c_{constructor(n,e,i){super(s_(e),a_(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){IE(this,n),Object.keys(n).forEach(i=>{AE(this,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=kE(e),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&n(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(n,e,i)=>((e.enabled||this.disabled)&&(n[i]=e.value),n))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class IR extends c_{constructor(n,e,i){super(s_(e),a_(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[n]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,i={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),e&&(this.controls.splice(n,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){IE(this,n),n.forEach((i,r)=>{AE(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>kE(n))}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_syncPendingControls(){let n=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,i)=>{n(e,i)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}}const OR={provide:qi,useExisting:nn(()=>Ls)},xu=(()=>Promise.resolve(null))();let Ls=(()=>{class t extends qi{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Rt,this.form=new u_({},Xm(e),Km(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){xu.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Cu(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){xu.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){xu.then(()=>{const i=this._findContainer(e.path),r=new u_({});(function EE(t,n){t_(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){xu.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){xu.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function TE(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(ee(Ri,10),ee(Ns,10))},t.\u0275dir=gt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&ue("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[En([OR]),cn]}),t})();const FR={provide:Rs,useExisting:nn(()=>Ci)},NE=(()=>Promise.resolve(null))();let Ci=(()=>{class t extends Rs{constructor(e,i,r,o,s){super(),this._changeDetectorRef=s,this.control=new OE,this._registered=!1,this.update=new Rt,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function i_(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===bi?e=o:function MR(t){return Object.getPrototypeOf(t.constructor)===wa}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function n_(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Cu(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){NE.then(()=>{var i;this.control.setValue(e,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=""===i||i&&"false"!==i;NE.then(()=>{var o;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(o=this._changeDetectorRef)||void 0===o||o.markForCheck()})}_getPath(e){return this._parent?function Vh(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(ee(qi,9),ee(Ri,10),ee(Ns,10),ee(ko,10),ee(Ni,8))},t.\u0275dir=gt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[En([FR]),cn,no]}),t})(),Kl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=gt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const NR={provide:ko,useExisting:nn(()=>Ea),multi:!0};let Ea=(()=>{class t extends wa{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&ue("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[En([NR]),cn]}),t})();const RR={provide:ko,useExisting:nn(()=>Tu),multi:!0};let RE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({}),t})(),LR=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:RE}),t})(),Tu=(()=>{class t extends wa{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Rs),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(ee(ga),ee(On),ee(LR),ee(Cr))},t.\u0275dir=gt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&ue("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[En([RR]),cn]}),t})();const BR={provide:ko,useExisting:nn(()=>Bs),multi:!0};let Bs=(()=>{class t extends wa{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&ue("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[En([BR]),cn]}),t})();const GR={provide:ko,useExisting:nn(()=>ss),multi:!0};function UE(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let ss=(()=>{class t extends wa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=UE(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function $R(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&ue("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[En([GR]),cn]}),t})(),zs=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(UE(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(ee(On),ee(ga),ee(ss,9))},t.\u0275dir=gt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const WR={provide:ko,useExisting:nn(()=>p_),multi:!0};function jE(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let p_=(()=>{class t extends wa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const c=this._getOptionValue(s[a].value);r.push(c)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function ZR(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&ue("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[En([WR]),cn]}),t})(),Vs=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(jE(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(jE(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(ee(On),ee(ga),ee(p_,9))},t.\u0275dir=gt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function HE(t){return"number"==typeof t?t:parseInt(t,10)}function GE(t){return"number"==typeof t?t:parseFloat(t)}let xa=(()=>{class t{constructor(){this._validator=Lh}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Lh,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=gt({type:t,features:[no]}),t})();const qR={provide:Ri,useExisting:nn(()=>Wh),multi:!0};let Wh=(()=>{class t extends xa{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>GE(e),this.createValidator=e=>function eE(t){return n=>{if(Fs(n.value)||Fs(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rr("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[En([qR]),cn]}),t})();const XR={provide:Ri,useExisting:nn(()=>Zh),multi:!0};let Zh=(()=>{class t extends xa{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>GE(e),this.createValidator=e=>function Jw(t){return n=>{if(Fs(n.value)||Fs(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rr("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[En([XR]),cn]}),t})();const KR={provide:Ri,useExisting:nn(()=>Yh),multi:!0};let Yh=(()=>{class t extends xa{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function YR(t){return null!=t&&!1!==t&&"false"!=`${t}`}(e),this.createValidator=e=>tE}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Rr("required",i._enabled?"":null)},inputs:{required:"required"},features:[En([KR]),cn]}),t})();const eL={provide:Ri,useExisting:nn(()=>g_),multi:!0};let g_=(()=>{class t extends xa{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>HE(e),this.createValidator=e=>function rE(t){return n=>Fs(n.value)||!Qw(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rr("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[En([eL]),cn]}),t})();const tL={provide:Ri,useExisting:nn(()=>m_),multi:!0};let m_=(()=>{class t extends xa{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>HE(e),this.createValidator=e=>function oE(t){return n=>Qw(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Oi(t)))(i||t)}}(),t.\u0275dir=gt({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rr("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[En([tL]),cn]}),t})(),iL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({imports:[[RE]]}),t})(),rL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({imports:[iL]}),t})();class YE{}const as="*";function Ao(t,n){return{type:7,name:t,definitions:n,options:{}}}function wi(t,n=null){return{type:4,styles:n,timings:t}}function qE(t,n=null){return{type:2,steps:t,options:n}}function _t(t){return{type:6,styles:t,offset:null}}function __(t,n,e){return{type:0,name:t,styles:n,options:e}}function uo(t){return{type:5,steps:t}}function Ei(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function XE(t){Promise.resolve(null).then(t)}class Du{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._onStartFns.push(n)}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){XE(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class KE{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?XE(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const $t=!1;function QE(t){return new Ke(3e3,$t)}function zL(){return"undefined"!=typeof window&&void 0!==window.document}function y_(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Us(t){switch(t.length){case 0:return new Du;case 1:return t[0];default:return new KE(t)}}function JE(t,n,e,i,r={},o={}){const s=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const h=u.offset,g=h==l,w=g&&c||{};Object.keys(u).forEach(R=>{let Z=R,re=u[R];if("offset"!==R)switch(Z=n.normalizePropertyName(Z,s),re){case"!":re=r[R];break;case as:re=o[R];break;default:re=n.normalizeStyleValue(R,Z,re,s)}w[Z]=re}),g||a.push(w),c=w,l=h}),s.length)throw function ML(t){return new Ke(3502,$t)}();return a}function b_(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&C_(e,"start",t)));break;case"done":t.onDone(()=>i(e&&C_(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&C_(e,"destroy",t)))}}function C_(t,n,e){const i=e.totalTime,o=w_(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,null==i?t.totalTime:i,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function w_(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function Er(t,n,e){let i;return t instanceof Map?(i=t.get(n),i||t.set(n,i=e)):(i=t[n],i||(i=t[n]=e)),i}function ex(t){const n=t.indexOf(":");return[t.substring(1,n),t.substr(n+1)]}let E_=(t,n)=>!1,tx=(t,n,e)=>[],nx=null;function x_(t){const n=t.parentNode||t.host;return n===nx?null:n}(y_()||"undefined"!=typeof Element)&&(zL()?(nx=(()=>document.documentElement)(),E_=(t,n)=>{for(;n;){if(n===t)return!0;n=x_(n)}return!1}):E_=(t,n)=>t.contains(n),tx=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let Ta=null,ix=!1;function rx(t){Ta||(Ta=function UL(){return"undefined"!=typeof document?document.body:null}()||{},ix=!!Ta.style&&"WebkitAppearance"in Ta.style);let n=!0;return Ta.style&&!function VL(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Ta.style,!n&&ix&&(n="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in Ta.style)),n}const ox=E_,sx=tx;let ax=(()=>{class t{validateStyleProperty(e){return rx(e)}matchesElement(e,i){return!1}containsElement(e,i){return ox(e,i)}getParentElement(e){return x_(e)}query(e,i,r){return sx(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],l){return new Du(r,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})(),T_=(()=>{class t{}return t.NOOP=new ax,t})();const D_="ng-enter",Xh="ng-leave",Kh="ng-trigger",Qh=".ng-trigger",cx="ng-animating",S_=".ng-animating";function Da(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:M_(parseFloat(n[1]),n[2])}function M_(t,n){return"s"===n?1e3*t:t}function Jh(t,n,e){return t.hasOwnProperty("duration")?t:function GL(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(QE()),{duration:0,delay:0,easing:""};r=M_(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(o=M_(parseFloat(l),a[4]));const c=a[5];c&&(s=c)}else r=t;if(!e){let a=!1,l=n.length;r<0&&(n.push(function sL(){return new Ke(3100,$t)}()),a=!0),o<0&&(n.push(function aL(){return new Ke(3101,$t)}()),a=!0),a&&n.splice(l,0,QE())}return{duration:r,delay:o,easing:s}}(t,n,e)}function Ql(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function js(t,n,e={}){if(n)for(let i in t)e[i]=t[i];else Ql(t,e);return e}function dx(t,n,e){return e?n+":"+e+";":""}function hx(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=dx(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=dx(0,ZL(e),t.style[e]));t.setAttribute("style",n)}function Io(t,n,e){t.style&&(Object.keys(n).forEach(i=>{const r=A_(i);e&&!e.hasOwnProperty(i)&&(e[i]=t.style[r]),t.style[r]=n[i]}),y_()&&hx(t))}function Sa(t,n){t.style&&(Object.keys(n).forEach(e=>{const i=A_(e);t.style[i]=""}),y_()&&hx(t))}function Su(t){return Array.isArray(t)?1==t.length?t[0]:qE(t):t}const k_=new RegExp("{{\\s*(.+?)\\s*}}","g");function fx(t){let n=[];if("string"==typeof t){let e;for(;e=k_.exec(t);)n.push(e[1]);k_.lastIndex=0}return n}function ef(t,n,e){const i=t.toString(),r=i.replace(k_,(o,s)=>{let a=n[s];return n.hasOwnProperty(s)||(e.push(function cL(t){return new Ke(3003,$t)}()),a=""),a.toString()});return r==i?t:r}function tf(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const WL=/-+([a-z0-9])/g;function A_(t){return t.replace(WL,(...n)=>n[1].toUpperCase())}function ZL(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function xr(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function uL(t){return new Ke(3004,$t)}()}}function px(t,n){return window.getComputedStyle(t)[n]}function JL(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function e4(t,n,e){if(":"==t[0]){const l=function t4(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function xL(t){return new Ke(3016,$t)}()),"* => *"}}(t,e);if("function"==typeof l)return void n.push(l);t=l}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function EL(t){return new Ke(3015,$t)}()),n;const r=i[1],o=i[2],s=i[3];n.push(gx(r,s));"<"==o[0]&&!("*"==r&&"*"==s)&&n.push(gx(s,r))}(i,e,n)):e.push(t),e}const sf=new Set(["true","1"]),af=new Set(["false","0"]);function gx(t,n){const e=sf.has(t)||af.has(t),i=sf.has(n)||af.has(n);return(r,o)=>{let s="*"==t||t==r,a="*"==n||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?sf.has(t):af.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?sf.has(n):af.has(n)),s&&a}}const n4=new RegExp("s*:selfs*,?","g");function I_(t,n,e,i){return new i4(t).build(n,e,i)}class i4{constructor(n){this._driver=n}build(n,e,i){const r=new s4(e);this._resetContextStyleTimingState(r);const o=xr(this,Su(n),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),o}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles={},n.collectedStyles[""]={},n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function hL(){return new Ke(3006,$t)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,o.push(this.visitState(l,e))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,e);i+=l.queryCount,r+=l.depCount,s.push(l)}else e.errors.push(function fL(){return new Ke(3007,$t)}())}),{type:7,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{if(lf(a)){const l=a;Object.keys(l).forEach(c=>{fx(l[c]).forEach(u=>{s.hasOwnProperty(u)||o.add(u)})})}}),o.size&&(tf(o.values()),e.errors.push(function pL(t,n){return new Ke(3008,$t)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=xr(this,Su(n.animation),e);return{type:1,matchers:JL(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Ma(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>xr(this,i,e)),options:Ma(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=xr(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:Ma(n.options)}}visitAnimate(n,e){const i=function l4(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return O_(Jh(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=O_(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=Jh(e,n);return O_(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:_t({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const c={};i.easing&&(c.easing=i.easing),s=_t(c)}e.currentTime+=i.duration+i.delay;const l=this.visitStyle(s,e);l.isEmptyStep=a,r=l}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[];Array.isArray(n.styles)?n.styles.forEach(s=>{"string"==typeof s?s==as?i.push(s):e.errors.push(function gL(t){return new Ke(3002,$t)}()):i.push(s)}):i.push(n.styles);let r=!1,o=null;return i.forEach(s=>{if(lf(s)){const a=s,l=a.easing;if(l&&(o=l,delete a.easing),!r)for(let c in a)if(a[c].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:o,offset:n.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&Object.keys(s).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete s[a],void e.unsupportedCSSPropertiesFound.add(a);const l=e.collectedStyles[e.currentQuerySelector],c=l[a];let u=!0;c&&(o!=r&&o>=c.startTime&&r<=c.endTime&&(e.errors.push(function mL(t,n,e,i,r){return new Ke(3010,$t)}()),u=!1),o=c.startTime),u&&(l[a]={startTime:o,endTime:r}),e.options&&function $L(t,n,e){const i=n.params||{},r=fx(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function lL(t){return new Ke(3001,$t)}())})}(s[a],e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function _L(){return new Ke(3011,$t)}()),i;let o=0;const s=[];let a=!1,l=!1,c=0;const u=n.steps.map(le=>{const J=this._makeStyleAst(le,e);let be=null!=J.offset?J.offset:function a4(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(lf(e)&&e.hasOwnProperty("offset")){const i=e;n=parseFloat(i.offset),delete i.offset}});else if(lf(t)&&t.hasOwnProperty("offset")){const e=t;n=parseFloat(e.offset),delete e.offset}return n}(J.styles),ye=0;return null!=be&&(o++,ye=J.offset=be),l=l||ye<0||ye>1,a=a||ye<c,c=ye,s.push(ye),J});l&&e.errors.push(function vL(){return new Ke(3012,$t)}()),a&&e.errors.push(function yL(){return new Ke(3200,$t)}());const h=n.steps.length;let g=0;o>0&&o<h?e.errors.push(function bL(){return new Ke(3202,$t)}()):0==o&&(g=1/(h-1));const w=h-1,R=e.currentTime,Z=e.currentAnimateTimings,re=Z.duration;return u.forEach((le,J)=>{const be=g>0?J==w?1:g*J:s[J],ye=be*re;e.currentTime=R+Z.delay+ye,Z.duration=ye,this._validateStyleAst(le,e),le.offset=be,i.styles.push(le)}),i}visitReference(n,e){return{type:8,animation:xr(this,Su(n.animation),e),options:Ma(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:Ma(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:Ma(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function r4(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(n4,"")),t=t.replace(/@\*/g,Qh).replace(/@\w+/g,e=>Qh+"-"+e.substr(1)).replace(/:animating/g,S_),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,Er(e.collectedStyles,e.currentQuerySelector,{});const a=xr(this,Su(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:Ma(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function CL(){return new Ke(3013,$t)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:Jh(n.timings,e.errors,!0);return{type:12,animation:xr(this,Su(n.animation),e),timings:i,options:null}}}class s4{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function lf(t){return!Array.isArray(t)&&"object"==typeof t}function Ma(t){return t?(t=Ql(t)).params&&(t.params=function o4(t){return t?Ql(t):null}(t.params)):t={},t}function O_(t,n,e){return{duration:t,delay:n,easing:e}}function P_(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class cf{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const d4=new RegExp(":enter","g"),f4=new RegExp(":leave","g");function F_(t,n,e,i,r,o={},s={},a,l,c=[]){return(new p4).buildKeyframes(t,n,e,i,r,o,s,a,l,c)}class p4{buildKeyframes(n,e,i,r,o,s,a,l,c,u=[]){c=c||new cf;const h=new N_(n,e,c,r,o,u,[]);h.options=l,h.currentTimeline.setStyles([s],null,h.errors,l),xr(this,i,h);const g=h.timelines.filter(w=>w.containsAnimation());if(Object.keys(a).length){let w;for(let R=g.length-1;R>=0;R--){const Z=g[R];if(Z.element===e){w=Z;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([a],null,h.errors,l)}return g.length?g.map(w=>w.buildKeyframes()):[P_(e,[],[],[],0,0,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?Da(i.duration):null,a=null!=i.delay?Da(i.delay):null;return 0!==s&&n.forEach(l=>{const c=e.appendInstructionToTimeline(l,s,a);o=Math.max(o,c.duration+c.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),xr(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=uf);const s=Da(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>xr(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?Da(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),xr(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return Jh(e.params?ef(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(l=>{a.forwardTime((l.offset||0)*o),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?Da(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=uf);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;const h=e.createSubContext(n.options,c);o&&h.delayNextStep(o),c===e.element&&(l=h.currentTimeline),xr(this,n.animation,h),h.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,h.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let l=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=e.currentTimeline;l&&u.delayNextStep(l);const h=u.currentTime;xr(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const uf={};class N_{constructor(n,e,i,r,o,s,a,l){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=uf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new df(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=Da(i.duration)),null!=i.delay&&(r.delay=Da(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=ef(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new N_(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=uf,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:null!=e?e:n.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+n.delay,easing:""},o=new g4(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(d4,"."+this._enterClassName)).replace(f4,"."+this._leaveClassName);let c=this._driver.query(this.element,n,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!o&&0==a.length&&s.push(function wL(t){return new Ke(3014,$t)}()),a}}class df{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new df(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles[n]=e,this._globalTimelineStyles[n]=e,this._styleSummary[n]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&(this._previousKeyframe.easing=n),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||as,this._currentKeyframe[e]=as}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&(this._previousKeyframe.easing=e);const o=r&&r.params||{},s=function m4(t,n){const e={};let i;return t.forEach(r=>{"*"===r?(i=i||Object.keys(n),i.forEach(o=>{e[o]=as})):js(r,!1,e)}),e}(n,this._globalTimelineStyles);Object.keys(s).forEach(a=>{const l=ef(s[a],o,i);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:as),this._updateStyle(a,l)})}applyStylesToKeyframe(){const n=this._pendingStyles,e=Object.keys(n);0!=e.length&&(this._pendingStyles={},e.forEach(i=>{this._currentKeyframe[i]=n[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(n=>{const e=this._localTimelineStyles[n];this._pendingStyles[n]=e,this._updateStyle(n,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){Object.keys(n._styleSummary).forEach(e=>{const i=this._styleSummary[e],r=n._styleSummary[e];(!i||r.time>i.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=js(a,!0);Object.keys(c).forEach(u=>{const h=c[u];"!"==h?n.add(u):h==as&&e.add(u)}),i||(c.offset=l/this.duration),r.push(c)});const o=n.size?tf(n.values()):[],s=e.size?tf(e.values()):[];if(i){const a=r[0],l=Ql(a);a.offset=0,l.offset=1,r=[a,l]}return P_(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class g4 extends df{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,l=js(n[0],!1);l.offset=0,o.push(l);const c=js(n[0],!1);c.offset=vx(a),o.push(c);const u=n.length-1;for(let h=1;h<=u;h++){let g=js(n[h],!1);g.offset=vx((e+g.offset*i)/s),o.push(g)}i=s,e=0,r="",n=o}return P_(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function vx(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class R_{}class _4 extends R_{normalizePropertyName(n,e){return A_(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(v4[e]&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function dL(t,n){return new Ke(3005,$t)}())}return s+o}}const v4=(()=>function y4(t){const n={};return t.forEach(e=>n[e]=!0),n}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function yx(t,n,e,i,r,o,s,a,l,c,u,h,g){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:g}}const L_={};class bx{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function b4(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){const r=this._stateStyles["*"],o=this._stateStyles[n],s=r?r.buildStyles(e,i):{};return o?o.buildStyles(e,i):s}build(n,e,i,r,o,s,a,l,c,u){const h=[],g=this.ast.options&&this.ast.options.params||L_,R=this.buildStyles(i,a&&a.params||L_,h),Z=l&&l.params||L_,re=this.buildStyles(r,Z,h),le=new Set,J=new Map,be=new Map,ye="void"===r,Ue={params:Object.assign(Object.assign({},g),Z)},wt=u?[]:F_(n,e,this.ast.animation,o,s,R,re,Ue,c,h);let Ge=0;if(wt.forEach(Et=>{Ge=Math.max(Et.duration+Et.delay,Ge)}),h.length)return yx(e,this._triggerName,i,r,ye,R,re,[],[],J,be,Ge,h);wt.forEach(Et=>{const ot=Et.element,yt=Er(J,ot,{});Et.preStyleProps.forEach(_i=>yt[_i]=!0);const hi=Er(be,ot,{});Et.postStyleProps.forEach(_i=>hi[_i]=!0),ot!==e&&le.add(ot)});const At=tf(le.values());return yx(e,this._triggerName,i,r,ye,R,re,wt,At,J,be,Ge)}}class C4{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i={},r=Ql(this.defaultParams);return Object.keys(n).forEach(o=>{const s=n[o];null!=s&&(r[o]=s)}),this.styles.styles.forEach(o=>{if("string"!=typeof o){const s=o;Object.keys(s).forEach(a=>{let l=s[a];l.length>1&&(l=ef(l,r,e));const c=this.normalizer.normalizePropertyName(a,e);l=this.normalizer.normalizeStyleValue(a,c,l,e),i[c]=l})}}),i}}class E4{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new C4(r.style,r.options&&r.options.params||{},i)}),Cx(this.states,"true","1"),Cx(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new bx(n,r,this.states))}),this.fallbackTransition=function x4(t,n,e){return new bx(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function Cx(t,n,e){t.hasOwnProperty(n)?t.hasOwnProperty(e)||(t[e]=t[n]):t.hasOwnProperty(e)&&(t[n]=t[e])}const T4=new cf;class D4{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(n,e){const i=[],o=I_(this._driver,e,i,[]);if(i.length)throw function kL(t){return new Ke(3503,$t)}();this._animations[n]=o}_buildPlayer(n,e,i){const r=n.element,o=JE(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations[n];let s;const a=new Map;if(o?(s=F_(this._driver,e,o,D_,Xh,{},{},i,T4,r),s.forEach(u=>{const h=Er(a,u.element,{});u.postStyleProps.forEach(g=>h[g]=null)})):(r.push(function AL(){return new Ke(3300,$t)}()),s=[]),r.length)throw function IL(t){return new Ke(3504,$t)}();a.forEach((u,h)=>{Object.keys(u).forEach(g=>{u[g]=this._driver.computeStyle(h,g,as)})});const c=Us(s.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,{},h)}));return this._playersById[n]=c,c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){const e=this._getPlayer(n);e.destroy(),delete this._playersById[n];const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById[n];if(!e)throw function OL(t){return new Ke(3301,$t)}();return e}listen(n,e,i,r){const o=w_(e,"","","");return b_(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const wx="ng-animate-queued",B_="ng-animate-disabled",I4=[],Ex={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},O4={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},zr="__ng_removed";class z_{constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function R4(t){return null!=t?t:null}(i?n.value:n),i){const o=Ql(n);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Mu="void",V_=new z_(Mu);class P4{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Vr(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.hasOwnProperty(e))throw function PL(t,n){return new Ke(3302,$t)}();if(null==i||0==i.length)throw function FL(t){return new Ke(3303,$t)}();if(!function L4(t){return"start"==t||"done"==t}(i))throw function NL(t,n){return new Ke(3400,$t)}();const o=Er(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=Er(this._engine.statesByElement,n,{});return a.hasOwnProperty(e)||(Vr(n,Kh),Vr(n,Kh+"-"+e),a[e]=V_),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers[e]||delete a[e]})}}register(n,e){return!this._triggers[n]&&(this._triggers[n]=e,!0)}_getTrigger(n){const e=this._triggers[n];if(!e)throw function RL(t){return new Ke(3401,$t)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new U_(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(Vr(n,Kh),Vr(n,Kh+"-"+e),this._engine.statesByElement.set(n,a={}));let l=a[e];const c=new z_(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a[e]=c,l||(l=V_),c.value!==Mu&&l.value===c.value){if(!function V4(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(l.params,c.params)){const Z=[],re=o.matchStyles(l.value,l.params,Z),le=o.matchStyles(c.value,c.params,Z);Z.length?this._engine.reportError(Z):this._engine.afterFlush(()=>{Sa(n,re),Io(n,le)})}return}const g=Er(this._engine.playersByElement,n,[]);g.forEach(Z=>{Z.namespaceId==this.id&&Z.triggerName==e&&Z.queued&&Z.destroy()});let w=o.matchTransition(l.value,c.value,n,c.params),R=!1;if(!w){if(!r)return;w=o.fallbackTransition,R=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:w,fromState:l,toState:c,player:s,isFallbackTransition:R}),R||(Vr(n,wx),s.onStart(()=>{Jl(n,wx)})),s.onDone(()=>{let Z=this.players.indexOf(s);Z>=0&&this.players.splice(Z,1);const re=this._engine.playersByElement.get(n);if(re){let le=re.indexOf(s);le>=0&&re.splice(le,1)}}),this.players.push(s),g.push(s),s}deregister(n){delete this._triggers[n],this._engine.statesByElement.forEach((e,i)=>{delete e[n]}),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,Qh,!0);i.forEach(r=>{if(r[zr])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(Object.keys(o).forEach(l=>{if(s.set(l,o[l].value),this._triggers[l]){const c=this.trigger(n,l,Mu,r);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&Us(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const l=this._triggers[s].fallbackTransition,c=i[s]||V_,u=new z_(Mu),h=new U_(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[zr];(!o||o===Ex)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){Vr(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const l=w_(o,i.triggerName,i.fromState.value,i.toState.value);l._data=n,b_(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class F4{constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new P4(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement,o=i.length-1;if(o>=0){let s=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(e);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}}else for(let a=o;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,e)){i.splice(a+1,0,n),s=!0;break}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i){const r=Object.keys(i);for(let o=0;o<r.length;o++){const s=i[r[o]].namespaceId;if(s){const a=this._fetchNamespace(s);a&&e.add(a)}}}return e}trigger(n,e,i,r){if(hf(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!hf(e))return;const o=e[zr];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Vr(n,B_)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Jl(n,B_))}removeNode(n,e,i,r){if(hf(e)){const o=n?this._fetchNamespace(n):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[zr]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return hf(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,Qh,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,S_,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Us(this.players).onDone(()=>n());n()})}processLeaveNode(n){var e;const i=n[zr];if(i&&i.setForRemoval){if(n[zr]=Ex,i.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,i.setForRemoval)}(null===(e=n.classList)||void 0===e?void 0:e.contains(B_))&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Vr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Us(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function LL(t){return new Ke(3402,$t)}()}_flushAnimations(n,e){const i=new cf,r=[],o=new Map,s=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(Ze=>{u.add(Ze);const rt=this.driver.query(Ze,".ng-animate-queued",!0);for(let pt=0;pt<rt.length;pt++)u.add(rt[pt])});const h=this.bodyNode,g=Array.from(this.statesByElement.keys()),w=Dx(g,this.collectedEnterElements),R=new Map;let Z=0;w.forEach((Ze,rt)=>{const pt=D_+Z++;R.set(rt,pt),Ze.forEach(Xt=>Vr(Xt,pt))});const re=[],le=new Set,J=new Set;for(let Ze=0;Ze<this.collectedLeaveElements.length;Ze++){const rt=this.collectedLeaveElements[Ze],pt=rt[zr];pt&&pt.setForRemoval&&(re.push(rt),le.add(rt),pt.hasAnimation?this.driver.query(rt,".ng-star-inserted",!0).forEach(Xt=>le.add(Xt)):J.add(rt))}const be=new Map,ye=Dx(g,Array.from(le));ye.forEach((Ze,rt)=>{const pt=Xh+Z++;be.set(rt,pt),Ze.forEach(Xt=>Vr(Xt,pt))}),n.push(()=>{w.forEach((Ze,rt)=>{const pt=R.get(rt);Ze.forEach(Xt=>Jl(Xt,pt))}),ye.forEach((Ze,rt)=>{const pt=be.get(rt);Ze.forEach(Xt=>Jl(Xt,pt))}),re.forEach(Ze=>{this.processLeaveNode(Ze)})});const Ue=[],wt=[];for(let Ze=this._namespaceList.length-1;Ze>=0;Ze--)this._namespaceList[Ze].drainQueuedTransitions(e).forEach(pt=>{const Xt=pt.player,Sn=pt.element;if(Ue.push(Xt),this.collectedEnterElements.length){const Ji=Sn[zr];if(Ji&&Ji.setForMove){if(Ji.previousTriggersValues&&Ji.previousTriggersValues.has(pt.triggerName)){const Ya=Ji.previousTriggersValues.get(pt.triggerName),na=this.statesByElement.get(pt.element);na&&na[pt.triggerName]&&(na[pt.triggerName].value=Ya)}return void Xt.destroy()}}const Mr=!h||!this.driver.containsElement(h,Sn),Jn=be.get(Sn),Qi=R.get(Sn),Mn=this._buildInstruction(pt,i,Qi,Jn,Mr);if(Mn.errors&&Mn.errors.length)return void wt.push(Mn);if(Mr)return Xt.onStart(()=>Sa(Sn,Mn.fromStyles)),Xt.onDestroy(()=>Io(Sn,Mn.toStyles)),void r.push(Xt);if(pt.isFallbackTransition)return Xt.onStart(()=>Sa(Sn,Mn.fromStyles)),Xt.onDestroy(()=>Io(Sn,Mn.toStyles)),void r.push(Xt);const US=[];Mn.timelines.forEach(Ji=>{Ji.stretchStartingKeyframe=!0,this.disabledNodes.has(Ji.element)||US.push(Ji)}),Mn.timelines=US,i.append(Sn,Mn.timelines),s.push({instruction:Mn,player:Xt,element:Sn}),Mn.queriedElements.forEach(Ji=>Er(a,Ji,[]).push(Xt)),Mn.preStyleProps.forEach((Ji,Ya)=>{const na=Object.keys(Ji);if(na.length){let qa=l.get(Ya);qa||l.set(Ya,qa=new Set),na.forEach(G0=>qa.add(G0))}}),Mn.postStyleProps.forEach((Ji,Ya)=>{const na=Object.keys(Ji);let qa=c.get(Ya);qa||c.set(Ya,qa=new Set),na.forEach(G0=>qa.add(G0))})});if(wt.length){const Ze=[];wt.forEach(rt=>{Ze.push(function BL(t,n){return new Ke(3505,$t)}())}),Ue.forEach(rt=>rt.destroy()),this.reportError(Ze)}const Ge=new Map,At=new Map;s.forEach(Ze=>{const rt=Ze.element;i.has(rt)&&(At.set(rt,rt),this._beforeAnimationBuild(Ze.player.namespaceId,Ze.instruction,Ge))}),r.forEach(Ze=>{const rt=Ze.element;this._getPreviousPlayers(rt,!1,Ze.namespaceId,Ze.triggerName,null).forEach(Xt=>{Er(Ge,rt,[]).push(Xt),Xt.destroy()})});const Et=re.filter(Ze=>Mx(Ze,l,c)),ot=new Map;Tx(ot,this.driver,J,c,as).forEach(Ze=>{Mx(Ze,l,c)&&Et.push(Ze)});const hi=new Map;w.forEach((Ze,rt)=>{Tx(hi,this.driver,new Set(Ze),l,"!")}),Et.forEach(Ze=>{const rt=ot.get(Ze),pt=hi.get(Ze);ot.set(Ze,Object.assign(Object.assign({},rt),pt))});const _i=[],dr=[],Yr={};s.forEach(Ze=>{const{element:rt,player:pt,instruction:Xt}=Ze;if(i.has(rt)){if(u.has(rt))return pt.onDestroy(()=>Io(rt,Xt.toStyles)),pt.disabled=!0,pt.overrideTotalTime(Xt.totalTime),void r.push(pt);let Sn=Yr;if(At.size>1){let Jn=rt;const Qi=[];for(;Jn=Jn.parentNode;){const Mn=At.get(Jn);if(Mn){Sn=Mn;break}Qi.push(Jn)}Qi.forEach(Mn=>At.set(Mn,Sn))}const Mr=this._buildAnimation(pt.namespaceId,Xt,Ge,o,hi,ot);if(pt.setRealPlayer(Mr),Sn===Yr)_i.push(pt);else{const Jn=this.playersByElement.get(Sn);Jn&&Jn.length&&(pt.parentPlayer=Us(Jn)),r.push(pt)}}else Sa(rt,Xt.fromStyles),pt.onDestroy(()=>Io(rt,Xt.toStyles)),dr.push(pt),u.has(rt)&&r.push(pt)}),dr.forEach(Ze=>{const rt=o.get(Ze.element);if(rt&&rt.length){const pt=Us(rt);Ze.setRealPlayer(pt)}}),r.forEach(Ze=>{Ze.parentPlayer?Ze.syncPlayerEvents(Ze.parentPlayer):Ze.destroy()});for(let Ze=0;Ze<re.length;Ze++){const rt=re[Ze],pt=rt[zr];if(Jl(rt,Xh),pt&&pt.hasAnimation)continue;let Xt=[];if(a.size){let Mr=a.get(rt);Mr&&Mr.length&&Xt.push(...Mr);let Jn=this.driver.query(rt,S_,!0);for(let Qi=0;Qi<Jn.length;Qi++){let Mn=a.get(Jn[Qi]);Mn&&Mn.length&&Xt.push(...Mn)}}const Sn=Xt.filter(Mr=>!Mr.destroyed);Sn.length?B4(this,rt,Sn):this.processLeaveNode(rt)}return re.length=0,_i.forEach(Ze=>{this.players.push(Ze),Ze.onDone(()=>{Ze.destroy();const rt=this.players.indexOf(Ze);this.players.splice(rt,1)}),Ze.play()}),_i}elementContainsData(n,e){let i=!1;const r=e[zr];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const l=!o||o==Mu;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||s.push(c)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const c=l.element,u=c!==o,h=Er(i,c,[]);this._getPreviousPlayers(c,u,s,a,e.toState).forEach(w=>{const R=w.getRealPlayer();R.beforeDestroy&&R.beforeDestroy(),w.destroy(),h.push(w)})}Sa(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,l=e.element,c=[],u=new Set,h=new Set,g=e.timelines.map(R=>{const Z=R.element;u.add(Z);const re=Z[zr];if(re&&re.removedBeforeQueried)return new Du(R.duration,R.delay);const le=Z!==l,J=function z4(t){const n=[];return Sx(t,n),n}((i.get(Z)||I4).map(Ge=>Ge.getRealPlayer())).filter(Ge=>!!Ge.element&&Ge.element===Z),be=o.get(Z),ye=s.get(Z),Ue=JE(0,this._normalizer,0,R.keyframes,be,ye),wt=this._buildPlayer(R,Ue,J);if(R.subTimeline&&r&&h.add(Z),le){const Ge=new U_(n,a,Z);Ge.setRealPlayer(wt),c.push(Ge)}return wt});c.forEach(R=>{Er(this.playersByQueriedElement,R.element,[]).push(R),R.onDone(()=>function N4(t,n,e){let i;if(t instanceof Map){if(i=t.get(n),i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}}else if(i=t[n],i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&delete t[n]}return i}(this.playersByQueriedElement,R.element,R))}),u.forEach(R=>Vr(R,cx));const w=Us(g);return w.onDestroy(()=>{u.forEach(R=>Jl(R,cx)),Io(l,e.toStyles)}),h.forEach(R=>{Er(r,R,[]).push(w)}),w}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new Du(n.duration,n.delay)}}class U_{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new Du,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(i=>b_(n,e,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Er(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function hf(t){return t&&1===t.nodeType}function xx(t,n){const e=t.style.display;return t.style.display=null!=n?n:"none",e}function Tx(t,n,e,i,r){const o=[];e.forEach(l=>o.push(xx(l)));const s=[];i.forEach((l,c)=>{const u={};l.forEach(h=>{const g=u[h]=n.computeStyle(c,h,r);(!g||0==g.length)&&(c[zr]=O4,s.push(c))}),t.set(c,u)});let a=0;return e.forEach(l=>xx(l,o[a++])),s}function Dx(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),o=new Map;function s(a){if(!a)return 1;let l=o.get(a);if(l)return l;const c=a.parentNode;return l=e.has(c)?c:r.has(c)?1:s(c),o.set(a,l),l}return n.forEach(a=>{const l=s(a);1!==l&&e.get(l).push(a)}),e}function Vr(t,n){var e;null===(e=t.classList)||void 0===e||e.add(n)}function Jl(t,n){var e;null===(e=t.classList)||void 0===e||e.remove(n)}function B4(t,n,e){Us(e).onDone(()=>t.processLeaveNode(n))}function Sx(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof KE?Sx(i.players,n):n.push(i)}}function Mx(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class ff{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new F4(n,e,i),this._timelineEngine=new D4(n,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const l=[],u=I_(this._driver,o,l,[]);if(l.length)throw function SL(t,n){return new Ke(3404,$t)}();a=function w4(t,n,e){return new E4(t,n,e)}(r,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=ex(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=ex(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let j4=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o={}),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Io(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Io(this._element,this._initialStyles),this._endStyles&&(Io(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Sa(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Sa(this._element,this._endStyles),this._endStyles=null),Io(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function j_(t){let n=null;const e=Object.keys(t);for(let i=0;i<e.length;i++){const r=e[i];H4(r)&&(n=n||{},n[r]=t[r])}return n}function H4(t){return"display"===t||"position"===t}class kx{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(n,e,i){return n.animate(e,i)}onStart(n){this._onStartFns.push(n)}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(i=>{"offset"!=i&&(n[i]=this._finished?e[i]:px(this.element,i))})}this.currentSnapshot=n}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class G4{validateStyleProperty(n){return rx(n)}matchesElement(n,e){return!1}containsElement(n,e){return ox(n,e)}getParentElement(n){return x_(n)}query(n,e,i){return sx(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,o,s=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(l.easing=o);const c={},u=s.filter(g=>g instanceof kx);(function YL(t,n){return 0===t||0===n})(i,r)&&u.forEach(g=>{let w=g.currentSnapshot;Object.keys(w).forEach(R=>c[R]=w[R])}),e=function qL(t,n,e){const i=Object.keys(e);if(i.length&&n.length){let o=n[0],s=[];if(i.forEach(a=>{o.hasOwnProperty(a)||s.push(a),o[a]=e[a]}),s.length)for(var r=1;r<n.length;r++){let a=n[r];s.forEach(function(l){a[l]=px(t,l)})}}return n}(n,e=e.map(g=>js(g,!1)),c);const h=function U4(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=j_(n[0]),n.length>1&&(i=j_(n[n.length-1]))):n&&(e=j_(n)),e||i?new j4(t,e,i):null}(n,e);return new kx(n,e,l,h)}}let $4=(()=>{class t extends YE{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Qr.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?qE(e):e;return Ax(this._renderer,null,i,"register",[r]),new W4(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Ct(au),Ct(rr))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();class W4 extends class oL{}{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new Z4(this._id,n,e||{},this._renderer)}}class Z4{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return Ax(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){var n,e;return null!==(e=null===(n=this._renderer.engine.players[+this.id])||void 0===n?void 0:n.getPosition())&&void 0!==e?e:0}}function Ax(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const Ix="@.disabled";let Y4=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=null==s?void 0:s.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(o);return u||(u=new Ox("",o,this.engine),this._rendererCache.set(o,u)),u}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(s,a,e,u.name,u)};return i.data.animation.forEach(l),new q4(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Ct(au),Ct(ff),Ct(Gt))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();class Ox{constructor(n,e,i){this.namespaceId=n,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==Ix?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class q4 extends Ox{constructor(n,e,i,r){super(e,i,r),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==Ix?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.substr(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function X4(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.substr(1),s="";return"@"!=o.charAt(0)&&([o,s]=function K4(t){const n=t.indexOf(".");return[t.substring(0,n),t.substr(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}let Q4=(()=>{class t extends ff{constructor(e,i,r){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(Ct(rr),Ct(T_),Ct(R_))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();const Px=new Yt("AnimationModuleType"),Fx=[{provide:YE,useClass:$4},{provide:R_,useFactory:function J4(){return new _4}},{provide:ff,useClass:Q4},{provide:au,useFactory:function e5(t,n,e){return new Y4(t,n,e)},deps:[Rh,ff,Gt]}],Nx=[{provide:T_,useFactory:()=>new G4},{provide:Px,useValue:"BrowserAnimations"},...Fx],t5=[{provide:T_,useClass:ax},{provide:Px,useValue:"NoopAnimations"},...Fx];let n5=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?t5:Nx}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Jo({type:t}),t.\u0275inj=yo({providers:Nx,imports:[Ww]}),t})();var Tt=q(5861);let ec=0;const ku=new Map,gf=new MessageChannel;function Bi(t){if(4294967296===ec&&(ec=0),++ec in ku)throw new Error("setZeroTimeout queue overflow.");return ku.set(ec,t),gf.port2.postMessage(ec),ec}gf.port1.onmessage=function(t){const n=ku.get(t.data);ku.delete(t.data),n&&n()},gf.port1.start(),gf.port2.start();class Rx{}var Lx=q(8497),Bx=q(1817),Hs=(()=>{return(t=Hs||(Hs={}))[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH",Hs;var t})();const o5=function r5(t){if(t.length>=255)throw new TypeError("Alphabet too long");const n=new Uint8Array(256);for(let c=0;c<n.length;c++)n[c]=255;for(let c=0;c<t.length;c++){const u=t.charAt(c),h=u.charCodeAt(0);if(255!==n[h])throw new TypeError(u+" is ambiguous");n[h]=c}const e=t.length,i=t.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function a(c){if("string"!=typeof c)throw new TypeError("Expected String");if(0===c.length)return new Uint8Array;let u=0;if(" "===c[u])return;let h=0,g=0;for(;c[u]===i;)h++,u++;const w=(c.length-u)*r+1>>>0,R=new Uint8Array(w);for(;c[u];){let J=n[c.charCodeAt(u)];if(255===J)return;let be=0;for(let ye=w-1;(0!==J||be<g)&&-1!==ye;ye--,be++)J+=e*R[ye]>>>0,R[ye]=J%256>>>0,J=J/256>>>0;if(0!==J)throw new Error("Non-zero carry");g=be,u++}if(" "===c[u])return;let Z=w-g;for(;Z!==w&&0===R[Z];)Z++;const re=new Uint8Array(h+(w-Z));let le=h;for(;Z!==w;)re[le++]=R[Z++];return re}return{encode:function s(c){if(c instanceof Uint8Array||(ArrayBuffer.isView(c)?c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength):Array.isArray(c)&&(c=Uint8Array.from(c))),!(c instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===c.length)return"";let u=0,h=0,g=0;const w=c.length;for(;g!==w&&0===c[g];)g++,u++;const R=(w-g)*o+1>>>0,Z=new Uint8Array(R);for(;g!==w;){let J=c[g],be=0;for(let ye=R-1;(0!==J||be<h)&&-1!==ye;ye--,be++)J+=256*Z[ye]>>>0,Z[ye]=J%e>>>0,J=J/e>>>0;if(0!==J)throw new Error("Non-zero carry");h=be,g++}let re=R-h;for(;re!==R&&0===Z[re];)re++;let le=i.repeat(u);for(;re<R;++re)le+=t.charAt(Z[re]);return le},decodeUnsafe:a,decode:function l(c){const u=a(c);if(u)return u;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),s5=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class vn{constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:Hs.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(n){try{this.peerId=n;let e=s5.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=Lx.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return zx(this.roomId,n)===this.digestPassword}static parse(n){return new vn(n)}static create(...n){return n.length<=1?vn._create.apply(this,n):vn._createRoom.apply(this,n)}static _create(n=""){let e=function a5(t){return null==t?"":Vx(t)}(n),i=new vn(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let o=this.generateId("******"),s=zx(e,r),a=`${o}${e}${Lx.n(i)}-${s}`,l=new vn(a);return l.userId=n,l.password=r,l}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function zx(t,n){return null==t||null==n?"":0<n.length?Vx(t+n,7):""}function Vx(t,n=-1){if(null==t)return"";let e=Bx(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=o5.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}function tc(t){let n=t.length;for(;--n>=0;)t[n]=0}const Z_=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),mf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),g5=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Yx=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ls=new Array(576);tc(ls);const Ou=new Array(60);tc(Ou);const Pu=new Array(512);tc(Pu);const Fu=new Array(256);tc(Fu);const Y_=new Array(29);tc(Y_);const _f=new Array(30);function q_(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let qx,Xx,Kx;function X_(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}tc(_f);const Qx=t=>t<256?Pu[t]:Pu[256+(t>>>7)],Nu=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},sr=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,Nu(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},Oo=(t,n,e)=>{sr(t,e[2*n],e[2*n+1])},Jx=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},eT=(t,n,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)i[o]=r=r+e[o-1]<<1;for(s=0;s<=n;s++){let a=t[2*s+1];0!==a&&(t[2*s]=Jx(i[a]++,a))}},tT=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},nT=t=>{t.bi_valid>8?Nu(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},iT=(t,n,e,i)=>{const r=2*n,o=2*e;return t[r]<t[o]||t[r]===t[o]&&i[n]<=i[e]},K_=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&iT(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!iT(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},rT=(t,n,e)=>{let i,r,s,a,o=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],r=t.pending_buf[t.l_buf+o],o++,0===i?Oo(t,r,n):(s=Fu[r],Oo(t,s+256+1,n),a=Z_[s],0!==a&&(r-=Y_[s],sr(t,r,a)),i--,s=Qx(i),Oo(t,s,e),a=mf[s],0!==a&&(i-=_f[s],sr(t,i,a)))}while(o<t.last_lit);Oo(t,256,n)},Q_=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.elems;let s,a,c,l=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(t.heap[++t.heap_len]=l=s,t.depth[s]=0):e[2*s+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,e[2*c]=1,t.depth[c]=0,t.opt_len--,r&&(t.static_len-=i[2*c+1]);for(n.max_code=l,s=t.heap_len>>1;s>=1;s--)K_(t,e,s);c=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],K_(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,e[2*c]=e[2*s]+e[2*a],t.depth[c]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,e[2*s+1]=e[2*a+1]=c,t.heap[1]=c++,K_(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,o=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,l=n.stat_desc.max_length;let c,u,h,g,w,R,Z=0;for(g=0;g<=15;g++)t.bl_count[g]=0;for(e[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)u=t.heap[c],g=e[2*e[2*u+1]+1]+1,g>l&&(g=l,Z++),e[2*u+1]=g,!(u>i)&&(t.bl_count[g]++,w=0,u>=a&&(w=s[u-a]),R=e[2*u],t.opt_len+=R*(g+w),o&&(t.static_len+=R*(r[2*u+1]+w)));if(0!==Z){do{for(g=l-1;0===t.bl_count[g];)g--;t.bl_count[g]--,t.bl_count[g+1]+=2,t.bl_count[l]--,Z-=2}while(Z>0);for(g=l;0!==g;g--)for(u=t.bl_count[g];0!==u;)h=t.heap[--c],!(h>i)&&(e[2*h+1]!==g&&(t.opt_len+=(g-e[2*h+1])*e[2*h],e[2*h+1]=g),u--)}})(t,n),eT(e,l,t.bl_count)},oT=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=n[2*(i+1)+1],!(++a<l&&o===s)&&(a<c?t.bl_tree[2*o]+=a:0!==o?(o!==r&&t.bl_tree[2*o]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=o,0===s?(l=138,c=3):o===s?(l=6,c=3):(l=7,c=4))},sT=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),i=0;i<=e;i++)if(o=s,s=n[2*(i+1)+1],!(++a<l&&o===s)){if(a<c)do{Oo(t,o,t.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(Oo(t,o,t.bl_tree),a--),Oo(t,16,t.bl_tree),sr(t,a-3,2)):a<=10?(Oo(t,17,t.bl_tree),sr(t,a-3,3)):(Oo(t,18,t.bl_tree),sr(t,a-11,7));a=0,r=o,0===s?(l=138,c=3):o===s?(l=6,c=3):(l=7,c=4)}};let aT=!1;const lT=(t,n,e,i)=>{sr(t,0+(i?1:0),3),((t,n,e,i)=>{nT(t),Nu(t,e),Nu(t,~e),t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e})(t,n,e)};var P5={_tr_init:t=>{aT||((()=>{let t,n,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(Y_[i]=e,t=0;t<1<<Z_[i];t++)Fu[e++]=i;for(Fu[e-1]=i,r=0,i=0;i<16;i++)for(_f[i]=r,t=0;t<1<<mf[i];t++)Pu[r++]=i;for(r>>=7;i<30;i++)for(_f[i]=r<<7,t=0;t<1<<mf[i]-7;t++)Pu[256+r++]=i;for(n=0;n<=15;n++)o[n]=0;for(t=0;t<=143;)ls[2*t+1]=8,t++,o[8]++;for(;t<=255;)ls[2*t+1]=9,t++,o[9]++;for(;t<=279;)ls[2*t+1]=7,t++,o[7]++;for(;t<=287;)ls[2*t+1]=8,t++,o[8]++;for(eT(ls,287,o),t=0;t<30;t++)Ou[2*t+1]=5,Ou[2*t]=Jx(t,5);qx=new q_(ls,Z_,257,286,15),Xx=new q_(Ou,mf,0,30,15),Kx=new q_(new Array(0),g5,0,19,7)})(),aT=!0),t.l_desc=new X_(t.dyn_ltree,qx),t.d_desc=new X_(t.dyn_dtree,Xx),t.bl_desc=new X_(t.bl_tree,Kx),t.bi_buf=0,t.bi_valid=0,tT(t)},_tr_stored_block:lT,_tr_flush_block:(t,n,e,i)=>{let r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),Q_(t,t.l_desc),Q_(t,t.d_desc),s=(t=>{let n;for(oT(t,t.dyn_ltree,t.l_desc.max_code),oT(t,t.dyn_dtree,t.d_desc.max_code),Q_(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*Yx[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==n?lT(t,n,e,i):4===t.strategy||o===r?(sr(t,2+(i?1:0),3),rT(t,ls,Ou)):(sr(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(sr(t,n-257,5),sr(t,e-1,5),sr(t,i-4,4),r=0;r<i;r++)sr(t,t.bl_tree[2*Yx[r]+1],3);sT(t,t.dyn_ltree,n-1),sT(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),rT(t,t.dyn_ltree,t.dyn_dtree)),tT(t),i&&nT(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.d_buf+2*t.last_lit]=n>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&n,t.pending_buf[t.l_buf+t.last_lit]=255&e,t.last_lit++,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(Fu[e]+256+1)]++,t.dyn_dtree[2*Qx(n)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{sr(t,2,3),Oo(t,256,ls),(t=>{16===t.bi_valid?(Nu(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Ru=(t,n,e,i)=>{let r=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+n[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const N5=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var pi=(t,n,e,i)=>{const r=N5,o=i+e;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[255&(t^n[s])];return-1^t},Aa={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ia={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:R5,_tr_stored_block:L5,_tr_flush_block:B5,_tr_tally:Gs,_tr_align:z5}=P5,{Z_NO_FLUSH:Oa,Z_PARTIAL_FLUSH:V5,Z_FULL_FLUSH:U5,Z_FINISH:$s,Z_BLOCK:cT,Z_OK:Po,Z_STREAM_END:uT,Z_STREAM_ERROR:Ur,Z_DATA_ERROR:j5,Z_BUF_ERROR:J_,Z_DEFAULT_COMPRESSION:H5,Z_FILTERED:G5,Z_HUFFMAN_ONLY:vf,Z_RLE:$5,Z_FIXED:W5,Z_DEFAULT_STRATEGY:Z5,Z_UNKNOWN:Y5,Z_DEFLATED:yf}=Ia,ho=262,Zs=(t,n)=>(t.msg=Aa[n],n),dT=t=>(t<<1)-(t>4?9:0),Ys=t=>{let n=t.length;for(;--n>=0;)t[n]=0};let qs=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const Xs=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},xi=(t,n)=>{B5(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,Xs(t.strm)},tn=(t,n)=>{t.pending_buf[t.pending++]=n},zu=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},oB=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=Ru(t.adler,n,r,e):2===t.state.wrap&&(t.adler=pi(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},hT=(t,n)=>{let r,o,e=t.max_chain_length,i=t.strstart,s=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-ho?t.strstart-(t.w_size-ho):0,c=t.window,u=t.w_mask,h=t.prev,g=t.strstart+258;let w=c[i+s-1],R=c[i+s];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,c[r+s]===R&&c[r+s-1]===w&&c[r]===c[i]&&c[++r]===c[i+1]){i+=2,r++;do{}while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<g);if(o=258-(g-i),i=g-258,o>s){if(t.match_start=n,s=o,o>=a)break;w=c[i+s-1],R=c[i+s]}}}while((n=h[n&u])>l&&0!=--e);return s<=t.lookahead?s:t.lookahead},Na=t=>{const n=t.w_size;let e,i,r,o,s;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-ho)){t.window.set(t.window.subarray(n,n+n),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,i=t.hash_size,e=i;do{r=t.head[--e],t.head[e]=r>=n?r-n:0}while(--i);i=n,e=i;do{r=t.prev[--e],t.prev[e]=r>=n?r-n:0}while(--i);o+=n}if(0===t.strm.avail_in)break;if(i=oB(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=i,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=qs(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=qs(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<ho&&0!==t.strm.avail_in)},n0=(t,n)=>{let e,i;for(;;){if(t.lookahead<ho){if(Na(t),t.lookahead<ho&&n===Oa)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-ho&&(t.match_length=hT(t,e)),t.match_length>=3)if(i=Gs(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=qs(t,t.ins_h,t.window[t.strstart+1]);else i=Gs(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(xi(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===$s?(xi(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xi(t,!1),0===t.strm.avail_out)?1:2},rc=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<ho){if(Na(t),t.lookahead<ho&&n===Oa)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-ho&&(t.match_length=hT(t,e),t.match_length<=5&&(t.strategy===G5||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Gs(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(xi(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=Gs(t,0,t.window[t.strstart-1]),i&&xi(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Gs(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===$s?(xi(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xi(t,!1),0===t.strm.avail_out)?1:2};function Fo(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const Vu=[new Fo(0,0,0,0,(t,n)=>{let e=65535;for(e>t.pending_buf_size-5&&(e=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Na(t),0===t.lookahead&&n===Oa)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const i=t.block_start+e;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,xi(t,!1),0===t.strm.avail_out)||t.strstart-t.block_start>=t.w_size-ho&&(xi(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===$s?(xi(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&xi(t,!1),1)}),new Fo(4,4,8,4,n0),new Fo(4,5,16,8,n0),new Fo(4,6,32,32,n0),new Fo(4,4,16,16,rc),new Fo(8,16,32,32,rc),new Fo(8,16,128,128,rc),new Fo(8,32,128,256,rc),new Fo(32,128,258,1024,rc),new Fo(32,258,258,4096,rc)];function uB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=yf,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ys(this.dyn_ltree),Ys(this.dyn_dtree),Ys(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ys(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ys(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const fT=t=>{if(!t||!t.state)return Zs(t,Ur);t.total_in=t.total_out=0,t.data_type=Y5;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=Oa,R5(n),Po},pT=t=>{const n=fT(t);return n===Po&&(t=>{t.window_size=2*t.w_size,Ys(t.head),t.max_lazy_match=Vu[t.level].max_lazy,t.good_match=Vu[t.level].good_length,t.nice_match=Vu[t.level].nice_length,t.max_chain_length=Vu[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},gT=(t,n,e,i,r,o)=>{if(!t)return Ur;let s=1;if(n===H5&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==yf||i<8||i>15||n<0||n>9||o<0||o>W5)return Zs(t,Ur);8===i&&(i=9);const a=new uB;return t.state=a,a.strm=t,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=n,a.strategy=o,a.method=e,pT(t)};var Uu_deflateInit2=gT,Uu_deflateSetHeader=(t,n)=>t&&t.state&&2===t.state.wrap?(t.state.gzhead=n,Po):Ur,Uu_deflate=(t,n)=>{let e,i;if(!t||!t.state||n>cT||n<0)return t?Zs(t,Ur):Ur;const r=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===r.status&&n!==$s)return Zs(t,0===t.avail_out?J_:Ur);r.strm=t;const o=r.last_flush;if(r.last_flush=n,42===r.status)if(2===r.wrap)t.adler=0,tn(r,31),tn(r,139),tn(r,8),r.gzhead?(tn(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),tn(r,255&r.gzhead.time),tn(r,r.gzhead.time>>8&255),tn(r,r.gzhead.time>>16&255),tn(r,r.gzhead.time>>24&255),tn(r,9===r.level?2:r.strategy>=vf||r.level<2?4:0),tn(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(tn(r,255&r.gzhead.extra.length),tn(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=pi(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(tn(r,0),tn(r,0),tn(r,0),tn(r,0),tn(r,0),tn(r,9===r.level?2:r.strategy>=vf||r.level<2?4:0),tn(r,3),r.status=113);else{let s=yf+(r.w_bits-8<<4)<<8,a=-1;a=r.strategy>=vf||r.level<2?0:r.level<6?1:6===r.level?2:3,s|=a<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=113,zu(r,s),0!==r.strstart&&(zu(r,t.adler>>>16),zu(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(e=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>e&&(t.adler=pi(t.adler,r.pending_buf,r.pending-e,e)),Xs(t),e=r.pending,r.pending!==r.pending_buf_size));)tn(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>e&&(t.adler=pi(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(t.adler=pi(t.adler,r.pending_buf,r.pending-e,e)),Xs(t),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,tn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(t.adler=pi(t.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(t.adler=pi(t.adler,r.pending_buf,r.pending-e,e)),Xs(t),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,tn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(t.adler=pi(t.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Xs(t),r.pending+2<=r.pending_buf_size&&(tn(r,255&t.adler),tn(r,t.adler>>8&255),t.adler=0,r.status=113)):r.status=113),0!==r.pending){if(Xs(t),0===t.avail_out)return r.last_flush=-1,Po}else if(0===t.avail_in&&dT(n)<=dT(o)&&n!==$s)return Zs(t,J_);if(666===r.status&&0!==t.avail_in)return Zs(t,J_);if(0!==t.avail_in||0!==r.lookahead||n!==Oa&&666!==r.status){let s=r.strategy===vf?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(Na(t),0===t.lookahead)){if(n===Oa)return 1;break}if(t.match_length=0,e=Gs(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(xi(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===$s?(xi(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xi(t,!1),0===t.strm.avail_out)?1:2})(r,n):r.strategy===$5?((t,n)=>{let e,i,r,o;const s=t.window;for(;;){if(t.lookahead<=258){if(Na(t),t.lookahead<=258&&n===Oa)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=Gs(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=Gs(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(xi(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===$s?(xi(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xi(t,!1),0===t.strm.avail_out)?1:2})(r,n):Vu[r.level].func(r,n);if((3===s||4===s)&&(r.status=666),1===s||3===s)return 0===t.avail_out&&(r.last_flush=-1),Po;if(2===s&&(n===V5?z5(r):n!==cT&&(L5(r,0,0,!1),n===U5&&(Ys(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Xs(t),0===t.avail_out))return r.last_flush=-1,Po}return n!==$s?Po:r.wrap<=0?uT:(2===r.wrap?(tn(r,255&t.adler),tn(r,t.adler>>8&255),tn(r,t.adler>>16&255),tn(r,t.adler>>24&255),tn(r,255&t.total_in),tn(r,t.total_in>>8&255),tn(r,t.total_in>>16&255),tn(r,t.total_in>>24&255)):(zu(r,t.adler>>>16),zu(r,65535&t.adler)),Xs(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Po:uT)},Uu_deflateEnd=t=>{if(!t||!t.state)return Ur;const n=t.state.status;return 42!==n&&69!==n&&73!==n&&91!==n&&103!==n&&113!==n&&666!==n?Zs(t,Ur):(t.state=null,113===n?Zs(t,j5):Po)},Uu_deflateSetDictionary=(t,n)=>{let e=n.length;if(!t||!t.state)return Ur;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Ur;if(1===r&&(t.adler=Ru(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(Ys(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(n.subarray(e-i.w_size,e),0),n=l,e=i.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,Na(i);i.lookahead>=3;){let l=i.strstart,c=i.lookahead-2;do{i.ins_h=qs(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++}while(--c);i.strstart=l,i.lookahead=2,Na(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,i.wrap=r,Po};const TB=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var xf_assign=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)TB(e,i)&&(t[i]=e[i])}}return t},xf_flattenChunks=t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];e.set(s,r),r+=s.length}return e};let mT=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){mT=!1}const ju=new Uint8Array(256);for(let t=0;t<256;t++)ju[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ju[254]=ju[254]=1;var Hu_string2buf=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),o=0,r=0;o<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|63&e):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|63&e):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|63&e);return n},Hu_buf2string=(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=ju[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&t[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((t,n)=>{if(n<65534&&t.subarray&&mT)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(o,r)},Hu_utf8border=(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+ju[t[e]]>n?e:n},_T=function OB(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const vT=Object.prototype.toString,{Z_NO_FLUSH:PB,Z_SYNC_FLUSH:FB,Z_FULL_FLUSH:NB,Z_FINISH:RB,Z_OK:Tf,Z_STREAM_END:LB,Z_DEFAULT_COMPRESSION:BB,Z_DEFAULT_STRATEGY:zB,Z_DEFLATED:VB}=Ia;function Gu(t){this.options=xf_assign({level:BB,method:VB,chunkSize:16384,windowBits:15,memLevel:8,strategy:zB},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _T,this.strm.avail_out=0;let e=Uu_deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==Tf)throw new Error(Aa[e]);if(n.header&&Uu_deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?Hu_string2buf(n.dictionary):"[object ArrayBuffer]"===vT.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Uu_deflateSetDictionary(this.strm,i),e!==Tf)throw new Error(Aa[e]);this._dict_set=!0}}function r0(t,n){const e=new Gu(n);if(e.push(t,!0),e.err)throw e.msg||Aa[e.err];return e.result}Gu.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=n===~~n?n:!0===n?RB:PB,e.input="string"==typeof t?Hu_string2buf(t):"[object ArrayBuffer]"===vT.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===FB||o===NB)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Uu_deflate(e,o),r===LB)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Uu_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Tf;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Gu.prototype.onData=function(t){this.chunks.push(t)},Gu.prototype.onEnd=function(t){t===Tf&&(this.result=xf_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var YB={Deflate:Gu,deflate:r0,deflateRaw:function UB(t,n){return(n=n||{}).raw=!0,r0(t,n)},gzip:function jB(t,n){return(n=n||{}).gzip=!0,r0(t,n)},constants:Ia},XB=function(n,e){let i,r,o,s,a,l,c,u,h,g,w,R,Z,re,le,J,be,ye,Ue,wt,Ge,At,Et,ot;const yt=n.state;i=n.next_in,Et=n.input,r=i+(n.avail_in-5),o=n.next_out,ot=n.output,s=o-(e-n.avail_out),a=o+(n.avail_out-257),l=yt.dmax,c=yt.wsize,u=yt.whave,h=yt.wnext,g=yt.window,w=yt.hold,R=yt.bits,Z=yt.lencode,re=yt.distcode,le=(1<<yt.lenbits)-1,J=(1<<yt.distbits)-1;e:do{R<15&&(w+=Et[i++]<<R,R+=8,w+=Et[i++]<<R,R+=8),be=Z[w&le];t:for(;;){if(ye=be>>>24,w>>>=ye,R-=ye,ye=be>>>16&255,0===ye)ot[o++]=65535&be;else{if(!(16&ye)){if(0==(64&ye)){be=Z[(65535&be)+(w&(1<<ye)-1)];continue t}if(32&ye){yt.mode=12;break e}n.msg="invalid literal/length code",yt.mode=30;break e}Ue=65535&be,ye&=15,ye&&(R<ye&&(w+=Et[i++]<<R,R+=8),Ue+=w&(1<<ye)-1,w>>>=ye,R-=ye),R<15&&(w+=Et[i++]<<R,R+=8,w+=Et[i++]<<R,R+=8),be=re[w&J];n:for(;;){if(ye=be>>>24,w>>>=ye,R-=ye,ye=be>>>16&255,!(16&ye)){if(0==(64&ye)){be=re[(65535&be)+(w&(1<<ye)-1)];continue n}n.msg="invalid distance code",yt.mode=30;break e}if(wt=65535&be,ye&=15,R<ye&&(w+=Et[i++]<<R,R+=8,R<ye&&(w+=Et[i++]<<R,R+=8)),wt+=w&(1<<ye)-1,wt>l){n.msg="invalid distance too far back",yt.mode=30;break e}if(w>>>=ye,R-=ye,ye=o-s,wt>ye){if(ye=wt-ye,ye>u&&yt.sane){n.msg="invalid distance too far back",yt.mode=30;break e}if(Ge=0,At=g,0===h){if(Ge+=c-ye,ye<Ue){Ue-=ye;do{ot[o++]=g[Ge++]}while(--ye);Ge=o-wt,At=ot}}else if(h<ye){if(Ge+=c+h-ye,ye-=h,ye<Ue){Ue-=ye;do{ot[o++]=g[Ge++]}while(--ye);if(Ge=0,h<Ue){ye=h,Ue-=ye;do{ot[o++]=g[Ge++]}while(--ye);Ge=o-wt,At=ot}}}else if(Ge+=h-ye,ye<Ue){Ue-=ye;do{ot[o++]=g[Ge++]}while(--ye);Ge=o-wt,At=ot}for(;Ue>2;)ot[o++]=At[Ge++],ot[o++]=At[Ge++],ot[o++]=At[Ge++],Ue-=3;Ue&&(ot[o++]=At[Ge++],Ue>1&&(ot[o++]=At[Ge++]))}else{Ge=o-wt;do{ot[o++]=ot[Ge++],ot[o++]=ot[Ge++],ot[o++]=ot[Ge++],Ue-=3}while(Ue>2);Ue&&(ot[o++]=ot[Ge++],Ue>1&&(ot[o++]=ot[Ge++]))}break}}break}}while(i<r&&o<a);Ue=R>>3,i-=Ue,R-=Ue<<3,w&=(1<<R)-1,n.next_in=i,n.next_out=o,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=o<a?a-o+257:257-(o-a),yt.hold=w,yt.bits=R};const KB=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),QB=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),JB=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),e6=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var $u=(t,n,e,i,r,o,s,a)=>{const l=a.bits;let be,ye,Ue,wt,Ge,ot,c=0,u=0,h=0,g=0,w=0,R=0,Z=0,re=0,le=0,J=0,At=null,Et=0;const yt=new Uint16Array(16),hi=new Uint16Array(16);let Yr,Ze,rt,_i=null,dr=0;for(c=0;c<=15;c++)yt[c]=0;for(u=0;u<i;u++)yt[n[e+u]]++;for(w=l,g=15;g>=1&&0===yt[g];g--);if(w>g&&(w=g),0===g)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(h=1;h<g&&0===yt[h];h++);for(w<h&&(w=h),re=1,c=1;c<=15;c++)if(re<<=1,re-=yt[c],re<0)return-1;if(re>0&&(0===t||1!==g))return-1;for(hi[1]=0,c=1;c<15;c++)hi[c+1]=hi[c]+yt[c];for(u=0;u<i;u++)0!==n[e+u]&&(s[hi[n[e+u]]++]=u);if(0===t?(At=_i=s,ot=19):1===t?(At=KB,Et-=257,_i=QB,dr-=257,ot=256):(At=JB,_i=e6,ot=-1),J=0,u=0,c=h,Ge=o,R=w,Z=0,Ue=-1,le=1<<w,wt=le-1,1===t&&le>852||2===t&&le>592)return 1;for(;;){Yr=c-Z,s[u]<ot?(Ze=0,rt=s[u]):s[u]>ot?(Ze=_i[dr+s[u]],rt=At[Et+s[u]]):(Ze=96,rt=0),be=1<<c-Z,ye=1<<R,h=ye;do{ye-=be,r[Ge+(J>>Z)+ye]=Yr<<24|Ze<<16|rt|0}while(0!==ye);for(be=1<<c-1;J&be;)be>>=1;if(0!==be?(J&=be-1,J+=be):J=0,u++,0==--yt[c]){if(c===g)break;c=n[e+s[u]]}if(c>w&&(J&wt)!==Ue){for(0===Z&&(Z=w),Ge+=h,R=c-Z,re=1<<R;R+Z<g&&(re-=yt[R+Z],!(re<=0));)R++,re<<=1;if(le+=1<<R,1===t&&le>852||2===t&&le>592)return 1;Ue=J&wt,r[Ue]=w<<24|R<<16|Ge-o|0}}return 0!==J&&(r[Ge+J]=c-Z<<24|64<<16|0),a.bits=w,0};const{Z_FINISH:TT,Z_BLOCK:n6,Z_TREES:Sf,Z_OK:Ra,Z_STREAM_END:i6,Z_NEED_DICT:r6,Z_STREAM_ERROR:jr,Z_DATA_ERROR:DT,Z_MEM_ERROR:ST,Z_BUF_ERROR:o6,Z_DEFLATED:MT}=Ia,QT=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function u6(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const JT=t=>{if(!t||!t.state)return jr;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,Ra},eD=t=>{if(!t||!t.state)return jr;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,JT(t)},tD=(t,n)=>{let e;if(!t||!t.state)return jr;const i=t.state;return n<0?(e=0,n=-n):(e=1+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?jr:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,eD(t))},nD=(t,n)=>{if(!t)return jr;const e=new u6;t.state=e,e.window=null;const i=tD(t,n);return i!==Ra&&(t.state=null),i};let c0,u0,iD=!0;const h6=t=>{if(iD){c0=new Int32Array(512),u0=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for($u(1,t.lens,0,288,c0,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;$u(2,t.lens,0,32,u0,0,t.work,{bits:5}),iD=!1}t.lencode=c0,t.lenbits=9,t.distcode=u0,t.distbits=5},rD=(t,n,e,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(n.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(n.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var us_inflateReset=eD,us_inflateInit2=nD,us_inflate=(t,n)=>{let e,i,r,o,s,a,l,c,u,h,g,w,R,Z,le,J,be,ye,Ue,wt,Ge,At,re=0;const Et=new Uint8Array(4);let ot,yt;const hi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return jr;e=t.state,12===e.mode&&(e.mode=13),s=t.next_out,r=t.output,l=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,c=e.hold,u=e.bits,h=a,g=l,At=Ra;e:for(;;)switch(e.mode){case 1:if(0===e.wrap){e.mode=13;break}for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(2&e.wrap&&35615===c){e.check=0,Et[0]=255&c,Et[1]=c>>>8&255,e.check=pi(e.check,Et,2,0),c=0,u=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",e.mode=30;break}if((15&c)!==MT){t.msg="unknown compression method",e.mode=30;break}if(c>>>=4,u-=4,Ge=8+(15&c),0===e.wbits)e.wbits=Ge;else if(Ge>e.wbits){t.msg="invalid window size",e.mode=30;break}e.dmax=1<<e.wbits,t.adler=e.check=1,e.mode=512&c?10:12,c=0,u=0;break;case 2:for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(e.flags=c,(255&e.flags)!==MT){t.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=c>>8&1),512&e.flags&&(Et[0]=255&c,Et[1]=c>>>8&255,e.check=pi(e.check,Et,2,0)),c=0,u=0,e.mode=3;case 3:for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.head&&(e.head.time=c),512&e.flags&&(Et[0]=255&c,Et[1]=c>>>8&255,Et[2]=c>>>16&255,Et[3]=c>>>24&255,e.check=pi(e.check,Et,4,0)),c=0,u=0,e.mode=4;case 4:for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.head&&(e.head.xflags=255&c,e.head.os=c>>8),512&e.flags&&(Et[0]=255&c,Et[1]=c>>>8&255,e.check=pi(e.check,Et,2,0)),c=0,u=0,e.mode=5;case 5:if(1024&e.flags){for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.length=c,e.head&&(e.head.extra_len=c),512&e.flags&&(Et[0]=255&c,Et[1]=c>>>8&255,e.check=pi(e.check,Et,2,0)),c=0,u=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(w=e.length,w>a&&(w=a),w&&(e.head&&(Ge=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+w),Ge)),512&e.flags&&(e.check=pi(e.check,i,w,o)),a-=w,o+=w,e.length-=w),e.length))break e;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===a)break e;w=0;do{Ge=i[o+w++],e.head&&Ge&&e.length<65536&&(e.head.name+=String.fromCharCode(Ge))}while(Ge&&w<a);if(512&e.flags&&(e.check=pi(e.check,i,w,o)),a-=w,o+=w,Ge)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===a)break e;w=0;do{Ge=i[o+w++],e.head&&Ge&&e.length<65536&&(e.head.comment+=String.fromCharCode(Ge))}while(Ge&&w<a);if(512&e.flags&&(e.check=pi(e.check,i,w,o)),a-=w,o+=w,Ge)break e}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(c!==(65535&e.check)){t.msg="header crc mismatch",e.mode=30;break}c=0,u=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=12;break;case 10:for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}t.adler=e.check=QT(c),c=0,u=0,e.mode=11;case 11:if(0===e.havedict)return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,r6;t.adler=e.check=1,e.mode=12;case 12:if(n===n6||n===Sf)break e;case 13:if(e.last){c>>>=7&u,u-=7&u,e.mode=27;break}for(;u<3;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}switch(e.last=1&c,c>>>=1,u-=1,3&c){case 0:e.mode=14;break;case 1:if(h6(e),e.mode=20,n===Sf){c>>>=2,u-=2;break e}break;case 2:e.mode=17;break;case 3:t.msg="invalid block type",e.mode=30}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&c,c=0,u=0,e.mode=15,n===Sf)break e;case 15:e.mode=16;case 16:if(w=e.length,w){if(w>a&&(w=a),w>l&&(w=l),0===w)break e;r.set(i.subarray(o,o+w),s),a-=w,o+=w,l-=w,s+=w,e.length-=w;break}e.mode=12;break;case 17:for(;u<14;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(e.nlen=257+(31&c),c>>>=5,u-=5,e.ndist=1+(31&c),c>>>=5,u-=5,e.ncode=4+(15&c),c>>>=4,u-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;u<3;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.lens[hi[e.have++]]=7&c,c>>>=3,u-=3}for(;e.have<19;)e.lens[hi[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,ot={bits:e.lenbits},At=$u(0,e.lens,0,19,e.lencode,0,e.work,ot),e.lenbits=ot.bits,At){t.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;re=e.lencode[c&(1<<e.lenbits)-1],le=re>>>24,J=re>>>16&255,be=65535&re,!(le<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(be<16)c>>>=le,u-=le,e.lens[e.have++]=be;else{if(16===be){for(yt=le+2;u<yt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(c>>>=le,u-=le,0===e.have){t.msg="invalid bit length repeat",e.mode=30;break}Ge=e.lens[e.have-1],w=3+(3&c),c>>>=2,u-=2}else if(17===be){for(yt=le+3;u<yt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=le,u-=le,Ge=0,w=3+(7&c),c>>>=3,u-=3}else{for(yt=le+7;u<yt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=le,u-=le,Ge=0,w=11+(127&c),c>>>=7,u-=7}if(e.have+w>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=30;break}for(;w--;)e.lens[e.have++]=Ge}}if(30===e.mode)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,ot={bits:e.lenbits},At=$u(1,e.lens,0,e.nlen,e.lencode,0,e.work,ot),e.lenbits=ot.bits,At){t.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,ot={bits:e.distbits},At=$u(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,ot),e.distbits=ot.bits,At){t.msg="invalid distances set",e.mode=30;break}if(e.mode=20,n===Sf)break e;case 20:e.mode=21;case 21:if(a>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,XB(t,g),s=t.next_out,r=t.output,l=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,c=e.hold,u=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;re=e.lencode[c&(1<<e.lenbits)-1],le=re>>>24,J=re>>>16&255,be=65535&re,!(le<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(J&&0==(240&J)){for(ye=le,Ue=J,wt=be;re=e.lencode[wt+((c&(1<<ye+Ue)-1)>>ye)],le=re>>>24,J=re>>>16&255,be=65535&re,!(ye+le<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=ye,u-=ye,e.back+=ye}if(c>>>=le,u-=le,e.back+=le,e.length=be,0===J){e.mode=26;break}if(32&J){e.back=-1,e.mode=12;break}if(64&J){t.msg="invalid literal/length code",e.mode=30;break}e.extra=15&J,e.mode=22;case 22:if(e.extra){for(yt=e.extra;u<yt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;re=e.distcode[c&(1<<e.distbits)-1],le=re>>>24,J=re>>>16&255,be=65535&re,!(le<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(0==(240&J)){for(ye=le,Ue=J,wt=be;re=e.distcode[wt+((c&(1<<ye+Ue)-1)>>ye)],le=re>>>24,J=re>>>16&255,be=65535&re,!(ye+le<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=ye,u-=ye,e.back+=ye}if(c>>>=le,u-=le,e.back+=le,64&J){t.msg="invalid distance code",e.mode=30;break}e.offset=be,e.extra=15&J,e.mode=24;case 24:if(e.extra){for(yt=e.extra;u<yt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===l)break e;if(w=g-l,e.offset>w){if(w=e.offset-w,w>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=30;break}w>e.wnext?(w-=e.wnext,R=e.wsize-w):R=e.wnext-w,w>e.length&&(w=e.length),Z=e.window}else Z=r,R=s-e.offset,w=e.length;w>l&&(w=l),l-=w,e.length-=w;do{r[s++]=Z[R++]}while(--w);0===e.length&&(e.mode=21);break;case 26:if(0===l)break e;r[s++]=e.length,l--,e.mode=21;break;case 27:if(e.wrap){for(;u<32;){if(0===a)break e;a--,c|=i[o++]<<u,u+=8}if(g-=l,t.total_out+=g,e.total+=g,g&&(t.adler=e.check=e.flags?pi(e.check,r,g,s-g):Ru(e.check,r,g,s-g)),g=l,(e.flags?c:QT(c))!==e.check){t.msg="incorrect data check",e.mode=30;break}c=0,u=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(c!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=30;break}c=0,u=0}e.mode=29;case 29:At=i6;break e;case 30:At=DT;break e;case 31:return ST;default:return jr}return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,(e.wsize||g!==t.avail_out&&e.mode<30&&(e.mode<27||n!==TT))&&rD(t,t.output,t.next_out,g-t.avail_out),h-=t.avail_in,g-=t.avail_out,t.total_in+=h,t.total_out+=g,e.total+=g,e.wrap&&g&&(t.adler=e.check=e.flags?pi(e.check,r,g,t.next_out-g):Ru(e.check,r,g,t.next_out-g)),t.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),(0===h&&0===g||n===TT)&&At===Ra&&(At=o6),At},us_inflateEnd=t=>{if(!t||!t.state)return jr;let n=t.state;return n.window&&(n.window=null),t.state=null,Ra},us_inflateGetHeader=(t,n)=>{if(!t||!t.state)return jr;const e=t.state;return 0==(2&e.wrap)?jr:(e.head=n,n.done=!1,Ra)},us_inflateSetDictionary=(t,n)=>{const e=n.length;let i,r,o;return t&&t.state&&(i=t.state,0===i.wrap||11===i.mode)?11===i.mode&&(r=1,r=Ru(r,n,e,0),r!==i.check)?DT:(o=rD(t,n,e,e),o?(i.mode=31,ST):(i.havedict=1,Ra)):jr},M6=function S6(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const oD=Object.prototype.toString,{Z_NO_FLUSH:k6,Z_FINISH:A6,Z_OK:Wu,Z_STREAM_END:d0,Z_NEED_DICT:h0,Z_STREAM_ERROR:I6,Z_DATA_ERROR:sD,Z_MEM_ERROR:O6}=Ia;function Zu(t){this.options=xf_assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _T,this.strm.avail_out=0;let e=us_inflateInit2(this.strm,n.windowBits);if(e!==Wu)throw new Error(Aa[e]);if(this.header=new M6,us_inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Hu_string2buf(n.dictionary):"[object ArrayBuffer]"===oD.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=us_inflateSetDictionary(this.strm,n.dictionary),e!==Wu)))throw new Error(Aa[e])}function f0(t,n){const e=new Zu(n);if(e.push(t),e.err)throw e.msg||Aa[e.err];return e.result}Zu.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=n===~~n?n:!0===n?A6:k6,e.input="[object ArrayBuffer]"===oD.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=us_inflate(e,s),o===h0&&r&&(o=us_inflateSetDictionary(e,r),o===Wu?o=us_inflate(e,s):o===sD&&(o=h0));e.avail_in>0&&o===d0&&e.state.wrap>0&&0!==t[e.next_in];)us_inflateReset(e),o=us_inflate(e,s);switch(o){case I6:case sD:case h0:case O6:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===d0))if("string"===this.options.to){let l=Hu_utf8border(e.output,e.next_out),c=e.next_out-l,u=Hu_buf2string(e.output,l);e.next_out=c,e.avail_out=i-c,c&&e.output.set(e.output.subarray(l,l+c),0),this.onData(u)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==Wu||0!==a){if(o===d0)return o=us_inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Zu.prototype.onData=function(t){this.chunks.push(t)},Zu.prototype.onEnd=function(t){t===Wu&&(this.result="string"===this.options.to?this.chunks.join(""):xf_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var z6={Inflate:Zu,inflate:f0,inflateRaw:function P6(t,n){return(n=n||{}).raw=!0,f0(t,n)},ungzip:f0,constants:Ia};const{Deflate:V6}=YB,{Inflate:G6}=z6;var aD=V6,lD=G6;function p0(){return(p0=(0,Tt.Z)(function*(t,n){const e=new aD({level:2,gzip:!0});try{return yield cD(e,t,n),e.result}catch(i){console.error(i)}return null})).apply(this,arguments)}function g0(){return(g0=(0,Tt.Z)(function*(t,n){const e=new lD;try{return yield cD(e,t,n),e.result}catch(i){console.error(i)}return null})).apply(this,arguments)}function cD(t,n){return m0.apply(this,arguments)}function m0(){return(m0=(0,Tt.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let o=0;o<i;o++)yield i8(),r=n.slice(o*e,(o+1)*e),t.push(r,i<=o+1);if(t.err)throw new Error(`error: ${t.err}`);return t})).apply(this,arguments)}function i8(){return new Promise(t=>Bi(t))}var Tr,t,uD=q(2391);(t=Tr||(Tr={})).encode=function n(i){try{return uD.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return uD.decode(i)}catch(r){console.error(r,i)}return null};var Yu,r8=q(9069);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&o]+n[o>>8&255]+"-"+n[o>>16&15|64]+n[o>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(Yu||(Yu={}));class ds{constructor(n,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class If{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new ds(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var n=this;return(0,Tt.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}If.updateWebRTCStatsTimer=null,If.monitoringConnections=new Set;var Hr=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}(Hr||(Hr={})),Hr))();class o8{constructor(n){this.peerConnection=n,this.candidateType=Hr.UNKNOWN}updateAsync(){var n=this;return(0,Tt.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(g){console.warn(g)}if(null==e)return void(n.candidateType=Hr.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],l=[],c=[];e.forEach(g=>{0<=g.type.indexOf("candidate-pair")&&i.push(g),0<=g.type.indexOf("local-candidate")&&r.push(g),0<=g.type.indexOf("remote-candidate")&&o.push(g)}),i.forEach(g=>{"succeeded"===g.state&&(s.push(g.localCandidateId),a.push(g.remoteCandidateId))}),r.forEach(g=>{s.includes(g.id)&&l.push(g)}),o.forEach(g=>{a.includes(g.id)&&c.push(g)});let u=Hr.UNKNOWN,h=Object.values(Hr);l.concat(c).forEach(g=>{let w=h.indexOf(g.candidateType);h.indexOf(u)<w&&(u=h[w])}),n.candidateType=u})()}}class dD extends r8.EventEmitter{constructor(n){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Hr.UNKNOWN,n.on("data",e=>this.onData(e)),n.on("open",()=>{this.stats=new o8(this.getPeerConnection()),this.clearTimeoutTimer(),function s8(t){t._dc&&t._sendBuffer&&(t._startSendLoop=a8)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),n.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){var n,e;return null!==(e=null===(n=this.conn._dc)||void 0===n?void 0:n.bufferedAmount)&&void 0!==e?e:0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=Tr.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=Yu.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(Tr.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){If.add(this)}stopMonitoring(){If.remove(this)}updateStatsAsync(){var n=this;return(0,Tt.Z)(function*(){null!=n.stats&&(n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType,n.emit("stats",n.stats))})()}sendPing(){let n=Tr.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=Tr.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=Tr.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let c of o.chanks)s.set(c,a),a+=c.byteLength;let l=Tr.decode(s);this.emit("data",l)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function a8(){this.sendInterval||(this.sendInterval=Bi(hD.bind(this)))}function hD(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch(n){this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:Bi(hD.bind(this))}class l8{constructor(){this._peerIds=[],this.peerContext=vn.parse("???"),this.peerContexts=[],this.callback=new Rx,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...n){console.log("open",n),this.peerContext=0===n.length?vn.create(vn.generateId()):1===n.length?vn.create(n[0]):vn.create(n[0],n[1],n[2],n[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=vn.parse("???")}connect(n){if(!this.shouldConnect(n))return!1;let e=new dD(this.peer.connect(n,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(n){return this.peerContext&&this.peer&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.findDataConnection(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.findDataConnection(n);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections.concat())this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:Tr.encode(n),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Bi((0,Tt.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let l=yield function t8(t,n){return p0.apply(this,arguments)}(r.data);l.byteLength<r.data.byteLength&&(r.data=l,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.peer)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peerContext.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=vn.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),n.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),n.on("connection",e=>{this.openDataConnection(new dD(e))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=n}openDataConnection(n){if(!1===this.addDataConnection(n))return;let e=this.connections.indexOf(n),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",r=>{this.onData(n,r)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(n.remoteId)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{let r=performance.now()-n.timestamp,o=r<=1e4?1:5e3/(r-1e4+5e3),s=o<1?r:n.ping,a=500/(s+500);switch(i.session.health=o,i.session.ping=s,i.session.speed=a*o,n.candidateType){case Hr.HOST:i.session.grade=Hs.HIGH;break;case Hr.SRFLX:case Hr.PRFLX:i.session.grade=Hs.MIDDLE;break;case Hr.RELAY:i.session.grade=Hs.LOW;break;default:i.session.grade=Hs.UNSPECIFIED}i.session.description=n.candidateType,i.session.health<.2&&this.closeDataConnection(n)})}closeDataConnection(n){n.close();let e=this.connections.indexOf(n);0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.remoteId)}addDataConnection(n){let e=this.findDataConnection(n.remoteId);if(null!==e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting."),e!==n){if(!(e.metadata.sendFrom<n.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(n),!0;this.closeDataConnection(n)}return!1}return this.connections.push(n),this.peerContexts.push(vn.parse(n.remoteId)),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),!0}findDataConnection(n){for(let e of this.connections)if(e.remoteId===n)return e;return null}onData(n,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(n,e),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Bi((0,Tt.Z)(function*(){let a=e.isCompressed?yield function n8(t,n){return g0.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.remoteId,Tr.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i)for(let r of i){let o=this.findDataConnection(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}onUpdatePeerList(n,e){let i=[],r=[],o=function c8(t,n){let e=[],i=[],r=!1,o=!1;for(let s of t.concat(n))r=t.includes(s),o=n.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=o.diff1,r=o.diff2,this.relayingPeerIds.set(n.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let s of r)!this.maybeUnavailablePeerIds.has(s)&&this.connect(s)&&console.log("auto connect to unknown Peer <"+s+">")}updatePeerList(){let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);return n.push(this.peerId),n.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=n,console.log("<update()>",n),this.notifyPeerList(),n}notifyPeerList(){if(this.connections.length<1)return;let n={data:Tr.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const fD=vn.parse("???");class No{constructor(){this.callback=new Rx,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}static get instance(){return No._instance||(No._instance=new No),No._instance}get peerId(){return this.connection?this.connection.peerId:fD.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:fD}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...n){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){!this.connection||this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Bi(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?Bi(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let n=new l8;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Bi(this.sendCallback)),n}}class Of{constructor(n,e,i=No.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===No.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class _0{constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new _0(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class La{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return La._instance||(La._instance=new La,La._instance.initializeNetworkEvent()),La._instance}register(n){return new _0(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=this.listenerMap.values();for(let o of r)for(let s of o.concat())s.isEqual(n,e,i)&&s.unregister()}registerListener(n){let e=this.getListeners(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),n}unregisterListener(n){let e=this.getListeners(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),n.unregister(),e.length<1&&this.listenerMap.delete(n.eventName),n)}call(...n){"string"==typeof n[0]?this._call(new Of(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();No.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof Of?n[0]:new Of(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new Of(n[0],n[1]))}_trigger(n){let e=this.getListeners(n.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(n);return n}getListeners(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}initializeNetworkEvent(){let n=No.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},n.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const ve=La.instance,He=No.instance;var li_isObject=function u8(t){return"object"==typeof t&&null!==t},li_repeat=function f8(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},li_isNegativeZero=function p8(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t};function gD(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function qu(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=gD(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(qu.prototype=Object.create(Error.prototype)).constructor=qu,qu.prototype.toString=function(n){return this.name+": "+gD(this,n)};var Xi=qu;function v0(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function y0(t,n){return li_repeat(" ",n-t.length)+t}var E8=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],x8=["scalar","sequence","mapping"],Ti=function D8(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===E8.indexOf(e))throw new Xi('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function T8(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===x8.indexOf(this.kind))throw new Xi('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function mD(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function b0(t){return this.extend(t)}b0.prototype.extend=function(n){var e=[],i=[];if(n instanceof Ti)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new Xi("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof Ti))throw new Xi("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new Xi("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new Xi("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof Ti))throw new Xi("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(b0.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=mD(r,"implicit"),r.compiledExplicit=mD(r,"explicit"),r.compiledTypeMap=function S8(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var _D=b0,vD=new Ti("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),yD=new Ti("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),bD=new Ti("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),CD=new _D({explicit:[vD,yD,bD]}),wD=new Ti("tag:yaml.org,2002:null",{kind:"scalar",resolve:function M8(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function k8(){return null},predicate:function A8(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),ED=new Ti("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function I8(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function O8(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function P8(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function F8(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function N8(t){return 48<=t&&t<=55}function R8(t){return 48<=t&&t<=57}var xD=new Ti("tag:yaml.org,2002:int",{kind:"scalar",resolve:function L8(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!F8(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!N8(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!R8(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function B8(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function z8(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!li_isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),V8=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),H8=/^[-+]?[0-9]+e/,TD=new Ti("tag:yaml.org,2002:float",{kind:"scalar",resolve:function U8(t){return!(null===t||!V8.test(t)||"_"===t[t.length-1])},construct:function j8(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function $8(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||li_isNegativeZero(t))},represent:function G8(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(li_isNegativeZero(t))return"-0.0";return e=t.toString(10),H8.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),SD=CD.extend({implicit:[wD,ED,xD,TD]}),MD=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),kD=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),AD=new Ti("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function W8(t){return null!==t&&(null!==MD.exec(t)||null!==kD.exec(t))},construct:function Z8(t){var n,e,i,r,o,s,a,g,l=0,c=null;if(null===(n=MD.exec(t))&&(n=kD.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(c=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(c=-c)),g=new Date(Date.UTC(e,i,r,o,s,a,l)),c&&g.setTime(g.getTime()-c),g},instanceOf:Date,represent:function Y8(t){return t.toISOString()}}),ID=new Ti("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function q8(t){return"<<"===t||null===t}}),C0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",OD=new Ti("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function X8(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=C0;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function K8(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=C0,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function J8(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function Q8(t){var i,r,n="",e=0,o=t.length,s=C0;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),ez=Object.prototype.hasOwnProperty,tz=Object.prototype.toString,PD=new Ti("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function nz(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==tz.call(r=a[e]))return!1;for(o in r)if(ez.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function iz(t){return null!==t?t:[]}}),rz=Object.prototype.toString,FD=new Ti("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function oz(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==rz.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function sz(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),az=Object.prototype.hasOwnProperty,ND=new Ti("tag:yaml.org,2002:set",{kind:"mapping",resolve:function lz(t){if(null===t)return!0;var n,e=t;for(n in e)if(az.call(e,n)&&null!==e[n])return!1;return!0},construct:function cz(t){return null!==t?t:{}}}),w0=SD.extend({implicit:[AD,ID],explicit:[OD,PD,FD,ND]}),Ks=Object.prototype.hasOwnProperty,dz=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,hz=/[\x85\u2028\u2029]/,fz=/[,\[\]\{\}]/,zD=/^(?:!|!!|![a-z\-]+!)$/i,VD=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function UD(t){return Object.prototype.toString.call(t)}function Ro(t){return 10===t||13===t}function Ba(t){return 9===t||32===t}function ar(t){return 9===t||32===t||10===t||13===t}function sc(t){return 44===t||91===t||93===t||123===t||125===t}function pz(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function gz(t){return 120===t?2:117===t?4:85===t?8:0}function mz(t){return 48<=t&&t<=57?t-48:-1}function jD(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function _z(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var HD=new Array(256),GD=new Array(256),ac=0;ac<256;ac++)HD[ac]=jD(ac)?1:0,GD[ac]=jD(ac);function vz(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||w0,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function $D(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=function C8(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var l,c,a="",u=Math.min(t.line+n.linesAfter,r.length).toString().length,h=n.maxLength-(n.indent+u+3);for(l=1;l<=n.linesBefore&&!(s-l<0);l++)c=v0(t.buffer,i[s-l],r[s-l],t.position-(i[s]-i[s-l]),h),a=li_repeat(" ",n.indent)+y0((t.line-l+1).toString(),u)+" | "+c.str+"\n"+a;for(c=v0(t.buffer,i[s],r[s],t.position,h),a+=li_repeat(" ",n.indent)+y0((t.line+1).toString(),u)+" | "+c.str+"\n",a+=li_repeat("-",n.indent+u+3+c.pos)+"^\n",l=1;l<=n.linesAfter&&!(s+l>=r.length);l++)c=v0(t.buffer,i[s+l],r[s+l],t.position-(i[s]-i[s+l]),h),a+=li_repeat(" ",n.indent)+y0((t.line+l+1).toString(),u)+" | "+c.str+"\n";return a.replace(/\n$/,"")}(e),new Xi(n,e)}function st(t,n){throw $D(t,n)}function Nf(t,n){t.onWarning&&t.onWarning.call(null,$D(t,n))}var WD={YAML:function(n,e,i){var r,o,s;null!==n.version&&st(n,"duplication of %YAML directive"),1!==i.length&&st(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&st(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&st(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&Nf(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&st(n,"TAG directive accepts exactly two arguments"),o=i[1],zD.test(r=i[0])||st(n,"ill-formed tag handle (first argument) of the TAG directive"),Ks.call(n.tagMap,r)&&st(n,'there is a previously declared suffix for "'+r+'" tag handle'),VD.test(o)||st(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch(s){st(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function Qs(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||st(t,"expected valid JSON character");else dz.test(a)&&st(t,"the stream contains non-printable characters");t.result+=a}}function ZD(t,n,e,i){var r,o,s,a;for(li_isObject(e)||st(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)Ks.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function lc(t,n,e,i,r,o,s,a,l){var c,u;if(Array.isArray(r))for(c=0,u=(r=Array.prototype.slice.call(r)).length;c<u;c+=1)Array.isArray(r[c])&&st(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===UD(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===UD(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)ZD(t,n,o[c],e);else ZD(t,n,o,e);else!t.json&&!Ks.call(e,r)&&Ks.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,st(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function x0(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):st(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function Xn(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;Ba(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Ro(r))break;for(x0(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&Nf(t,"deficient indentation"),i}function Rf(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!ar(e)))}function T0(t,n){1===n?t.result+=" ":n>1&&(t.result+=li_repeat("\n",n-1))}function YD(t,n){var e,l,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),l=t.input.charCodeAt(t.position);0!==l&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,st(t,"tab characters must not be used in indentation")),45===l&&ar(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,Xn(t,!0,-1)&&t.lineIndent<=n)o.push(null),l=t.input.charCodeAt(t.position);else if(e=t.line,cc(t,n,3,!1,!0),o.push(t.result),Xn(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==l)st(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function Tz(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&st(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):st(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!ar(s);)33===s&&(i?st(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),zD.test(r)||st(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),fz.test(o)&&st(t,"tag suffix cannot contain flow indicator characters")}o&&!VD.test(o)&&st(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch(a){st(t,"tag name is malformed: "+o)}return e?t.tag=o:Ks.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:st(t,'undeclared tag handle "'+r+'"'),!0}function Dz(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&st(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!ar(e)&&!sc(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&st(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function cc(t,n,e,i,r){var o,s,a,h,g,w,R,Z,re,l=1,c=!1,u=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=4===e||3===e,i&&Xn(t,!0,-1)&&(c=!0,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)),1===l)for(;Tz(t)||Dz(t);)Xn(t,!0,-1)?(c=!0,a=o,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)):a=!1;if(a&&(a=c||r),(1===l||4===e)&&(Z=1===e||2===e?n:n+1,re=t.position-t.lineStart,1===l?a&&(YD(t,re)||function xz(t,n,e){var i,r,o,s,a,l,J,c=t.tag,u=t.anchor,h={},g=Object.create(null),w=null,R=null,Z=null,re=!1,le=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=h),J=t.input.charCodeAt(t.position);0!==J;){if(!re&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,st(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==J&&58!==J||!ar(i)){if(s=t.line,a=t.lineStart,l=t.position,!cc(t,e,2,!1,!0))break;if(t.line===o){for(J=t.input.charCodeAt(t.position);Ba(J);)J=t.input.charCodeAt(++t.position);if(58===J)ar(J=t.input.charCodeAt(++t.position))||st(t,"a whitespace character is expected after the key-value separator within a block mapping"),re&&(lc(t,h,g,w,R,null,s,a,l),w=R=Z=null),le=!0,re=!1,r=!1,w=t.tag,R=t.result;else{if(!le)return t.tag=c,t.anchor=u,!0;st(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!le)return t.tag=c,t.anchor=u,!0;st(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===J?(re&&(lc(t,h,g,w,R,null,s,a,l),w=R=Z=null),le=!0,re=!0,r=!0):re?(re=!1,r=!0):st(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,J=i;if((t.line===o||t.lineIndent>n)&&(re&&(s=t.line,a=t.lineStart,l=t.position),cc(t,n,4,!0,r)&&(re?R=t.result:Z=t.result),re||(lc(t,h,g,w,R,Z,s,a,l),w=R=Z=null),Xn(t,!0,-1),J=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==J)st(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return re&&lc(t,h,g,w,R,null,s,a,l),le&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=h),le}(t,re,Z))||function wz(t,n){var i,r,o,a,u,h,g,w,Z,re,le,J,e=!0,s=t.tag,l=t.anchor,R=Object.create(null);if(91===(J=t.input.charCodeAt(t.position)))u=93,w=!1,a=[];else{if(123!==J)return!1;u=125,w=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),J=t.input.charCodeAt(++t.position);0!==J;){if(Xn(t,!0,n),(J=t.input.charCodeAt(t.position))===u)return t.position++,t.tag=s,t.anchor=l,t.kind=w?"mapping":"sequence",t.result=a,!0;e?44===J&&st(t,"expected the node content, but found ','"):st(t,"missed comma between flow collection entries"),le=null,h=g=!1,63===J&&ar(t.input.charCodeAt(t.position+1))&&(h=g=!0,t.position++,Xn(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,cc(t,n,1,!1,!0),re=t.tag,Z=t.result,Xn(t,!0,n),J=t.input.charCodeAt(t.position),(g||t.line===i)&&58===J&&(h=!0,J=t.input.charCodeAt(++t.position),Xn(t,!0,n),cc(t,n,1,!1,!0),le=t.result),w?lc(t,a,R,re,Z,le,i,r,o):a.push(h?lc(t,null,R,re,Z,le,i,r,o):Z),Xn(t,!0,n),44===(J=t.input.charCodeAt(t.position))?(e=!0,J=t.input.charCodeAt(++t.position)):e=!1}st(t,"unexpected end of the stream within a flow collection")}(t,Z)?u=!0:(s&&function Ez(t,n){var e,i,u,h,r=1,o=!1,s=!1,a=n,l=0,c=!1;if(124===(h=t.input.charCodeAt(t.position)))i=!1;else{if(62!==h)return!1;i=!0}for(t.kind="scalar",t.result="";0!==h;)if(43===(h=t.input.charCodeAt(++t.position))||45===h)1===r?r=43===h?3:2:st(t,"repeat of a chomping mode identifier");else{if(!((u=mz(h))>=0))break;0===u?st(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?st(t,"repeat of an indentation width identifier"):(a=n+u-1,s=!0)}if(Ba(h)){do{h=t.input.charCodeAt(++t.position)}while(Ba(h));if(35===h)do{h=t.input.charCodeAt(++t.position)}while(!Ro(h)&&0!==h)}for(;0!==h;){for(x0(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===h;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),Ro(h))l++;else{if(t.lineIndent<a){3===r?t.result+=li_repeat("\n",o?1+l:l):1===r&&o&&(t.result+="\n");break}for(i?Ba(h)?(c=!0,t.result+=li_repeat("\n",o?1+l:l)):c?(c=!1,t.result+=li_repeat("\n",l+1)):0===l?o&&(t.result+=" "):t.result+=li_repeat("\n",l):t.result+=li_repeat("\n",o?1+l:l),o=!0,s=!0,l=0,e=t.position;!Ro(h)&&0!==h;)h=t.input.charCodeAt(++t.position);Qs(t,e,t.position,!1)}}return!0}(t,Z)||function bz(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(Qs(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Ro(e)?(Qs(t,i,r,!0),T0(t,Xn(t,!1,n)),i=r=t.position):t.position===t.lineStart&&Rf(t)?st(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);st(t,"unexpected end of the stream within a single quoted scalar")}(t,Z)||function Cz(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return Qs(t,e,t.position,!0),t.position++,!0;if(92===a){if(Qs(t,e,t.position,!0),Ro(a=t.input.charCodeAt(++t.position)))Xn(t,!1,n);else if(a<256&&HD[a])t.result+=GD[a],t.position++;else if((s=gz(a))>0){for(r=s,o=0;r>0;r--)(s=pz(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:st(t,"expected hexadecimal character");t.result+=_z(o),t.position++}else st(t,"unknown escape sequence");e=i=t.position}else Ro(a)?(Qs(t,e,i,!0),T0(t,Xn(t,!1,n)),e=i=t.position):t.position===t.lineStart&&Rf(t)?st(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}st(t,"unexpected end of the stream within a double quoted scalar")}(t,Z)?u=!0:function Sz(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!ar(i)&&!sc(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&st(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Ks.call(t.anchorMap,e)||st(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],Xn(t,!0,-1),!0}(t)?(u=!0,(null!==t.tag||null!==t.anchor)&&st(t,"alias node should not have any properties")):function yz(t,n,e){var r,o,s,a,l,c,u,w,h=t.kind,g=t.result;if(ar(w=t.input.charCodeAt(t.position))||sc(w)||35===w||38===w||42===w||33===w||124===w||62===w||39===w||34===w||37===w||64===w||96===w||(63===w||45===w)&&(ar(r=t.input.charCodeAt(t.position+1))||e&&sc(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==w;){if(58===w){if(ar(r=t.input.charCodeAt(t.position+1))||e&&sc(r))break}else if(35===w){if(ar(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Rf(t)||e&&sc(w))break;if(Ro(w)){if(l=t.line,c=t.lineStart,u=t.lineIndent,Xn(t,!1,-1),t.lineIndent>=n){a=!0,w=t.input.charCodeAt(t.position);continue}t.position=s,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(Qs(t,o,s,!1),T0(t,t.line-l),o=s=t.position,a=!1),Ba(w)||(s=t.position+1),w=t.input.charCodeAt(++t.position)}return Qs(t,o,s,!1),!!t.result||(t.kind=h,t.result=g,!1)}(t,Z,1===e)&&(u=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===l&&(u=a&&YD(t,re))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&st(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),h=0,g=t.implicitTypes.length;h<g;h+=1)if((R=t.implicitTypes[h]).resolve(t.result)){t.result=R.construct(t.result),t.tag=R.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Ks.call(t.typeMap[t.kind||"fallback"],t.tag))R=t.typeMap[t.kind||"fallback"][t.tag];else for(R=null,h=0,g=(w=t.typeMap.multi[t.kind||"fallback"]).length;h<g;h+=1)if(t.tag.slice(0,w[h].tag.length)===w[h].tag){R=w[h];break}R||st(t,"unknown tag !<"+t.tag+">"),null!==t.result&&R.kind!==t.kind&&st(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+R.kind+'", not "'+t.kind+'"'),R.resolve(t.result,t.tag)?(t.result=R.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):st(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||u}function Mz(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(Xn(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!ar(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&st(t,"directive name must not be less than one character in length");0!==s;){for(;Ba(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!Ro(s));break}if(Ro(s))break;for(e=t.position;0!==s&&!ar(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&x0(t),Ks.call(WD,i)?WD[i](t,i,r):Nf(t,'unknown document directive "'+i+'"')}Xn(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,Xn(t,!0,-1)):o&&st(t,"directives end mark is expected"),cc(t,t.lineIndent-1,4,!1,!0),Xn(t,!0,-1),t.checkLineBreaks&&hz.test(t.input.slice(n,t.position))&&Nf(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Rf(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,Xn(t,!0,-1)):t.position<t.length-1&&st(t,"end of the stream or a document separator is expected")}function qD(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new vz(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,st(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)Mz(e);return e.documents}var XD_load=function Az(t,n){var e=qD(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new Xi("expected a single document in the stream, but found more")}};function I0(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var mS=XD_load;I0("safeLoad","load"),I0("safeLoadAll","loadAll"),I0("safeDump","dump");const _S=Object.getOwnPropertyNames(Object.prototype),MV=Object.getOwnPropertyNames(Array.prototype);let O0=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,Tt.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=mS(i);t.applyConfig(r)}catch(i){console.warn(i)}ve.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,Tt.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?_S.concat(MV):_S).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();var P0;!function(t){t.resize=function n(e,i,r,o){let s=e.width,a=e.height,l=s/(i=Math.round(i)),c=a/(r=Math.round(r)),u=Math.ceil(l/2),h=Math.ceil(c/2),g=e.getContext("2d"),w=g.getImageData(0,0,s,a),R=g.createImageData(i,r),Z=w.data,re=R.data;for(let le=0;le<r;le++)for(let J=0;J<i;J++){let be=4*(J+le*i),ye=0,Ue=0,wt=0,Ge=0,At=0,Et=0,ot=0,yt=(le+.5)*c,hi=Math.floor(le*c),_i=Math.ceil((le+1)*c);for(let dr=hi;dr<_i;dr++){let Yr=Math.abs(yt-(dr+.5))/h,Ze=(J+.5)*l,rt=Yr*Yr,pt=Math.floor(J*l),Xt=Math.ceil((J+1)*l);for(let Sn=pt;Sn<Xt;Sn++){let Mr=Math.abs(Ze-(Sn+.5))/u,Jn=Math.sqrt(rt+Mr*Mr);if(Jn>=1)continue;ye=2*Jn*Jn*Jn-3*Jn*Jn+1;let Qi=4*(Sn+dr*s);ot+=ye*Z[Qi+3],wt+=ye,Z[Qi+3]<255&&(ye=ye*Z[Qi+3]/250),Ge+=ye*Z[Qi],At+=ye*Z[Qi+1],Et+=ye*Z[Qi+2],Ue+=ye}}re[be]=Ge/Ue,re[be+1]=At/Ue,re[be+2]=Et/Ue,re[be+3]=ot/wt}!0===o?(e.width=i,e.height=r):g.clearRect(0,0,s,a),g.putImageData(R,0,0)}}(P0||(P0={}));var fo,kV=q(7412);!function(t){function r(){return(r=(0,Tt.Z)(function*(l){return l instanceof Blob?o(l):a(l)})).apply(this,arguments)}function o(l){return s.apply(this,arguments)}function s(){return(s=(0,Tt.Z)(function*(l){return a(yield t.readAsArrayBufferAsync(l))})).apply(this,arguments)}function a(l){let c=kV.create(l);return Bx(c).toString()}t.readAsArrayBufferAsync=function n(l){return new Promise((c,u)=>{let h=new FileReader;h.onload=g=>{c(h.result)},h.onabort=h.onerror=g=>{u(g)},h.readAsArrayBuffer(l)})},t.readAsTextAsync=function e(l){return new Promise((c,u)=>{let h=new FileReader;h.onload=g=>{c(h.result)},h.onabort=h.onerror=g=>{u(g)},h.readAsText(l)})},t.calcSHA256Async=function i(l){return r.apply(this,arguments)}}(fo||(fo={}));var fs,ci=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(ci||(ci={})),ci))();class Qt{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?ci.URL:this.blob===this.thumbnail.blob?ci.THUMBNAIL:ci.COMPLETE:ci.NULL}get isEmpty(){return this.state<=ci.NULL}static createEmpty(n){let e=new Qt;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Qt;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Qt;return e.apply(n),e}}static createAsync(n){return(0,Tt.Z)(function*(){return n instanceof File?yield Qt._createAsync(n,n.name):n instanceof Blob?yield Qt._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Tt.Z)(function*(){let i=yield fo.readAsArrayBufferAsync(n),r=new Qt;r.context.identifier=yield fo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield Qt.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==ci.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.state!==ci.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==ci.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==ci.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,l=r.height*s,c=document.createElement("canvas"),u=c.getContext("2d");c.width=r.width,c.height=r.height,u.drawImage(r,0,0),P0.resize(c,a,l,!0),c.toBlob(h=>{let g={type:h.type,blob:h,url:window.URL.createObjectURL(h)};e(g)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}Qt.Empty=Qt.createEmpty("null");class vt{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return vt._instance||(vt._instance=new vt),vt._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,Tt.Z)(function*(){let i=yield Qt.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Qt.create(n);else if(n instanceof Qt)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=Qt.create(n)}return this._add(e)}_add(n){return ci.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof Qt?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),ve.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ds(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)ci.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}class Lo{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return Lo._instance||(Lo._instance=new Lo),Lo._instance}register(n,e){var i,r,o;e||(e=null!==(i=n.name)&&void 0!==i?i:null!==(o=null===(r=n.toString().match(/function\s*([^(]*)\(/))||void 0===r?void 0:r[1])&&void 0!==o?o:""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306e\uff27ameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){var e;return null!==(e=this.aliasMap.get(n))&&void 0!==e?e:""}}function vS(t){return n=>{Lo.instance.register(n,t)}}function dc(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.context.syncData[n]},set:function i(r){this.context.syncData[n]=r,this.update()},enumerable:!0,configurable:!0})}}!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function u(g){return e[g]}function h(g){return r[g]}t.xml2element=function s(g){let w=new DOMParser,R=null;try{g=function c(g){return g.replace(o,"").trim()}(g),R=w.parseFromString(g,"application/xml"),R.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",R.documentElement),R=null)}catch(Z){console.error(Z)}return R?R.documentElement:null},t.encodeEntityReference=function a(g){return g.replace(n,u)},t.decodeEntityReference=function l(g){return g.replace(i,h)}}(fs||(fs={}));const IV=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class yn{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return yn._instance||(yn._instance=new yn),yn._instance}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():yn.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i){let a=fs.encodeEntityReference(i[s]+"");null!=a&&(o+=" "+s+'="'+a+'"')}return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=yn.make2Attributes(n[i],i);for(let a in s)e[a]=s[a]}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=yn.array2attributes(n,e);for(let o in r)i[o]=r[o]}else if("object"==typeof n){let r=yn.object2attributes(n,e);for(let o in r)i[o]=r[o]}else i[e]=n;return i}static object2attributes(n,e){let i={};for(let r in n){let a=yn.make2Attributes(n[r],e+"."+r);for(let l in a)i[l]=a[l]}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let l=yn.make2Attributes(n[o],e+"."+o);for(let c in l)i[c]=l[c]}return i}parseXml(n){let e=null;if(e="string"==typeof n?fs.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=Lo.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();yn.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=fs.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],l=n,c=s.find(h=>IV.includes(h));null==c?1<s.length&&(({obj:l,key:a}=yn.attributes2object(s,l,a)),null==a)||("string"!=typeof l[a]&&null!=l[a]&&(o=JSON.parse(o)),l[a]=o):console.log(`skip invalid key (${c})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class Oe{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return Oe._instance||(Oe._instance=new Oe),Oe._instance}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&ve.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}ve.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Bi(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;let s=o.value[0];o.value[1]+n<e||this.garbageMap.delete(s)}}}class Js{constructor(n=Yu.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}static get aliasName(){return Lo.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){Oe.instance.add(this)}destroy(){Oe.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Oe.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){let n=this.toXml();return yn.instance.parseXml(n)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:yS(this.context.syncData)}}toXml(){return yn.instance.toXml(this)}}function yS(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=yS(t[i]):"function"!==r&&(n[i]=t[i])}return n}var Bo;let bn=Bo=class extends Js{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Oe.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Oe.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Oe.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==Bo.unknownNodes[this.identifier])return;let n=Bo.unknownNodes[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);Bo.unknownNodes[this.identifier]&&delete Bo.unknownNodes[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return n.majorIndex=0|s,n.minorIndex=s-n.majorIndex,this.updateChildren(n),o<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return yn.toAttributes(this.attributes)}parseAttributes(n){yn.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=fs.encodeEntityReference(this.value+"");for(let e of this.children)n+=yn.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=yn.instance.parseXml(e[r]);o instanceof Bo&&this.appendChild(o)}else this.value=fs.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Bo.unknownNodes||(Bo.unknownNodes[this.parentIdentifier]=[]),Bo.unknownNodes[this.parentIdentifier].push(this))}};function Hn(t){return n=>{vS(t)(n)}}function at(){return(t,n)=>{t instanceof bn?function AV(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.getAttribute(n)},set:function i(r){this.setAttribute(n,r)},enumerable:!0,configurable:!0})}}()(t,n):dc()(t,n)}}bn.unknownNodes={},X([dc()],bn.prototype,"value",void 0),X([dc()],bn.prototype,"attributes",void 0),X([dc()],bn.prototype,"parentIdentifier",void 0),X([dc()],bn.prototype,"majorIndex",void 0),X([dc()],bn.prototype,"minorIndex",void 0),bn=Bo=X([vS("node")],bn);let lr=class extends bn{constructor(){super(...arguments),this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return vt.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===He.peerContext.userId||this.originFrom===He.peerContext.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf(He.peerContext.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!(!this.isSystem||"System-BCDice"!==this.from)}get isSecret(){return-1<this.tags.indexOf("secret")}};X([at()],lr.prototype,"originFrom",void 0),X([at()],lr.prototype,"from",void 0),X([at()],lr.prototype,"to",void 0),X([at()],lr.prototype,"name",void 0),X([at()],lr.prototype,"tag",void 0),X([at()],lr.prototype,"dicebot",void 0),X([at()],lr.prototype,"imageIdentifier",void 0),lr=X([Hn("chat")],lr);let hc=class extends bn{constructor(){super(...arguments),this.name="\u30bf\u30d6",this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof lr&&n.isDisplayable&&(this._unreadLength++,ve.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new lr;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),ve.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof lr&&!e.isDisplayable||(n+=yn.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}};var Gr;X([at()],hc.prototype,"name",void 0),hc=X([Hn("chat-tab")],hc);let zo=Gr=class extends bn{static get instance(){return Gr._instance||(Gr._instance=new Gr("ChatTabList"),Gr._instance.initialize()),Gr._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof hc)e=n[0];else{let i=n[0];e=new hc(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Gr.instance.children)i.destroy();let e=Gr.instance.toContext();e.syncData=this.toContext().syncData,Gr.instance.apply(e),Gr.instance.update(),super.parseInnerXml.apply(Gr.instance,[n]),this.destroy()}};var fc;zo=Gr=X([Hn("chat-tab-list")],zo),function(t){t.toHalfWidth=function n(e){return e.replace(/[\uff01-\uff5e]/g,i=>String.fromCharCode(i.charCodeAt(0)-65248))}}(fc||(fc={}));let ed=class extends bn{constructor(){super(...arguments),this.dicebot="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette,console.log(i);let o=0,s=!0;for(;s;)o++,s=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(a,l)=>{l=fc.toHalfWidth(l),console.log(l),s=!0;for(let c of this.paletteVariables)if(c.name==l)return c.value;if(e){let c=e.getFirstElementByName(l);if(c)return c.isNumberResource?c.currentValue+"":c.value+""}return""}),128<o&&(s=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:fc.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var za;X([at()],ed.prototype,"dicebot",void 0),ed=X([Hn("chat-palette")],ed);let it=za=class extends bn{get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isNote(){return null!=this.type&&"note"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new za(r):new za,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}getElementsByName(n){let e=[];for(let i of this.children)i instanceof za&&(i.getAttribute("name")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(n)));return e}getElementsByType(n){let e=[];for(let i of this.children)i instanceof za&&(i.getAttribute("type")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(n)));return e}getFirstElementByName(n){for(let e of this.children)if(e instanceof za){if(e.getAttribute("name")===n)return e;let i=e.getFirstElementByName(n);if(i)return i}return null}};X([at()],it.prototype,"name",void 0),X([at()],it.prototype,"type",void 0),X([at()],it.prototype,"currentValue",void 0),it=za=X([Hn("data")],it);let cr=class extends bn{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Qt.Empty,this._dataElements={}}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageDataElement.getFirstElementByName("imageIdentifier");if(n&&this._imageFile.identifier!==n.value){let e=vt.instance.get(n.value);this._imageFile=e||Qt.Empty}return this._imageFile}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=it.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(it.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(it.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(it.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(it.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?Oe.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);!i||(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?vt.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};var F0;X([at()],cr.prototype,"location",void 0),X([at()],cr.prototype,"posZ",void 0),cr=X([Hn("TabletopObject")],cr);let Cn=F0=class extends cr{constructor(){super(...arguments),this.rotate=0,this.roll=0}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let n of this.children)if(n instanceof ed)return n;return null}static create(n,e,i){let r=new F0;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}createTestGameDataElement(n,e,i){this.createDataElements();let r=it.create("name",n,{},"name_"+this.identifier),o=it.create("size",e,{},"size_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let s=it.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),a=it.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),l=it.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.detailDataElement.appendChild(s),s.appendChild(a),s.appendChild(l);let c=it.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(c),c.appendChild(it.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),c.appendChild(it.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),c=it.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(it.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),c.appendChild(it.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),c.appendChild(it.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),c.appendChild(it.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),c.appendChild(it.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),c.appendChild(it.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),c=it.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(it.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),c.appendChild(it.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),c.appendChild(it.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),c.appendChild(it.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),c.appendChild(it.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),c.appendChild(it.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let g=new ed("ChatPalette_"+this.identifier);g.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),g.initialize(),this.appendChild(g)}};var Nn;X([at()],Cn.prototype,"rotate",void 0),X([at()],Cn.prototype,"roll",void 0),Cn=F0=X([Hn("character")],Cn);let kt=Nn=class extends Js{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier=""}get isMine(){return Nn.myCursor&&Nn.myCursor===this}get image(){return vt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||ve.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{He.peerIds.includes(this.peerId)||(Nn.userIdMap.delete(this.userId),Nn.peerIdMap.delete(this.peerId),Oe.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),ve.unregister(this),Nn.userIdMap.delete(this.userId),Nn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(Nn.userIdMap,n,!0)}static findByPeerId(n){return this.find(Nn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&Oe.instance.get(r))return Oe.instance.get(r);let o=Oe.instance.getObjects(Nn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return Nn.myCursor?(console.warn("It is already created."),Nn.myCursor):(Nn.myCursor=new Nn,Nn.myCursor.peerId=He.peerId,Nn.myCursor.initialize(),Nn.myCursor)}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(Nn.userIdMap.set(e,this.identifier),Nn.userIdMap.delete(this.userId)),i!==this.peerId&&(Nn.peerIdMap.set(i,this.identifier),Nn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};kt.myCursor=null,kt.userIdMap=new Map,kt.peerIdMap=new Map,X([at()],kt.prototype,"userId",void 0),X([at()],kt.prototype,"peerId",void 0),X([at()],kt.prototype,"name",void 0),X([at()],kt.prototype,"imageIdentifier",void 0),kt=Nn=X([Hn("PeerCursor")],kt);let Va=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return zo.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,c=new Date(o.utc_datetime).getTime();this.timeOffset=c+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+c),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s){let a={from:He.peerContext.userId,to:this.findId(s),name:this.makeMessageName(o,s),imageIdentifier:this.findImageIdentifier(o),timestamp:this.calcTimeStamp(e),tag:r,text:i};return e.addMessage(a)}findId(e){let i=Oe.instance.get(e);return i instanceof Cn?i.identifier:i instanceof kt?i.userId:null}findObjectName(e){let i=Oe.instance.get(e);return i instanceof Cn||i instanceof kt?i.name:e}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" > "+this.findObjectName(i)}findImageIdentifier(e){let i=Oe.instance.get(e);return i instanceof Cn?i.imageFile?i.imageFile.identifier:"":i instanceof kt?i.imageIdentifier:e}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();var zf=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(zf||(zf={})),zf))();const Kn={name:"",enabled:!0,type:zf.SEPARATOR};let ur=(()=>{class t{constructor(e){this.componentFactoryResolver=e,this.title="",this.actions=[],this.position={x:0,y:0}}get isShow(){return!!this.panelComponentRef}open(e,i,r,o){let s;this.close(),o||(o=t.defaultParentViewContainerRef,console.log("Context Open"));const a=o.injector,l=this.componentFactoryResolver.resolveComponentFactory(t.ContextMenuComponentClass);s=o.createComponent(l,o.length,a);const c=s.injector.get(t);c.panelComponentRef=s,i&&(c.actions=i),e&&(c.position.x=e.x,c.position.y=e.y),c.title=null!=r?r:"",s.onDestroy(()=>{c.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)(Ct(Is))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();var Vo,td=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(td||(td={})),td))();let Uo=Vo=class extends Js{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=td.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return Vo._instance||(Vo._instance=new Vo("DataSummarySetting"),Vo._instance.initialize()),Vo._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=Vo.instance.toContext();e.syncData=this.toContext().syncData,Vo.instance.apply(e),Vo.instance.update(),this.destroy()}};X([at()],Uo.prototype,"sortTag",void 0),X([at()],Uo.prototype,"sortOrder",void 0),X([at()],Uo.prototype,"dataTag",void 0),Uo=Vo=X([Hn("summary-setting")],Uo);let N0=(()=>{class t{constructor(){this.tableInventory=new Vf(e=>"table"===e.location.name),this.commonInventory=new Vf(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new Vf(e=>e.location.name===He.peerId),this.graveyardInventory=new Vf(e=>"graveyard"===e.location.name),this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=it.create(this.newLineString),this.initialize()}get summarySetting(){return Uo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}initialize(){ve.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);if(i)if(i instanceof Cn){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof it){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),this.sortTag===i.name&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof Uo&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=Cn.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){ve.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===He.peerId||"graveyard"===e)return!0;for(let i of He.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Vf{constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=it.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return Uo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.rootDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=Oe.instance.getObjects(Cn),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{var s,a;let l=null===(s=r.rootDataElement)||void 0===s?void 0:s.getFirstElementByName(e),c=null===(a=o.rootDataElement)||void 0===a?void 0:a.getFirstElementByName(e);if(!l&&!c)return 0;if(!c)return-1;if(!l)return 1;let u=this.convertToSortableValue(l),h=this.convertToSortableValue(c);return u<h?i:u>h?-1*i:0}),n}convertToSortableValue(n){let i=fc.toHalfWidth(((n.isNumberResource?n.currentValue:n.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}class PV{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Di=(()=>{class t{constructor(e){this.componentFactoryResolver=e,this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let o;return r||(r=t.defaultParentViewContainerRef),new Promise((s,a)=>{const u=new t(this.componentFactoryResolver);u.modalContext=new PV(Z=>{o&&(o.destroy(),s(Z),this.count--)},Z=>{o&&(o.destroy(),a(Z),this.count--)},i);const g=Cr.create([{provide:t,useValue:u}],r.injector),w=this.componentFactoryResolver.resolveComponentFactory(t.ModalComponentClass),R=this.componentFactoryResolver.resolveComponentFactory(e);o=r.createComponent(w,r.length,g),o.instance.content.createComponent(R),o.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)(Ct(Is))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})(),rn=(()=>{class t{constructor(e){this.componentFactoryResolver=e,this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let o;r||(r=t.defaultParentViewContainerRef);const s=r.injector,a=this.componentFactoryResolver.resolveComponentFactory(t.UIPanelComponentClass),l=this.componentFactoryResolver.resolveComponentFactory(e);o=r.createComponent(a,r.length,s);let c=o.instance.content.createComponent(l);const u=o.injector.get(t);return u.panelComponentRef=o,i&&(i.title&&(u.title=i.title),i.top&&(u.top=i.top),i.left&&(u.left=i.left),i.width&&(u.width=i.width),i.height&&(u.height=i.height)),o.onDestroy(()=>{u.panelComponentRef=null}),c.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)(Ct(Is))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})(),Qn=(()=>{class t{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)(Ct(Gt))},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function R0(t,n=[]){let e=Oe.instance.getObjects(t.aliasName);n.forEach(o=>e=e.concat(Oe.instance.getObjects(o))),e=e.filter(o=>o.isVisibleOnTable);let i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}var Uf,ps=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(ps||(ps={})),ps))();let Ki=Uf=class extends cr{constructor(){super(...arguments),this.state=ps.FRONT,this.rotate=0,this.owner="",this.zindex=0}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let n=kt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get isHand(){return He.peerContext.userId===this.owner}get isFront(){return this.state===ps.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=ps.FRONT,this.owner=""}faceDown(){this.state=ps.BACK,this.owner=""}toTopmost(){R0(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new Uf(o):new Uf,s.createDataElements(),s.commonDataElement.appendChild(it.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(it.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(it.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(it.create("back",i,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};var jf;X([at()],Ki.prototype,"state",void 0),X([at()],Ki.prototype,"rotate",void 0),X([at()],Ki.prototype,"owner",void 0),X([at()],Ki.prototype,"zindex",void 0),Ki=Uf=X([Hn("card")],Ki);let gi=jf=class extends cr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0}get name(){return this.getCommonValue("name","")}get ownerName(){let n=kt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(n){super.onChildRemoved(n),n instanceof Ki&&ve.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){R0(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new jf(e):new jf,i.createDataElements(),i.commonDataElement.appendChild(it.create("name",n,{},"name_"+i.identifier));let r=new bn("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};X([at()],gi.prototype,"rotate",void 0),X([at()],gi.prototype,"zindex",void 0),X([at()],gi.prototype,"owner",void 0),X([at()],gi.prototype,"isShowTotal",void 0),gi=jf=X([Hn("card-stack")],gi);var Hf,mi=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(mi||(mi={})),mi))();let jo=Hf=class extends cr{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement.children.map(n=>n.name)}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get ownerName(){let n=kt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get isMine(){return He.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case mi.D2:i=2;break;case mi.D4:i=4;break;case mi.D6:i=6;break;case mi.D8:i=8;break;case mi.D10_10TIMES:o=s=>s+1+"0";case mi.D10:i=10;break;case mi.D12:i=12;break;case mi.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(it.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=r[0].name,r}static create(n,e,i,r){let o=r?new Hf(r):new Hf;return o.createDataElements(),o.commonDataElement.appendChild(it.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(it.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var Gf;X([at()],jo.prototype,"face",void 0),X([at()],jo.prototype,"owner",void 0),X([at()],jo.prototype,"rotate",void 0),jo=Hf=X([Hn("dice-symbol")],jo);let po=Gf=class extends cr{constructor(){super(...arguments),this.isLock=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}static create(n,e,i,r,o){let s=null;return s=o?new Gf(o):new Gf,s.createDataElements(),s.commonDataElement.appendChild(it.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(it.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(it.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(it.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};X([at()],po.prototype,"isLock",void 0),po=Gf=X([Hn("table-mask")],po);var $f,ea=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(ea||(ea={})),ea))();let $r=$f=class extends cr{constructor(){super(...arguments),this.isLocked=!1,this.mode=ea.ALL,this.rotate=0}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&ea.WALL)}get hasFloor(){return!!(this.mode&ea.FLOOR)}static create(n,e,i,r,o,s,a){let l=null;return l=a?new $f(a):new $f,l.createDataElements(),l.commonDataElement.appendChild(it.create("name",n,{},"name_"+l.identifier)),l.commonDataElement.appendChild(it.create("width",e,{},"width_"+l.identifier)),l.commonDataElement.appendChild(it.create("height",r,{},"height_"+l.identifier)),l.commonDataElement.appendChild(it.create("depth",i,{},"depth_"+l.identifier)),l.imageDataElement.appendChild(it.create("wall",o,{type:"image"},"wall_"+l.identifier)),l.imageDataElement.appendChild(it.create("floor",s,{type:"image"},"floor_"+l.identifier)),l.initialize(),l}};X([at()],$r.prototype,"isLocked",void 0),X([at()],$r.prototype,"mode",void 0),X([at()],$r.prototype,"rotate",void 0),$r=$f=X([Hn("terrain")],$r);var gs=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(gs||(gs={})),gs))(),Wf=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(Wf||(Wf={})),Wf))();let ui=class extends bn{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=Wf.NONE,this.selected=!1,this.gridType=gs.SQUARE,this.gridColor="#000000e6"}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof $r&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof po&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&ve.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};X([at()],ui.prototype,"name",void 0),X([at()],ui.prototype,"width",void 0),X([at()],ui.prototype,"height",void 0),X([at()],ui.prototype,"gridSize",void 0),X([at()],ui.prototype,"imageIdentifier",void 0),X([at()],ui.prototype,"backgroundImageIdentifier",void 0),X([at()],ui.prototype,"backgroundFilterType",void 0),X([at()],ui.prototype,"selected",void 0),X([at()],ui.prototype,"gridType",void 0),X([at()],ui.prototype,"gridColor",void 0),ui=X([Hn("game-table")],ui);var Si=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Si||(Si={})),Si))();class Dr{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Si.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Si.URL:Si.COMPLETE:Si.NULL}static createEmpty(n){let e=new Dr;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Dr;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Dr;return e.apply(n),e}}static createAsync(n){return(0,Tt.Z)(function*(){return n instanceof File?yield Dr._createAsync(n,n.name):n instanceof Blob?yield Dr._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Tt.Z)(function*(){let i=yield fo.readAsArrayBufferAsync(n),r=new Dr;return r.context.identifier=yield fo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Si.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),this.createURLs()}createURLs(){this.state!==Si.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Si.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var gc,pc=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION"}(pc||(pc={})),pc))();class nt{constructor(n){this.volumeType=pc.MASTER,this.audio=n}static get audioContext(){return nt._audioContext||(nt._audioContext=new(window.AudioContext||window.webkitAudioContext)),nt._audioContext}static get volume(){return nt._volume}static set volume(n){nt._volume=n,nt.masterGainNode.gain.setTargetAtTime(nt._volume,nt.audioContext.currentTime,.01)}static get auditionVolume(){return nt._auditionVolume}static set auditionVolume(n){nt._auditionVolume=n,nt.auditionGainNode.gain.setTargetAtTime(nt._auditionVolume,nt.audioContext.currentTime,.01)}static get masterGainNode(){if(!nt._masterGainNode){let n=nt.audioContext.createGain();n.gain.setValueAtTime(nt._volume,nt.audioContext.currentTime),n.connect(nt.audioContext.destination),nt._masterGainNode=n}return nt._masterGainNode}static get auditionGainNode(){if(!nt._auditionGainNode){let n=nt.audioContext.createGain();n.gain.setValueAtTime(nt._auditionVolume,nt.audioContext.currentTime),n.connect(nt.audioContext.destination),nt._auditionGainNode=n}return nt._auditionGainNode}static get rootNode(){return nt.masterGainNode}static get auditionNode(){return nt.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=nt.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static play(n,e=1){this.playBufferAsync(n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===Si.URL&&(nt.cacheMap.has(n.identifier)?e=nt.cacheMap.get(n.identifier).url:nt.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===pc.AUDITION?nt.auditionNode:nt.rootNode}static playBufferAsync(n,e=1){return(0,Tt.Z)(function*(){let i=yield nt.createBufferSourceAsync(n);if(!i)return;let r=nt.audioContext.createGain();r.gain.setValueAtTime(e,nt.audioContext.currentTime),r.connect(nt.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(n){var e=this;return(0,Tt.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===Si.URL)if(nt.cacheMap.has(n.identifier))i=nt.cacheMap.get(n.identifier).blob;else{let s=yield nt.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=nt.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,Tt.Z)(function*(i,r){nt.audioContext.decodeAudioData(yield fo.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,Tt.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,Tt.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield nt.getBlobAsync(n)}catch(i){return console.error(i),e}return nt.cacheMap.has(n.identifier)?nt.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),nt.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){nt.audioContext.resume();let n=()=>{nt.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}nt._volume=.5,nt._auditionVolume=.5,nt.cacheMap=new Map;class ct{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return ct._instance||(ct._instance=new ct),ct._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,Tt.Z)(function*(){let i=yield Dr.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Dr.create(n);else if(n instanceof Dr)e=n;else{if(this.update(n))return this.hash[n.identifier];e=Dr.create(n)}return this._add(e)}_add(n){return Si.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof Dr?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),ve.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ds(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of ct.instance.audios)Si.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let Me=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t})(),We=gc=class extends Js{onStoreAdded(){super.onStoreAdded(),ve.register(this).on("SOUND_EFFECT",n=>{nt.play(ct.instance.get(n.data),.5)}).on("SEND_MESSAGE",n=>{let e=Oe.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||!e.isDicebot||(Math.random()<.5?gc.play(Me.diceRoll1):gc.play(Me.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),ve.unregister(this)}play(n){gc.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,gc._play(e)}static _play(n){ve.call("SOUND_EFFECT",n)}};var Ua;We=gc=X([Hn("sound-effect")],We);let Ho=Ua=class extends Js{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return Ua._instance||(Ua._instance=new Ua("TableSelecter"),Ua._instance.initialize()),Ua._instance}onStoreAdded(){super.onStoreAdded(),ve.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),ve.unregister(this)}get viewTable(){let n=Oe.instance.get(this.viewTableIdentifier);return n||(n=Oe.instance.getObjects(ui)[0],n&&(this.viewTableIdentifier.length<1||Oe.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,ve.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};var Zf;X([at()],Ho.prototype,"viewTableIdentifier",void 0),Ho=Ua=X([Hn("TableSelecter")],Ho);let Go=Zf=class extends cr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password=""}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}toTopmost(){R0(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new Zf(s):new Zf;return a.createDataElements(),a.commonDataElement.appendChild(it.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(it.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(it.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(it.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(it.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.initialize(),a}};var Gn;X([at()],Go.prototype,"rotate",void 0),X([at()],Go.prototype,"zindex",void 0),X([at()],Go.prototype,"password",void 0),Go=Zf=X([Hn("text-note")],Go),function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(Gn||(Gn={}));class di{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new di){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,l=r+this.m32,c=o+this.m33,u=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==u&&(u=1e-4),a/=u,l/=u,c/=u;let h=c-o;if(0==h)return e.x=i,e.y=r,e.z=o,e.w=o,e;let g=-o/h;return i+=g*(a-i),r+=g*(l-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return di.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new di){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(di.makePosition(e,di.MATRIX3D))}static makePerspective(n,e=new di){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(di.makePerspective(n,di.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,l=this.m22,c=this.m23,u=this.m24,h=this.m31,g=this.m32,w=this.m33,R=this.m34,Z=this.m41,re=this.m42,le=this.m43,J=this.m44;e[0]=c*R*re-u*w*re+u*g*le-l*R*le-c*g*J+l*w*J,e[1]=s*w*re-o*R*re-s*g*le+r*R*le+o*g*J-r*w*J,e[2]=o*u*re-s*c*re+s*l*le-r*u*le-o*l*J+r*c*J,e[3]=s*c*g-o*u*g-s*l*w+r*u*w+o*l*R-r*c*R;let be=i*e[0]+a*e[1]+h*e[2]+Z*e[3];return 0==be?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=u*w*Z-c*R*Z-u*h*le+a*R*le+c*h*J-a*w*J,e[5]=o*R*Z-s*w*Z+s*h*le-i*R*le-o*h*J+i*w*J,e[6]=s*c*Z-o*u*Z-s*a*le+i*u*le+o*a*J-i*c*J,e[7]=o*u*h-s*c*h+s*a*w-i*u*w-o*a*R+i*c*R,e[8]=l*R*Z-u*g*Z+u*h*re-a*R*re-l*h*J+a*g*J,e[9]=s*g*Z-r*R*Z-s*h*re+i*R*re+r*h*J-i*g*J,e[10]=r*u*Z-s*l*Z+s*a*re-i*u*re-r*a*J+i*l*J,e[11]=s*l*h-r*u*h-s*a*g+i*u*g+r*a*R-i*l*R,e[12]=c*g*Z-l*w*Z-c*h*re+a*w*re+l*h*le-a*g*le,e[13]=r*w*Z-o*g*Z+o*h*re-i*w*re-r*h*le+i*g*le,e[14]=o*l*Z-r*c*Z-o*a*re+i*c*re+r*a*le-i*l*le,e[15]=r*c*h-o*l*h+o*a*g-i*c*g-r*a*w+i*l*w,n.setData(e),n.scalar(1/be),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Gn.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(di.MATRIX3D.setCSS(n).flatten()):this.append(di.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new di){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,l=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,c=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,u=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,h=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,g=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,w=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,R=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Z=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,re=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,le=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,J=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,be=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=l,i.m22=c,i.m23=u,i.m24=h,i.m31=g,i.m32=w,i.m33=R,i.m34=Z,i.m41=re,i.m42=le,i.m43=J,i.m44=be,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}di.MATRIX3D=new di;class nd{constructor(n){this.matrix=new di,this.sceneTransform=new di,this.inverseSceneTransform=new di,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Gn.relation(e.paddingTop,i),this.paddingTop=Gn.relation(e.paddingTop,r),this.marginLeft=Gn.relation(e.marginLeft,i),this.marginTop=Gn.relation(e.marginTop,r),this.borderLeft=Gn.relation(e.borderLeft,i),this.borderTop=Gn.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new nd(r),a=di.multiply(this.sceneTransform,s.inverseSceneTransform),l={x:0,y:0,z:0,w:1};return l.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,l.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,l.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,l.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(l),l}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new di),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],l=Gn.relation(a[0],i.offsetWidth,.5*i.offsetWidth),c=Gn.relation(a[1],i.offsetHeight,.5*i.offsetHeight),u=Gn.relation(a[2],0,0);e.appendPosition(-l,-c,-u),e.appendCSS(r.transform),e.appendPosition(l,c,u)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=Gn.parse(a.perspective)}if(n.parentElement&&s){let l=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),c=Gn.relation(l[0],i.parentElement.offsetWidth),u=Gn.relation(l[1],i.parentElement.offsetHeight);e.appendPosition(-c,-u,0),e.appendPerspective(s),e.appendPosition(c,u,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let ja=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new nd(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new nd(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new nd(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)(Ct(Qn))},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),L0=(()=>{class t{constructor(e){this.coordinateService=e,this._emptyTable=new ui(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Ha(()=>Oe.instance.getObjects(Cn).filter(i=>i.isVisibleOnTable)),this.cardCache=new Ha(()=>Oe.instance.getObjects(Ki).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Ha(()=>Oe.instance.getObjects(gi).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Ha(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.terrainCache=new Ha(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Ha(()=>Oe.instance.getObjects(Go)),this.diceSymbolCache=new Ha(()=>Oe.instance.getObjects(jo)),this.initialize()}get tableSelecter(){return Ho.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Oe.instance.getObjects(kt)}initialize(){this.refreshCacheAll(),ve.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(po.aliasName),void this.refreshCache($r.aliasName);let i=Oe.instance.get(e.data.identifier);i&&i instanceof cr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=yn.instance.parseXml(e.data.xmlElement);if(r instanceof cr){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),We.play(Me.piecePut)}else r instanceof hc&&zo.instance.addChatTab(r)})}findCache(e){switch(e){case Cn.aliasName:return this.characterCache;case Ki.aliasName:return this.cardCache;case gi.aliasName:return this.cardStackCache;case po.aliasName:return this.tableMaskCache;case $r.aliasName:return this.terrainCache;case Go.aliasName:return this.textNoteCache;case jo.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case po.aliasName:e instanceof po&&(e.isLock=!1);case $r.aliasName:if(e instanceof $r&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)(Ct(ja))},t.\u0275prov=It({token:t,factory:t.\u0275fac}),t})();class Ha{constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}class Ga{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Ga(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Ga(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&ve.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){ve.unregister(this),this.sendChankTimer&&function i5(t){ku.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=Tr.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),ve.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Bi(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);ve.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Bi(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=Bi(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,ve.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),ve.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=Tr.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ds(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class mc{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return mc._instance||(mc._instance=new mc),mc._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),ve.register(this).on("CONNECT_PEER",-1,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),ct.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=ct.instance.get(o.identifier);null===s&&(s=Dr.createEmpty(o.identifier),ct.instance.add(s)),s.state<Si.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<ct.instance.getCatalog().length&&ct.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=ct.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=ct.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(He.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void ve.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),ct.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=ct.instance.get(e);this.receiveTaskMap.has(e)||i&&Si.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),ve.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){ve.unregister(this)}startSendTask(n,e){var i=this;return(0,Tt.Z)(function*(){let r=Ga.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),ve.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===Si.URL?o.url=n.url:(o.blob=yield fo.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),ct.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=ct.instance.get(n),i=Ga.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&ve.trigger("UPDATE_AUDIO_RESOURE",[o]),ct.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=He.peerIds;i.splice(i.indexOf(He.peerId),1),ve.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:He.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}var _c,Wr,NV=q(4327),bS=q(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(_c||(_c={}));class $o{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return $o._instance||($o._instance=new $o),$o._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,Tt.Z)(function*(){if(!n)return;let i=n instanceof FileList?wS(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),ve.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,Tt.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield vt.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,Tt.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield ct.instance.addAsync(n)}})()}handleText(n){return(0,Tt.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=fs.xml2element(yield fo.readAsTextAsync(n));e&&ve.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,Tt.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new bS;try{i=yield i.loadAsync(n)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:_c.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,Tt.Z)(function*(){if(!n)return;let r=n instanceof FileList?wS(n):n,o=new bS;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,NV.saveAs)(s,e+".zip")})()}}function wS(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}class vc{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return vc._instance||(vc._instance=new vc),vc._instance}initialize(){var n=this;ve.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),vt.instance.synchronize())}).on("XML_LOADED",e=>{!function RV(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!vt.instance.get(r)&&0<_c.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!vt.instance.get(r)&&0<_c.type(r).length&&n.push(r)}for(let i of n)vt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=vt.instance.get(o.identifier);null===s&&(s=Qt.createEmpty(o.identifier),vt.instance.add(s)),s.state<ci.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<vt.instance.getCatalog().length&&vt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,Tt.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=vt.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(He.peerId);-1<a&&s.splice(a,1);for(let l of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+l+" -> "+i.data.identifiers),void ve.call(i,l);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),vt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=vt.instance.get(i);this.receiveTaskMap.has(i)||r&&ci.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),ve.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){ve.unregister(this)}startSendTask(n,e){var i=this;return(0,Tt.Z)(function*(){let r=1===n.length?n[0].identifier:Yu.generateUuid(),o=Ga.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),ve.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield fo.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield fo.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),vt.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=Ga.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&ve.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),vt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=He.peerIds;i.splice(i.indexOf(He.peerId),1),ve.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:He.peerId,candidatePeers:i},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=vt.instance.get(s.identifier),l={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===ci.URL?l.url=a.url:s.state===ci.NULL?(l.thumbnail.blob=a.thumbnail.blob,l.thumbnail.type=a.thumbnail.type):(l.blob=a.blob,l.type=a.blob.type);let c=l.blob?l.blob.size:l.thumbnail.blob?l.thumbnail.blob.size:100;if(i.push(l),r+=c,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class $n{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){$n.tasksMap.size<1&&ve.register($n.key).on("DISCONNECT_PEER",r=>{$n.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||$n.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||$n.onUpdate(r.data.identifier)});let i=new $n(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=$n.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),$n.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;ve.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of $n.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();$n.tasksMap.size<1&&ve.unregister($n.key)}static onUpdate(n){if(!$n.tasksMap.has(n))return;let e=$n.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);$n.tasksMap.size<1&&ve.unregister($n.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=$n.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&$n.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ds(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}$n.key={},$n.tasksMap=new Map;class yc{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return yc._instance||(yc._instance=new yc),yc._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),ve.register(this).on("CONNECT_PEER",2,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)Oe.instance.isDeleted(i.identifier)?ve.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(Oe.instance.isDeleted(n.data))ve.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=Oe.instance.get(n.data);e&&ve.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=Oe.instance.get(e.identifier);i?n.isSendFromSelf||this.updateObject(i,e):Oe.instance.isDeleted(e.identifier)?ve.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):this.createObject(e)}).on("DELETE_GAME_OBJECT",1e3,n=>{Oe.instance.delete(n.data.identifier,!1)})}destroy(){ve.unregister(this)}updateObject(n,e){e.majorVersion+e.minorVersion>n.version&&n.apply(e)}createObject(n){let e=Lo.instance.create(n.aliasName,n.identifier);e?(Oe.instance.add(e,!1),e.apply(n)):console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=Oe.instance.getCatalog(),i=setInterval(()=>{ve.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=$n.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=Oe.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=He.peerContexts;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}class ES{constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}let go=Wr=class extends Js{onStoreAdded(){var n=this;super.onStoreAdded(),ve.register(this).on("SEND_MESSAGE",function(){var e=(0,Tt.Z)(function*(i){let r=Oe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;let o=fc.toHalfWidth(r.text).trim(),s=r.tag;try{let a=/^((\d+)?\s+)?(.*)?/gi.exec(o),l=null!=a[2]?Number(a[2]):1,c=null!=a[3]?a[3]:o;if(!c||l<1)return;l>1&&(c=`x${l} ${c}`);let u=yield Wr.diceRollAsync(c,s);if(!u.result)return;n.sendResultMessage(u,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),ve.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result,o=n.isSecret;if(r.length<1)return;let s={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:"system dicebot"+(o?" secret":""),name:`${i} : ${e.name}${o?" (Secret)":""}`,text:r};null!=e.to&&0<e.to.length&&(s.to=e.to,e.to.indexOf(e.from)<0&&(s.to+=" "+e.from));let a=Oe.instance.get(e.tabIdentifier);a&&a.addMessage(s)}static diceRollAsync(n,e){return(0,Tt.Z)(function*(){const i={id:e,result:"",isSecret:!1};try{const r=yield Wr.loadGameSystemAsync(e);if(!(null==r?void 0:r.COMMAND_PATTERN.test(n)))return i;const o=r.eval(n);if(o)return console.log("diceRoll!!!",o.text),console.log("isSecret!!!",o.secret),{id:r.ID,result:o.text.replace(/\n?(#\d+)\n/gi,"$1 "),isSecret:o.secret}}catch(r){console.error(r)}return i})()}static getHelpMessage(n){return(0,Tt.Z)(function*(){try{return(yield Wr.loadGameSystemAsync(n)).HELP_MESSAGE}catch(e){console.error(e)}return""})()}static loadGameSystemAsync(n){var e=this;return(0,Tt.Z)(function*(){return yield Wr.queue.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return Wr.loader.getGameSystemClass(i)}catch(r){return Wr.loader.dynamicLoad(i)}})})()}static initializeDiceBotQueue(){let n=new ES("DiceBotQueue");return n.add((0,Tt.Z)(function*(){Wr.loader=new((yield q.e(2460).then(q.bind(q,383))).default),Wr.diceBotInfos=Wr.loader.listAvailableGameSystems().sort((e,i)=>e.sortKey<i.sortKey?-1:e.sortKey>i.sortKey?1:0)})),n}};go.queue=Wr.initializeDiceBotQueue(),go.diceBotInfos=[],go=Wr=X([Hn("dice-bot")],go);let $a=class extends Js{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new nt}get audio(){return ct.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=ct.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){ve.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){ve.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};X([at()],$a.prototype,"audioIdentifier",void 0),X([at()],$a.prototype,"startTime",void 0),X([at()],$a.prototype,"isLoop",void 0),X([at()],$a.prototype,"isPlaying",void 0),$a=X([Hn("jukebox")],$a);let B0=class extends Js{onStoreAdded(){super.onStoreAdded(),Oe.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(Oe.instance.getObjects(ui)),e=e.concat(Oe.instance.getObjects(Cn)),e=e.concat(Oe.instance.getObjects(Go)),e=e.concat(Oe.instance.getObjects(gi)),e=e.concat(Oe.instance.getObjects(Ki).filter(i=>null===i.parent)),e=e.concat(Oe.instance.getObjects(jo));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(Oe.instance.getObjects(ui)),e=e.concat(Oe.instance.getObjects(po)),e=e.concat(Oe.instance.getObjects($r)),e=e.concat(Oe.instance.getObjects(Cn)),e=e.concat(Oe.instance.getObjects(Go)),e=e.concat(Oe.instance.getObjects(gi)),e=e.concat(Oe.instance.getObjects(Ki)),e=e.concat(Oe.instance.getObjects(jo));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)yn.instance.parseXml(n.children[i])}};B0=X([Hn("room")],B0);var LV=q(1203);class Sr{constructor(n){this.ngZone=n}saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return Sr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new B0),o=this.convertToXml(zo.instance),s=this.convertToXml(Uo.instance);return i.push(new File([r],"data.xml",{type:"text/plain"})),i.push(new File([o],"chat.xml",{type:"text/plain"})),i.push(new File([s],"summary.xml",{type:"text/plain"})),i=i.concat(this.searchImageFiles(r)),i=i.concat(this.searchImageFiles(o)),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="xml_data",i){return Sr.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="xml_data",i){let r=[],o=this.convertToXml(n);return r.push(new File([o],"data.xml",{type:"text/plain"})),r=r.concat(this.searchImageFiles(o)),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return $o.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+LV.xml(n.toXml(),2)}searchImageFiles(n){let e=fs.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=vt.instance.get(a)}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=vt.instance.get(a));let l=o[s].getAttribute("backgroundImageIdentifier");l&&(r[l]=vt.instance.get(l))}for(let s in r){let a=r[s];a&&a.state===ci.COMPLETE&&i.push(new File([a.blob],a.identifier+"."+_c.extension(a.blob.type),{type:a.blob.type}))}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}}function BV(t,n){if(1&t&&(E(0,"option",7),W(1),P()),2&t){const e=n.$implicit;sn("value",e.identifier),k(1),ht(e.name)}}function zV(t,n){if(1&t&&(E(0,"div",14),W(1),P()),2&t){const e=G(3);k(1),Bn("",e.progresPercent,"%")}}Sr.queue=new ES("SaveDataServiceQueue"),Sr.\u0275fac=function(n){return new(n||Sr)(Ct(Gt))},Sr.\u0275prov=It({token:Sr,factory:Sr.\u0275fac,providedIn:"root"});const VV=function(t){return{"is-hidden":t}};function UV(t,n){if(1&t){const e=et();Be(0),E(1,"button",2),ue("click",function(){return Te(e),G(2).upTabIndex()}),W(2,"\u2191"),P(),E(3,"button",2),ue("click",function(){return Te(e),G(2).downTabIndex()}),W(4,"\u2193"),P(),E(5,"button",9),ue("click",function(){return Te(e),G(2).save()}),E(6,"div",10)(7,"div",11),W(8,"\u4fdd\u5b58"),P(),Q(9,zV,2,1,"div",12),P()(),E(10,"button",13),ue("click",function(){return Te(e),G(2).delete()}),W(11,"\u524a\u9664"),P(),ze()}if(2&t){const e=G(2);k(5),A("disabled",e.isSaveing),k(2),A("ngClass",Pt(4,VV,e.isSaveing)),k(2),A("ngIf",e.isSaveing),k(1),Rr("disabled",e.chatTabs.length<=1?"":null)}}function jV(t,n){if(1&t){const e=et();Be(0),E(1,"button",2),ue("click",function(){return Te(e),G(2).restore()}),W(2,"\u5143\u306b\u623b\u3059"),P(),ze()}}function HV(t,n){if(1&t){const e=et();Be(0),E(1,"div"),W(2,"\u30bf\u30d6\u540d : "),E(3,"input",8),ue("ngModelChange",function(r){return Te(e),G().tabName=r}),P()(),$e(4,"hr"),E(5,"div"),Q(6,UV,12,6,"ng-container",6),Q(7,jV,3,0,"ng-container",6),P(),ze()}if(2&t){const e=G();k(3),A("ngModel",e.tabName),Rr("disabled",e.isEditable?null:""),k(3),A("ngIf",!e.isDeleted),k(1),A("ngIf",e.isDeleted)}}function GV(t,n){1&t&&(Be(0),E(1,"div",15),W(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),P(),ze())}let $V=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Oe.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),ve.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Oe.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){ve.unregister(this)}onChangeSelectTab(e){this.selectedTab=Oe.instance.get(e),this.selectedTabXml=""}create(){zo.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,Tt.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=yn.instance.parseXml(this.selectedTabXml);zo.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}}return t.\u0275fac=function(e){return new(e||t)(ee(Di),ee(rn),ee(Va),ee(Sr))},t.\u0275cmp=Bt({type:t,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(E(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),ue("click",function(){return i.create()}),W(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),P()(),E(5,"select",3),ue("change",function(o){return i.onChangeSelectTab(o.target.value)}),Q(6,BV,2,2,"option",4),P()(),E(7,"div",5),Q(8,HV,8,4,"ng-container",6),P()(),Q(9,GV,3,0,"ng-container",6)),2&e&&(k(5),A("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),k(1),A("ngForOf",i.chatTabs),k(2),A("ngIf",!i.isEmpty&&i.selectedTab),k(1),A("ngIf",i.isEmpty))},directives:[ss,Li,Ci,Fn,zs,Vs,un,bi,yi],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})(),Wn=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(ee(qw,16))},t.\u0275pipe=ji({name:"safe",type:t,pure:!0}),t})();function WV(t,n){if(1&t&&($e(0,"img",13),Ut(1,"safe")),2&t){const e=G();A("src",jt(1,1,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Ln)}}function ZV(t,n){1&t&&wn(0)}function YV(t,n){if(1&t){const e=et();E(0,"button",15),ue("click",function(){return Te(e),G(2).discloseMessage()}),W(1,"\u7d50\u679c\u3092\u516c\u958b"),P()}}function qV(t,n){if(1&t&&(E(0,"span"),W(1),P(),Q(2,YV,2,0,"button",14)),2&t){const e=G();k(1),ht(e.chatMessage.text),k(1),A("ngIf",e.chatMessage.isSecret)}}function XV(t,n){1&t&&(E(0,"span"),W(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),P())}const KV=function(t,n,e){return{"direct-message":t,"system-message":n,"dicebot-message":e}};let QV=(()=>{class t{constructor(e){this.chatMessageService=e,this.imageFile=Qt.Empty,this.animeState="inactive"}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}}return t.\u0275fac=function(e){return new(e||t)(ee(Va))},t.\u0275cmp=Bt({type:t,selectors:[["chat-message"]],inputs:{chatMessage:"chatMessage"},decls:19,vars:16,consts:[[1,"container"],[1,"message",3,"ngClass"],[1,"image"],[3,"src",4,"ngIf"],[1,"body"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from"],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],["visible",""],["secret",""],[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,i){if(1&e&&(E(0,"div",0)(1,"div",1)(2,"div",2),Q(3,WV,2,4,"img",3),P(),E(4,"div",4)(5,"div",5)(6,"span",6),W(7),P(),E(8,"span",7),W(9),P(),E(10,"span",8),W(11),Ut(12,"date"),P()(),E(13,"div",9),Q(14,ZV,1,0,"ng-container",10),P()()()(),Q(15,qV,3,2,"ng-template",null,11,Pn),Q(17,XV,2,0,"ng-template",null,12,Pn)),2&e){const r=en(16),o=en(18);k(1),A("ngClass",ph(12,KV,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot))("@flyInOut",i.animeState),k(2),A("ngIf",0<(null==i.imageFile||null==i.imageFile.url?null:i.imageFile.url.length)),k(4),ht(i.chatMessage.name),k(2),ht(i.chatMessage.from),k(2),ht(jt(12,9,i.chatMessage.timestamp,"y/M/d H:mm")),k(3),A("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)("ngIfThen",r)("ngIfElse",o)}},directives:[yi,un],pipes:[Wn,Iw],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}"],data:{animation:[Ao("flyInOut",[Ei("* => active",[wi("200ms ease-out",uo([_t({transform:"translateX(100px)",opacity:"0",offset:0}),_t({transform:"translateX(0)",opacity:"1",offset:1})]))]),Ei("void => *",[wi("200ms ease-out",uo([_t({opacity:"0",offset:0}),_t({opacity:"1",offset:1})]))])])]}}),t})();const JV=["logContainer"],eU=["messageContainer"];function tU(t,n){1&t&&$e(0,"chat-message",7),2&t&&A("chatMessage",G().$implicit)}function nU(t,n){if(1&t&&(Be(0),Q(1,tU,1,1,"chat-message",6),ze()),2&t){const e=n.$implicit;k(1),A("ngIf",e.isDisplayable)}}function iU(t,n){if(1&t&&(Be(0),Q(1,nU,2,1,"ng-container",5),ze()),2&t){const e=G();k(1),A("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function rU(t,n){1&t&&$e(0,"chat-message",7),2&t&&A("chatMessage",n.$implicit)}function oU(t,n){if(1&t&&(Be(0),Q(1,rU,1,1,"chat-message",8),ze()),2&t){const e=G();k(1),A("ngForOf",e.sampleMessages)}}const z0=window.navigator.userAgent.toLowerCase(),xS=z0.indexOf("iphone")>-1||z0.indexOf("ipad")>-1||z0.indexOf("macintosh")>-1&&"ontouchend"in document;let sU=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.minMessageHeight=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Rt}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){let e=this.chatTab?this.chatTab.chatMessages.length:this.sampleMessages.length;return(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new lr;for(let o in i)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){r.value=i[o];continue}null==i[o]||""===i[o]||r.setAttribute(o,i[o])}e.push(r)}this.sampleMessages=e,ve.register(this).on("MESSAGE_ADDED",i=>{let r=Oe.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=Oe.instance.get(i.data.identifier);r&&r instanceof lr&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new ds(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new ds(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){ve.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Bi(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,l=null,c=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),l=s.getBoundingClientRect(),c=a.top-l.top-this.scrollSpeed,(!r||!o)&&.25<c**2&&(this.panelService.scrollablePanel.scrollTop-=c);let u=this.logContainerRef.nativeElement.getBoundingClientRect(),h=this.messageContainerRef.nativeElement.getBoundingClientRect(),g=h.top-u.top,w=g+h.height,R=this.getScrollPosition();return r=R.top<g,o=w<R.bottom&&R.bottom<R.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Bi(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,l=this.getScrollPosition();this.scrollSpeed=l.top-this.preScrollTop,this.preScrollTop=l.top;let c=l.top<r,u=o<l.bottom&&l.bottom<l.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!c&&!u)return;let h=l.top-(!e&&c?100:1200),g=l.bottom+(!e&&u?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,h,g,l,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Bi(()=>{let R=this.getScrollPosition();this.scrollSpeed=R.top-this.preScrollTop,this.preScrollTop=R.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let l=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/l)+1:r>e&&(xS||(this.topIndex+=Math.floor((r-e)/l))),i>o?xS||(this.bottomIndex-=Math.floor((i-o)/l)):i<o&&(this.bottomIndex+=Math.floor((o-i)/l)+1)}this.adjustIndex()}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(Ni),ee(rn))},t.\u0275cmp=Bt({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(Vn(JV,7),Vn(eU,7)),2&e){let r;zn(r=Un())&&(i.logContainerRef=r.first),zn(r=Un())&&(i.messageContainerRef=r.first)}},inputs:{chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[no],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage",4,"ngIf"],[3,"chatMessage"],[3,"chatMessage",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(E(0,"div",0,1)(2,"div",2,3),Q(4,iU,2,2,"ng-container",4),Q(5,oU,2,1,"ng-container",4),P()()),2&e&&(an("min-height",i.minScrollHeight,"px"),k(2),an("margin-bottom",i.bottomSpace,"px"),k(2),A("ngIf",0<i.chatMessages.length),k(1),A("ngIf",i.chatMessages.length<=0))},directives:[un,Fn,QV],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})(),TS=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Bt({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[no],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(E(0,"div",0),W(1),P()),2&e&&(A("@bounce",i.animeState),k(1),ht(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Ao("bounce",[__("active",_t({transform:""})),Ei("* => active",[wi("600ms ease",uo([_t({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),_t({transform:"scale3d(2, 2, 2)",offset:.5}),_t({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),_t({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),_t({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})(),V0=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}}return t.\u0275fac=function(e){return new(e||t)(ee(rn),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["text-view"]],inputs:{text:"text",title:"title"},decls:3,vars:1,consts:[[1,"text"]],template:function(e,i){1&e&&(E(0,"span")(1,"pre",0),W(2),P()()),2&e&&(k(2),ht(i.text))},styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})(),Yf=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Bi(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)(Ct(Gt))},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const aU=["textArea"];function lU(t,n){1&t&&($e(0,"img",15),Ut(1,"safe")),2&t&&A("src",jt(1,1,G().imageFile.url,"resourceUrl"),Ln)}function cU(t,n){if(1&t&&(E(0,"option",16),W(1),P()),2&t){const e=G();sn("value",null==e.myPeer?null:e.myPeer.identifier),k(1),Bn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function uU(t,n){if(1&t&&(E(0,"option",16),W(1),P()),2&t){const e=n.$implicit;sn("value",e.identifier),k(1),Bn("",e.name," ")}}function dU(t,n){1&t&&(Be(0),W(1,"\uff08\u3042\u306a\u305f\uff09"),ze())}function hU(t,n){if(1&t&&(E(0,"option",16),W(1),Q(2,dU,2,0,"ng-container",9),P()),2&t){const e=n.$implicit,i=G();sn("value",e.identifier),k(1),Bn("",e.name," "),k(1),A("ngIf",e===i.myPeer)}}function fU(t,n){if(1&t&&(E(0,"option",16),W(1),P()),2&t){const e=n.$implicit;sn("value",e.id),k(1),ht("DiceBot"===e.name?"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057":e.name)}}const DS=function(){return{standalone:!0}};function pU(t,n){if(1&t){const e=et();Be(0),E(1,"select",17),ue("change",function(r){return Te(e),G().loadDiceBot(r.target.value)})("ngModelChange",function(r){return Te(e),G().gameType=r}),Q(2,fU,2,2,"option",6),P(),ze()}if(2&t){const e=G();k(1),A("ngModel",e.gameType)("ngModelOptions",ma(3,DS)),k(1),A("ngForOf",e.diceBotInfos)}}function gU(t,n){1&t&&(Be(0),E(1,"select",18)(2,"option",8),W(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d..."),P()(),ze())}function mU(t,n){1&t&&(E(0,"span"),W(1,", "),P())}function _U(t,n){if(1&t&&(E(0,"span",20),W(1),Q(2,mU,2,0,"span",9),P()),2&t){const e=n.$implicit,i=n.index,r=G(2);k(1),ht(e),k(1),A("ngIf",r.writingPeerNames.length!==i+1)}}function vU(t,n){if(1&t&&(Be(0),Q(1,_U,3,2,"span",19),E(2,"span"),W(3," \u304c\u5165\u529b\u4e2d..."),P(),ze()),2&t){const e=G();k(1),A("ngForOf",e.writingPeerNames)}}const yU=function(t){return{"direct-message":t}};let SS=(()=>{class t{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Rt,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Rt,this._sendTo="",this.sendToChange=new Rt,this._text="",this.textChange=new Rt,this.chat=new Rt,this.gameHelp="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[]}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get imageFile(){let e=Oe.instance.get(this.sendFrom),i=null;return e instanceof Cn?i=e.imageFile:e instanceof kt&&(i=e.image),i||Qt.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Oe.instance.getObjects(Cn).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return go.diceBotInfos}get myPeer(){return kt.myCursor}get otherPeers(){return Oe.instance.getObjects(kt)}ngOnInit(){ve.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Oe.instance.get(e.data.messageIdentifier),r=Oe.instance.getObjects(kt).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on("UPDATE_GAME_OBJECT",e=>{if(e.data.aliasName!==Cn.aliasName||(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom))return;let i=Oe.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let i=Oe.instance.get(this.sendTo);i instanceof kt&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new ds(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.requireChangeDetection())})}ngOnDestroy(){ve.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{let i=kt.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let i=Oe.instance.get(this.sendTo);if(i instanceof kt){let r=vn.parse(i.peerId);r&&(e=r.peerId)}}ve.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode||(this.sendFrom.length||(this.sendFrom=this.myPeer.identifier),this.chat.emit({text:this.text,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight())}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),go.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}showDicebotHelp(){go.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let a of go.diceBotInfos)a.id===this.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8<"+a.name+"\uff1e");i+="\u306e\u8aac\u660e";let r=this.pointerDeviceService.pointers[0],s=this.panelService.open(V0,{left:r.x,top:r.y,width:600,height:500});s.title=i,s.text="\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u30002R6[>3]>=5 \uff1a2D6\u306e\u30c0\u30a4\u30b9\u76ee\u304c3\u3088\u308a\u5927\u304d\u3044\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3066\u30015\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000c(10-4*3/2+2)\uff1ac(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u7aef\u6570\u51e6\u7406\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2C\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3001\u5207\u308a\u6368\u3066\u306f /2F\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66A\uff1a\u6607\u9806\u3001D66D\uff1a\u964d\u9806\n\n\u8a73\u7d30\u306f\u4e0b\u8a18URL\u306e\u30b3\u30de\u30f3\u30c9\u30ac\u30a4\u30c9\u3092\u53c2\u7167\nhttps://docs.bcdice.org/\n===================================\n"+this.gameHelp})}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const i of He.peerContexts)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(Va),ee(Yf),ee(rn),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&Vn(aU,7),2&e){let r;zn(r=Un())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:25,vars:16,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell"],[2,"width","12em",3,"ngModel","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[2,"width","10em",3,"ngModel","ngModelChange"],["value",""],[4,"ngIf"],[3,"disabled","click"],["placeholder","Enter\u3067\u9001\u4fe1  Shift+Enter\u3067\u6539\u884c",1,"chat-input",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[1,"image",3,"src"],[3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","change","ngModelChange"],["disabled","",2,"width","12em"],["style","font-weight: bold;",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,i){1&e&&(E(0,"div",0)(1,"div",1),Q(2,lU,2,4,"img",2),P(),E(3,"div",3)(4,"div")(5,"select",4),ue("ngModelChange",function(o){return i.sendFrom=o}),Q(6,cU,2,2,"option",5),Q(7,uU,2,2,"option",6),P(),W(8," \uff1e "),E(9,"select",7),ue("ngModelChange",function(o){return i.sendTo=o}),E(10,"option",8),W(11,"\u5168\u54e1"),P(),Q(12,hU,3,3,"option",6),P(),Q(13,pU,3,4,"ng-container",9),Q(14,gU,4,0,"ng-container",9),E(15,"button",10),ue("click",function(){return i.showDicebotHelp()}),W(16,"?"),P()(),E(17,"div")(18,"form")(19,"textarea",11,12),ue("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)}),P(),E(21,"button",13),ue("click",function(){return i.sendChat(null)}),W(22,"SEND"),P()()(),E(23,"div",14),Q(24,vU,4,1,"ng-container",9),P()()()),2&e&&(A("ngClass",Pt(13,yU,i.isDirect)),k(2),A("ngIf",0<i.imageFile.url.length),k(3),A("ngModel",i.sendFrom),k(1),A("ngIf",!i.onlyCharacters),k(1),A("ngForOf",i.gameCharacters),k(2),A("ngModel",i.sendTo),k(3),A("ngForOf",i.otherPeers),k(1),A("ngIf",0<i.diceBotInfos.length),k(1),A("ngIf",i.diceBotInfos.length<1),k(1),A("disabled",i.diceBotInfos.length<1),k(4),A("ngModel",i.text)("ngModelOptions",ma(15,DS)),k(5),A("ngIf",0<i.writingPeerNames.length))},directives:[yi,un,ss,Li,Ci,zs,Vs,Fn,Kl,ql,Ls,bi],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}"]}),t})();function bU(t,n){if(1&t){const e=et();E(0,"chat-tab",10),ue("onAddMessage",function(){return Te(e),G().scrollToBottom()}),P()}2&t&&A("chatTab",G().chatTab)}function CU(t,n){1&t&&(E(0,"div"),W(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),P())}function wU(t,n){1&t&&$e(0,"badge",13),2&t&&A("count",G().$implicit.unreadLength)}function EU(t,n){if(1&t){const e=et();E(0,"label")(1,"input",11),ue("ngModelChange",function(r){return Te(e),G().chatTabidentifier=r}),P(),E(2,"div"),W(3),Q(4,wU,1,1,"badge",12),P()()}if(2&t){const e=n.$implicit,i=G();k(1),sn("value",e.identifier),A("ngModel",i.chatTabidentifier),k(2),ht(e.name),k(1),A("ngIf",e.hasUnread)}}let MS=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return Oe.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=kt.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",ve.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Oe.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){ve.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open($V,{left:e.x-250,top:e.y-175,width:500,height:350}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo)}trackByChatTab(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(ee(Va),ee(rn),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["chat-window"]],decls:13,vars:7,consts:[[1,"component"],[1,"log"],[3,"chatTab","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","onAddMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(E(0,"div",0)(1,"div",1),Q(2,bU,1,1,"chat-tab",2),Q(3,CU,2,0,"div",3),P(),E(4,"div",4)(5,"form")(6,"div",5),Q(7,EU,5,4,"label",6),E(8,"button",7),ue("click",function(){return i.showTabSetting()}),E(9,"i",8),W(10,"settings"),P(),W(11,"\u30bf\u30d6\u8a2d\u5b9a"),P()()(),E(12,"chat-input",9),ue("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)}),P()()()),2&e&&(k(2),A("ngIf",i.chatTab),k(1),A("ngIf",!i.chatTab),k(4),A("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),k(5),A("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},directives:[un,sU,Kl,ql,Ls,Fn,Tu,bi,Li,Ci,TS,SS],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),t})();const xU=["root"];function TU(t,n){if(1&t&&(E(0,"div",6),W(1),P()),2&t){const e=G();k(1),ht(e.title)}}function DU(t,n){1&t&&wn(0)}const SU=function(t){return{action:t}};function MU(t,n){if(1&t&&(Be(0),Q(1,DU,1,0,"ng-container",7),ze()),2&t){const e=n.$implicit;G();const i=en(8),r=en(6);k(1),A("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",Pt(2,SU,e))}}function kU(t,n){1&t&&(E(0,"div",12)(1,"i",13),W(2,"arrow_forward_ios"),P()())}function AU(t,n){if(1&t&&$e(0,"context-menu",14),2&t){const e=G().action,i=G();A("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function IU(t,n){if(1&t){const e=et();E(0,"li",8),ue("click",function(){const o=Te(e).action;return G().doAction(o)})("mouseenter",function(){const o=Te(e).action;return G().showSubMenu(o)}),E(1,"div",9),W(2),P(),Q(3,kU,3,0,"div",10),Q(4,AU,1,3,"context-menu",11),P()}if(2&t){const e=n.action,i=G();k(2),ht(e.name),k(1),A("ngIf",e.subActions),k(1),A("ngIf",i.subMenu&&i.parentMenu===e)}}function OU(t,n){1&t&&(E(0,"li"),$e(1,"hr",15),P())}const PU=function(t,n,e){return{"submenu-panel":t,"is-max-limit":n,"pointer-events-none":e}};let FU=(()=>{class t{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(ee(On),ee(ur),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&Vn(xU,7),2&e){let r;zn(r=Un())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&ue("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",isSubmenu:"isSubmenu"},decls:9,vars:7,consts:[[1,"component",3,"ngClass","mouseleave"],["root",""],["class","title",4,"ngIf"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hasHighlight",3,"click","mouseenter"],[1,"menu-title"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(E(0,"div",0,1),ue("mouseleave",function(){return i.hideSubMenu()}),Q(2,TU,2,1,"div",2),E(3,"ul"),Q(4,MU,2,4,"ng-container",3),P()(),Q(5,IU,5,3,"ng-template",null,4,Pn),Q(7,OU,2,0,"ng-template",null,5,Pn)),2&e&&(A("ngClass",ph(3,PU,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),k(2),A("ngIf",0<i.title.length),k(2),A("ngForOf",i.actions))},directives:[yi,un,Fn,vu,t],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}"]}),t})();function NU(t,n){if(1&t){const e=et();E(0,"img",9),ue("click",function(){Te(e);const r=G().$implicit;return G().onSelectedFile(r)}),Ut(1,"safe"),P()}if(2&t){const e=G().$implicit;A("src",jt(1,2,e.url,"resourceUrl"),Ln)("alt",e.name)}}function RU(t,n){1&t&&$e(0,"img",10),2&t&&sn("alt",G().$implicit.name)}function LU(t,n){if(1&t&&(E(0,"span",6),Q(1,NU,2,5,"img",7),Q(2,RU,1,1,"img",8),P()),2&t){const e=n.$implicit;k(1),A("ngIf",0<e.url.length),k(1),A("ngIf",e.url.length<=0)}}let BU=(()=>{class t{constructor(e,i){this.changeDetector=e,this.panelService=i,this.fileStorageService=vt.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){ve.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){ve.unregister(this)}handleFileSelect(e){let i=e.target,r=i.files;r.length&&$o.instance.load(r),i.value=""}onSelectedFile(e){console.log("onSelectedFile",e),ve.call("SELECT_FILE",{fileIdentifier:e.identifier},He.peerId)}}return t.\u0275fac=function(e){return new(e||t)(ee(Ni),ee(rn))},t.\u0275cmp=Bt({type:t,selectors:[["file-storage"]],decls:15,vars:1,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],["id","file-list"],["class","image",4,"ngFor","ngForOf"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(E(0,"label")(1,"div",0)(2,"div")(3,"i",1),W(4,"add_photo_alternate"),P()(),E(5,"div"),W(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),P(),E(7,"div",2),W(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),P(),E(9,"input",3),ue("change",function(o){return i.handleFileSelect(o)}),P(),E(10,"div",2),$e(11,"br"),W(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),P()()(),E(13,"div",4),Q(14,LU,3,2,"span",5),P()),2&e&&(k(14),A("ngForOf",i.fileStorageService.images))},directives:[Fn,un],pipes:[Wn],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}'],changeDetection:0}),t})();function zU(t,n){if(1&t){const e=et();E(0,"span",3)(1,"button",4),ue("click",function(){Te(e);const r=G();return r.onSelectedFile(r.empty)}),W(2,"\u753b\u50cf\u306a\u3057"),P()()}}function VU(t,n){if(1&t){const e=et();E(0,"img",8),ue("click",function(){Te(e);const r=G().$implicit;return G().onSelectedFile(r)}),Ut(1,"safe"),P()}if(2&t){const e=G().$implicit;A("src",jt(1,2,e.url,"resourceUrl"),Ln)("alt",e.name)}}function UU(t,n){1&t&&$e(0,"img",9),2&t&&sn("alt",G().$implicit.name)}function jU(t,n){if(1&t&&(E(0,"span",5),Q(1,VU,2,5,"img",6),Q(2,UU,1,1,"img",7),P()),2&t){const e=n.$implicit;k(1),A("ngIf",0<e.url.length),k(1),A("ngIf",e.url.length<=0)}}let id=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}get images(){return vt.instance.images}get empty(){return Qt.Empty}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){ve.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){ve.unregister(this)}onSelectedFile(e){ve.call("SELECT_FILE",{fileIdentifier:e.identifier},He.peerId),this.modalService.resolve(e.identifier)}}return t.\u0275fac=function(e){return new(e||t)(ee(Ni),ee(rn),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:3,vars:2,consts:[["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],[1,"empty"],[3,"click"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","./assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","./assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(E(0,"div",0),Q(1,zU,3,0,"span",1),Q(2,jU,3,2,"span",2),P()),2&e&&(k(1),A("ngIf",i.isAllowedEmpty),k(1),A("ngForOf",i.images))},directives:[un,Fn],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}"],changeDetection:0}),t})(),HU=(()=>{class t{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Qt.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),ve.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=vt.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){ve.unregister(this)}createGameCharacter(){Cn.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=Ho.instance.viewTable;if(!e)return;let i=po.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){yn.instance.parseXml(e)}openModal(){this.modalService.open(id)}}return t.\u0275fac=function(e){return new(e||t)(ee(Zi),ee(Di),ee(rn))},t.\u0275cmp=Bt({type:t,selectors:[["game-character-generator"]],decls:15,vars:11,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(E(0,"button",0),ue("click",function(){return i.openModal()}),W(1,"\u753b\u50cf\u3092\u9078\u3076"),P(),E(2,"div"),$e(3,"img",1),Ut(4,"safe"),P(),E(5,"input",2),ue("ngModelChange",function(o){return i.name=o}),P(),E(6,"div")(7,"div")(8,"input",3),ue("ngModelChange",function(o){return i.size=o}),P(),W(9," Size : "),E(10,"input",4),ue("ngModelChange",function(o){return i.size=o}),P()(),E(11,"button",0),ue("click",function(){return i.createGameCharacter()}),W(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),P(),E(13,"button",0),ue("click",function(){return i.createGameTableMask()}),W(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),P()()),2&e&&(k(3),A("src",jt(4,8,i.tableBackgroundImage.url,"resourceUrl"),Ln),k(2),A("ngModel",i.name),k(3),sn("min",i.minSize),sn("max",i.maxSize),A("ngModel",i.size),k(2),sn("min",i.minSize),sn("max",i.maxSize),A("ngModel",i.size))},directives:[bi,Li,Ci,Bs,Ea,Zh,Wh],pipes:[Wn],styles:[""]}),t})();function GU(t,n){1&t&&wn(0)}function $U(t,n){if(1&t){const e=et();E(0,"div",3),Q(1,GU,1,0,"ng-container",8),E(2,"select",9),ue("change",function(r){return Te(e),G(3).setElementType(r.target.value)}),E(3,"option",10),W(4,"\u901a\u5e38"),P(),E(5,"option",11),W(6,"\u30ea\u30bd\u30fc\u30b9"),P(),E(7,"option",12),W(8,"\u30ce\u30fc\u30c8"),P()()()}if(2&t){const e=G(3),i=en(2);k(1),A("ngTemplateOutlet",i),k(1),A("ngModel",e.gameDataElement.type)}}function WU(t,n){if(1&t&&(Be(0),E(1,"div",13),W(2),P(),ze()),2&t){const e=G(3);k(2),ht(e.name)}}function ZU(t,n){if(1&t){const e=et();Be(0),E(1,"div",14),W(2),P(),E(3,"input",15),ue("ngModelChange",function(r){return Te(e),G(3).name=r}),P(),ze()}if(2&t){const e=G(3);k(2),ht(e.name),k(1),A("ngModel",e.name)}}function YU(t,n){if(1&t){const e=et();Be(0),E(1,"input",16),ue("ngModelChange",function(r){return Te(e),G(3).currentValue=r}),Ut(2,"safe"),P(),$e(3,"br"),E(4,"input",17),ue("ngModelChange",function(r){return Te(e),G(3).currentValue=r}),P(),W(5," / "),E(6,"input",18),ue("ngModelChange",function(r){return Te(e),G(3).value=r}),P(),ze()}if(2&t){const e=G(3);k(1),wr(jt(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),sn("max",e.value),A("ngModel",e.currentValue),k(3),A("ngModel",e.currentValue),k(2),A("ngModel",e.value)}}function qU(t,n){if(1&t){const e=et();Be(0),E(1,"textarea",19),ue("ngModelChange",function(r){return Te(e),G(3).value=r}),P(),ze()}if(2&t){const e=G(3);k(1),A("ngModel",e.value)}}function XU(t,n){if(1&t){const e=et();Be(0),E(1,"div",20),W(2),P(),E(3,"input",21),ue("ngModelChange",function(r){return Te(e),G(3).value=r}),P(),ze()}if(2&t){const e=G(3);k(2),ht(e.value),k(1),A("ngModel",e.value)}}function KU(t,n){if(1&t&&(Be(0),Q(1,$U,9,2,"div",2),E(2,"div",3),Q(3,WU,3,1,"ng-container",0),Q(4,ZU,4,2,"ng-container",0),P(),E(5,"div",4),Be(6,5),Q(7,YU,7,9,"ng-container",6),Q(8,qU,2,1,"ng-container",6),Q(9,XU,4,2,"ng-container",7),ze(),P(),ze()),2&t){const e=G(2);k(1),A("ngIf",e.isEdit),k(2),A("ngIf",e.isTagLocked),k(1),A("ngIf",!e.isTagLocked),k(2),A("ngSwitch",e.gameDataElement.type),k(1),A("ngSwitchCase","numberResource"),k(1),A("ngSwitchCase","note")}}function QU(t,n){1&t&&wn(0)}function JU(t,n){if(1&t&&(E(0,"div",27),Q(1,QU,1,0,"ng-container",8),P()),2&t){G(3);const e=en(2);k(1),A("ngTemplateOutlet",e)}}function ej(t,n){if(1&t&&(Be(0),E(1,"div",28),W(2),P(),ze()),2&t){const e=G(3);k(2),ht(e.name)}}function tj(t,n){if(1&t){const e=et();Be(0),E(1,"input",29),ue("ngModelChange",function(r){return Te(e),G(3).name=r}),P(),ze()}if(2&t){const e=G(3);k(1),A("ngModel",e.name)}}function nj(t,n){if(1&t&&$e(0,"div",32),2&t){const e=n.$implicit,i=G(4);A("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function ij(t,n){if(1&t&&(E(0,"div",30),Q(1,nj,1,3,"div",31),P()),2&t){const e=G(3);k(1),A("ngForOf",e.gameDataElement.children)}}function rj(t,n){if(1&t&&(Be(0),Q(1,JU,2,1,"div",22),$e(2,"div",23),E(3,"div",24)(4,"div",25),Q(5,ej,3,1,"ng-container",0),Q(6,tj,2,1,"ng-container",0),P(),Q(7,ij,2,1,"div",26),P(),ze()),2&t){const e=G(2);k(1),A("ngIf",e.isEdit),k(4),A("ngIf",e.isTagLocked),k(1),A("ngIf",!e.isTagLocked),k(1),A("ngIf",0<e.gameDataElement.children.length)}}function oj(t,n){if(1&t&&(Be(0),Q(1,KU,10,6,"ng-container",0),Q(2,rj,8,4,"ng-container",0),ze()),2&t){const e=G();k(1),A("ngIf",e.gameDataElement.children.length<1),k(1),A("ngIf",0<e.gameDataElement.children.length)}}function sj(t,n){if(1&t){const e=et();E(0,"button",33),ue("click",function(){return Te(e),G().addElement()}),E(1,"i",34),W(2,"add_circle"),P()(),E(3,"button",33),ue("click",function(){return Te(e),G().upElement()}),E(4,"i",34),W(5,"arrow_upward"),P()(),$e(6,"br"),E(7,"button",33),ue("click",function(){return Te(e),G().deleteElement()}),E(8,"i",34),W(9,"remove_circle_outline"),P()(),E(10,"button",33),ue("click",function(){return Te(e),G().downElement()}),E(11,"i",34),W(12,"arrow_downward"),P()()}}let aj=(()=>{class t{constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),ve.register(this).on("UPDATE_GAME_OBJECT",e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){ve.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(it.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(ee(Ni))},t.\u0275cmp=Bt({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","numberResource"],["value","note"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","max","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModel","ngModelChange"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","ngModelChange"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Value",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Q(0,oj,3,2,"ng-container",0),Q(1,sj,13,0,"ng-template",null,1,Pn)),2&e&&A("ngIf",i.gameDataElement)},directives:[un,vu,ss,Li,Ci,zs,Vs,bi,ba,mu,Bs,Ea,_u,Fn,t],pipes:[Wn],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],changeDetection:0}),t})();function lj(t,n){1&t&&wn(0)}function cj(t,n){if(1&t){const e=et();Be(0),E(1,"button",0),ue("click",function(){return Te(e),G().openModal("front")}),W(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),E(3,"button",0),ue("click",function(){return Te(e),G().openModal("back")}),W(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),ze()}}function uj(t,n){1&t&&wn(0)}function dj(t,n){if(1&t){const e=et();Be(0),E(1,"button",0),ue("click",function(){return Te(e),G().openModal("floor")}),W(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),E(3,"button",0),ue("click",function(){return Te(e),G().openModal("wall")}),W(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),ze()}}function hj(t,n){if(1&t){const e=et();Be(0),E(1,"button",4),ue("click",function(){Te(e);const r=G();return r.openModal(r.tabletopObject.face)}),W(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),ze()}if(2&t){const e=G();k(1),A("disabled",!e.tabletopObject.isVisible)}}function fj(t,n){if(1&t){const e=et();Be(0),E(1,"button",0),ue("click",function(){return Te(e),G().openModal("imageIdentifier",!0)}),W(2,"\u753b\u50cf\u5909\u66f4"),P(),ze()}}function pj(t,n){if(1&t&&(E(0,"div",10),W(1),P()),2&t){const e=G();k(1),Bn("",e.progresPercent,"%")}}function gj(t,n){if(1&t){const e=et();E(0,"select",12),ue("change",function(r){return Te(e),G(2).setLocation(r.target.value)}),E(1,"option",13),W(2,"\u30c6\u30fc\u30d6\u30eb"),P(),E(3,"option",14),W(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),P(),E(5,"option",15),W(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),P(),E(7,"option",16),W(8,"\u5893\u5730"),P()()}if(2&t){const e=G(2);A("ngModel",e.tabletopObject.location.name),k(5),sn("value",e.networkService.peerId)}}function mj(t,n){if(1&t&&(Be(0),Q(1,gj,9,2,"select",11),ze()),2&t){const e=G();k(1),A("ngIf",e.tabletopObject)}}function _j(t,n){if(1&t&&(E(0,"div",19),$e(1,"img",20),Ut(2,"safe"),P()),2&t){const e=G(2);k(1),A("src",jt(2,2,e.tabletopObject.imageFile.url,"resourceUrl"),Ln)("alt",e.tabletopObject.imageFile.name)}}function vj(t,n){if(1&t&&(Be(0),E(1,"div",21)(2,"div",22),$e(3,"div",23),P()(),ze()),2&t){const e=G(2);k(3),A("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0)}}function yj(t,n){if(1&t&&(E(0,"div",21)(1,"div",22),$e(2,"div",25),P()()),2&t){const e=n.$implicit,i=G(3);k(2),A("gameDataElement",e)("isEdit",i.isEdit)}}function bj(t,n){if(1&t&&(Be(0),Q(1,yj,3,2,"div",24),ze()),2&t){const e=G(2);k(1),A("ngForOf",e.tabletopObject.detailDataElement.children)}}function Cj(t,n){if(1&t){const e=et();Be(0),E(1,"div",21)(2,"button",26),ue("click",function(){return Te(e),G(2).addDataElement()}),W(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),P()(),ze()}}function wj(t,n){if(1&t&&(E(0,"div",17),Q(1,_j,3,5,"div",18),Q(2,vj,4,2,"ng-container",8),Q(3,bj,2,1,"ng-container",8),Q(4,Cj,4,0,"ng-container",8),P()),2&t){const e=G();k(1),A("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)),k(1),A("ngIf",e.tabletopObject.commonDataElement),k(1),A("ngIf",e.tabletopObject.detailDataElement),k(1),A("ngIf",e.isEdit)}}const Ej=function(t){return{"is-hidden":t}};let Wo=(()=>{class t{constructor(e,i,r){this.saveDataService=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.isEdit=!1,this.networkService=He,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){ve.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngAfterViewInit(){}ngOnDestroy(){ve.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=it.create("\u898b\u51fa\u3057","",{}),i=it.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":We.play(Me.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,We.play(Me.cardPut);break;case"text-note":e.toTopmost(),We.play(Me.cardPut);break;case"dice-symbol":We.play(Me.dicePut);default:We.play(Me.piecePut)}}saveToXML(){var e=this;return(0,Tt.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObject.commonDataElement.getFirstElementByName("name"),r=i?i.value:"";yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"xml_"+r,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){this.tabletopObject.setLocation(e)}openModal(e="",i=!1){this.modalService.open(id,{isAllowedEmpty:i}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);!o||(o.value=r)})}}return t.\u0275fac=function(e){return new(e||t)(ee(Sr),ee(rn),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:18,vars:13,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"main-image",3,"src","alt"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(E(0,"button",0),ue("click",function(){return i.toggleEditMode()}),W(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),P(),Be(2,1),Q(3,lj,1,0,"ng-container",2),Q(4,cj,5,0,"ng-container",2),Q(5,uj,1,0,"ng-container",2),Q(6,dj,5,0,"ng-container",2),Q(7,hj,3,1,"ng-container",2),Q(8,fj,3,0,"ng-container",3),ze(),E(9,"button",0),ue("click",function(){return i.clone()}),W(10,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),P(),E(11,"button",4),ue("click",function(){return i.saveToXML()}),E(12,"div",5)(13,"div",6),W(14,"\u4fdd\u5b58"),P(),Q(15,pj,2,1,"div",7),P()(),Q(16,mj,2,1,"ng-container",8),Q(17,wj,5,4,"div",9)),2&e&&(k(2),A("ngSwitch",i.tabletopObject.aliasName),k(1),A("ngSwitchCase","numberResource"),k(1),A("ngSwitchCase","card"),k(1),A("ngSwitchCase","card-stack"),k(1),A("ngSwitchCase","terrain"),k(1),A("ngSwitchCase","dice-symbol"),k(4),A("disabled",i.isSaveing),k(2),A("ngClass",Pt(11,Ej,i.isSaveing)),k(2),A("ngIf",i.isSaveing),k(1),A("ngIf","character"===i.tabletopObject.aliasName),k(1),A("ngIf",i.tabletopObject))},directives:[ba,mu,_u,yi,un,ss,Li,Ci,zs,Vs,aj,Fn],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px}.main-image[_ngcontent-%COMP%]{width:250px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();const xj=["chatInput"],Tj=["chatPlette"];function Dj(t,n){1&t&&$e(0,"badge",12),2&t&&A("count",G().$implicit.unreadLength)}function Sj(t,n){if(1&t){const e=et();E(0,"label")(1,"input",10),ue("ngModelChange",function(r){return Te(e),G().chatTabidentifier=r}),P(),E(2,"div"),W(3),Q(4,Dj,1,1,"badge",11),P()()}if(2&t){const e=n.$implicit,i=G();k(1),sn("value",e.identifier),A("ngModel",i.chatTabidentifier),k(2),ht(e.name),k(1),A("ngIf",e.hasUnread)}}function Mj(t,n){1&t&&(E(0,"div",13)(1,"i",14),W(2,"info_outline"),P(),W(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),P())}function kj(t,n){if(1&t&&(E(0,"option",19),W(1),P()),2&t){const e=n.$implicit;sn("value",e),k(1),ht(e)}}function Aj(t,n){if(1&t&&(Be(0),Q(1,kj,2,2,"option",18),ze()),2&t){const e=G(2);k(1),A("ngForOf",e.palette.getPalette())}}function Ij(t,n){if(1&t){const e=et();E(0,"div",15)(1,"select",16,17),ue("input",function(r){return Te(e),G().selectPalette(r.target.value)})("click",function(r){return Te(e),G().clickPalette(r.target.value)}),Q(3,Aj,2,1,"ng-container",9),P()()}if(2&t){const e=G();k(3),A("ngIf",e.palette)}}function Oj(t,n){if(1&t){const e=et();E(0,"div",15)(1,"textarea",20),ue("ngModelChange",function(r){return Te(e),G().editPalette=r}),P()()}if(2&t){const e=G();k(1),A("ngModel",e.editPalette)}}function Pj(t,n){1&t&&(E(0,"span"),W(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),P())}function Fj(t,n){1&t&&(E(0,"span"),W(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),P())}let kS=(()=>{class t{constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.doubleClickTimer=null}get palette(){return this.character.chatPalette}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return go.diceBotInfos}get chatTab(){return Oe.instance.get(this.chatTabidentifier)}get myPeer(){return kt.myCursor}get otherPeers(){return Oe.instance.getObjects(kt)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",ve.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){ve.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Oe.instance.get(e);if(i instanceof Cn){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){this.doubleClickTimer&&this.text===e?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.text=e,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo)}}resetPletteSelect(){!this.chatPletteElementRef.nativeElement||(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}}return t.\u0275fac=function(e){return new(e||t)(ee(Va),ee(rn))},t.\u0275cmp=Bt({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(Vn(xj,7),Vn(Tj,5)),2&e){let r;zn(r=Un())&&(i.chatInputComponent=r.first),zn(r=Un())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(E(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),Q(4,Sj,5,4,"label",3),P()(),E(5,"chat-input",4,5),ue("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)}),P(),Q(7,Mj,4,0,"div",6),P(),Q(8,Ij,4,1,"div",7),Q(9,Oj,2,1,"div",7),E(10,"div",1)(11,"button",8),ue("click",function(){return i.toggleEditMode()}),Q(12,Pj,2,0,"span",9),Q(13,Fj,2,0,"span",9),P()()()),2&e&&(k(4),A("ngForOf",i.chatMessageService.chatTabs),k(1),A("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),k(2),A("ngIf",i.isEdit),k(1),A("ngIf",!i.isEdit),k(1),A("ngIf",i.isEdit),k(3),A("ngIf",!i.isEdit),k(1),A("ngIf",i.isEdit))},directives:[Kl,ql,Ls,Fn,Tu,bi,Li,Ci,un,TS,SS,zs,Vs],styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}"]}),t})();function Nj(t,n){1&t&&wn(0)}function Rj(t,n){1&t&&wn(0)}function Lj(t,n){if(1&t&&(E(0,"div"),W(1),P()),2&t){const e=G();k(1),Bn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function Bj(t,n){1&t&&wn(0)}const zj=function(t){return{box:!0,selected:t}},Vj=function(t){return{gameObject:t}};function Uj(t,n){if(1&t){const e=et();E(0,"div",9),ue("contextmenu",function(r){const s=Te(e).$implicit;return G().onContextMenu(r,s)})("click",function(){const o=Te(e).$implicit;return G().selectGameObject(o)}),Q(1,Bj,1,0,"ng-container",10),P()}if(2&t){const e=n.$implicit,i=G(),r=en(11);A("ngClass",Pt(3,zj,i.selectedIdentifier===e.identifier)),k(1),A("ngTemplateOutlet",r)("ngTemplateOutletContext",Pt(5,Vj,e))}}function jj(t,n){if(1&t){const e=et();E(0,"div",11)(1,"button",12),ue("click",function(){return Te(e),G().cleanInventory()}),W(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),P()()}if(2&t){const e=G();k(1),Rr("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function Hj(t,n){if(1&t){const e=et();E(0,"label")(1,"input",16),ue("ngModelChange",function(r){return Te(e),G(2).selectTab=r}),P(),E(2,"div"),W(3),P()()}if(2&t){const e=n.$implicit,i=G(2);k(1),sn("value",e),A("ngModel",i.selectTab),k(2),jl("",i.getTabTitle(e)," (",i.getInventory(e).length,")")}}function Gj(t,n){if(1&t&&(E(0,"form",13)(1,"div",14),Q(2,Hj,4,4,"label",15),P()()),2&t){const e=G();k(2),A("ngForOf",e.inventoryTypes)}}function $j(t,n){if(1&t){const e=et();Be(0),E(1,"div")(2,"div",17),W(3,"\u4e26\u3073\u9806"),P(),E(4,"input",18),ue("ngModelChange",function(r){return Te(e),G(2).sortTag=r}),P(),E(5,"select",19),ue("ngModelChange",function(r){return Te(e),G(2).sortOrder=r}),E(6,"option",20),W(7,"\u6607\u9806"),P(),E(8,"option",21),W(9,"\u964d\u9806"),P()()(),E(10,"div",22),W(11,"\u8868\u793a\u9805\u76ee"),P(),E(12,"input",23),ue("ngModelChange",function(r){return Te(e),G(2).dataTag=r}),P(),E(13,"div",11)(14,"button",24),ue("click",function(){return Te(e),G(2).toggleEdit()}),E(15,"i",25),W(16,"settings"),P(),W(17,"\u5b8c\u4e86"),P()(),ze()}if(2&t){const e=G(2);k(4),A("ngModel",e.sortTag),k(1),A("ngModel",e.sortOrder),k(7),A("ngModel",e.dataTag)}}function Wj(t,n){if(1&t&&(Be(0),W(1),ze()),2&t){const e=G(3);k(1),jl("",e.sortTag," (",e.sortOrderName,")")}}function Zj(t,n){1&t&&(Be(0),W(1,"-"),ze())}function Yj(t,n){if(1&t){const e=et();Be(0),E(1,"table",26)(2,"tr")(3,"th",27),W(4,"\u4e26\u3073\u9806:"),P(),E(5,"td",27),Q(6,Wj,2,2,"ng-container",2),Q(7,Zj,2,0,"ng-container",2),P(),E(8,"td")(9,"button",24),ue("click",function(){return Te(e),G(2).toggleEdit()}),E(10,"i",25),W(11,"settings"),P(),W(12,"\u8a2d\u5b9a"),P()()()(),ze()}if(2&t){const e=G(2);k(6),A("ngIf",0<e.sortTag.length),k(1),A("ngIf",e.sortTag.length<1)}}function qj(t,n){if(1&t&&(Q(0,$j,18,3,"ng-container",2),Q(1,Yj,13,2,"ng-container",2)),2&t){const e=G();A("ngIf",e.isEdit),k(1),A("ngIf",!e.isEdit)}}function Xj(t,n){if(1&t){const e=et();E(0,"button",35),ue("click",function(r){Te(e);const o=G().gameObject;return G().onContextMenu(r,o)}),E(1,"i",36),W(2,"settings"),P()()}}function Kj(t,n){1&t&&($e(0,"img",37),Ut(1,"safe")),2&t&&A("src",jt(1,1,G().gameObject.imageFile.url,"resourceUrl"),Ln)}function Qj(t,n){1&t&&wn(0)}const Jj=function(t){return{dataElm:t}};function eH(t,n){if(1&t&&(Be(0),Q(1,Qj,1,0,"ng-container",10),ze()),2&t){const e=n.$implicit;G(3);const i=en(13);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,Jj,e))}}function tH(t,n){if(1&t&&(E(0,"div"),Q(1,eH,2,4,"ng-container",38),P()),2&t){const e=G().gameObject,i=G();k(1),A("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function nH(t,n){if(1&t&&(E(0,"div",28)(1,"div",29),W(2),Q(3,Xj,3,0,"button",30),P(),E(4,"div",31)(5,"div",32),Q(6,Kj,2,4,"img",33),P(),E(7,"div",34),Q(8,tH,2,2,"div",2),P()()()),2&t){const e=n.gameObject,i=G();k(2),Bn("",e.name," "),k(1),A("ngIf",i.selectedIdentifier===e.identifier),k(3),A("ngIf",e.imageFile.url),k(2),A("ngIf",e.rootDataElement)}}function iH(t,n){1&t&&(Be(0),$e(1,"br"),ze())}function rH(t,n){if(1&t){const e=et();Be(0),E(1,"div",44)(2,"div",45),W(3),P(),E(4,"input",46),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.currentValue=r}),P()(),E(5,"div",44)(6,"input",47),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.currentValue=r}),Ut(7,"safe"),P()(),ze()}if(2&t){const e=G(2).dataElm;k(3),ht(e.name),k(1),A("ngModel",e.currentValue),k(2),wr(jt(7,6,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),sn("max",e.value),A("ngModel",e.currentValue)}}function oH(t,n){if(1&t){const e=et();Be(0),E(1,"div",48),W(2),P(),E(3,"div",49)(4,"div",50)(5,"div",51)(6,"div",52),W(7),P(),E(8,"input",53),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.value=r}),P()()()(),ze()}if(2&t){const e=G(2).dataElm;k(2),ht(e.name),k(5),ht(e.value),k(1),A("ngModel",e.value)}}function sH(t,n){if(1&t&&(E(0,"div",40),Be(1,41),Q(2,rH,8,9,"ng-container",42),Q(3,oH,9,3,"ng-container",43),ze(),P()),2&t){const e=G().dataElm;k(1),A("ngSwitch",e.attributes.type),k(1),A("ngSwitchCase","numberResource")}}function aH(t,n){if(1&t&&(Q(0,iH,2,0,"ng-container",2),Q(1,sH,4,2,"div",39)),2&t){const e=n.dataElm,i=G();A("ngIf",(null==e?null:e.name)===i.newLineString),k(1),A("ngIf",e&&e.name!==i.newLineString)}}let lH=(()=>{class t{constructor(e,i,r,o,s){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===td.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ve.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Oe.instance.get(e.data.identifier)instanceof cr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",He.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=He.peerId)}),this.inventoryTypes=["table","common",He.peerId,"graveyard"]}ngAfterViewInit(){}ngOnDestroy(){ve.unregister(this)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case He.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case He.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],o=[];o.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),"graveyard"!==i.location.name&&o.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)}}),o.push(Kn);let s=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:He.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let a of s)i.location.name!==a.name&&o.push({name:a.alias,action:()=>{i.setLocation(a.name),We.play(Me.piecePut)}});"graveyard"===i.location.name&&o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(i),We.play(Me.sweep)}}),o.push(Kn),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),We.play(Me.piecePut)}}),this.contextMenuService.open(r,o,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${i.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const r of i)this.deleteGameObject(r);We.play(Me.sweep)}}cloneGameObject(e){e.clone()}showDetail(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(kS,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}selectGameObject(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}trackByGameObject(e,i){return i?i.identifier:e}}return t.\u0275fac=function(e){return new(e||t)(ee(Ni),ee(rn),ee(N0),ee(ur),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],[1,"inventory-object"],[1,"object-name"],["style","font-size: 0.8em; padding: 2px 5px;",3,"click",4,"ngIf"],[1,"object-tags-box"],[1,"table-cell","image-box"],[3,"src",4,"ngIf"],[1,"table-cell"],[2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value",3,"ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(E(0,"div",0),Q(1,Nj,1,0,"ng-container",1),Q(2,Rj,1,0,"ng-container",1),Q(3,Lj,2,1,"div",2),Q(4,Uj,2,7,"div",3),Q(5,jj,3,1,"div",4),P(),Q(6,Gj,3,1,"ng-template",null,5,Pn),Q(8,qj,2,2,"ng-template",null,6,Pn),Q(10,nH,9,4,"ng-template",null,7,Pn),Q(12,aH,2,2,"ng-template",null,8,Pn)),2&e){const r=en(7),o=en(9);k(1),A("ngTemplateOutlet",r),k(1),A("ngTemplateOutlet",o),k(1),A("ngIf",i.getGameObjects(i.selectTab).length<1),k(1),A("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),k(1),A("ngIf","graveyard"===i.selectTab)}},directives:[vu,un,Fn,yi,Kl,ql,Ls,Tu,bi,Li,Ci,ss,zs,Vs,ba,mu,Ea,Bs,_u],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}"],changeDetection:0}),t})();const cH=Qt.create("./assets/images/skeleton.png");let bc=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof Qt?e:vt.instance.get(e);return i&&!i.isEmpty?i:cH}getEmptyOr(e){let i=e instanceof Qt?e:vt.instance.get(e);return i&&!i.isEmpty?i:Qt.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function uH(t,n){if(1&t&&(E(0,"option",7),W(1),P()),2&t){const e=n.$implicit;sn("value",e.identifier),k(1),ht(e.name)}}function dH(t,n){if(1&t){const e=et();E(0,"div")(1,"button",28),ue("click",function(){return Te(e),G(2).openBgImageModal()}),W(2,"\u753b\u50cf\u3092\u8ffd\u52a0"),P()()}if(2&t){const e=G(2);k(1),A("disabled",!e.isEditable)}}function hH(t,n){if(1&t){const e=et();E(0,"div",2),ue("click",function(){return Te(e),G(2).openBgImageModal()}),$e(1,"img",29),Ut(2,"safe"),P()}if(2&t){const e=G(2);k(1),A("src",jt(2,1,e.tableBackgroundImage.url,"resourceUrl"),Ln)}}function fH(t,n){if(1&t){const e=et();E(0,"div")(1,"button",28),ue("click",function(){return Te(e),G(2).openDistanceViewImageModal()}),W(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),P()()}if(2&t){const e=G(2);k(1),A("disabled",!e.isEditable)}}function pH(t,n){if(1&t){const e=et();E(0,"div",2),ue("click",function(){return Te(e),G(2).openDistanceViewImageModal()}),$e(1,"img",29),Ut(2,"safe"),P()}if(2&t){const e=G(2);k(1),A("src",jt(2,1,e.tableDistanceviewImage.url,"resourceUrl"),Ln)}}function gH(t,n){if(1&t&&(E(0,"div",35),W(1),P()),2&t){const e=G(3);k(1),Bn("",e.progresPercent,"%")}}const mH=function(t){return{"is-hidden":t}};function _H(t,n){if(1&t){const e=et();Be(0),E(1,"button",30),ue("click",function(){return Te(e),G(2).save()}),E(2,"div",31)(3,"div",32),W(4,"\u4fdd\u5b58"),P(),Q(5,gH,2,1,"div",33),P()(),E(6,"button",34),ue("click",function(){return Te(e),G(2).delete()}),W(7,"\u524a\u9664"),P(),ze()}if(2&t){const e=G(2);k(1),A("disabled",e.isSaveing),k(2),A("ngClass",Pt(4,mH,e.isSaveing)),k(2),A("ngIf",e.isSaveing),k(1),A("disabled",e.getGameTables().length<=1)}}function vH(t,n){if(1&t){const e=et();Be(0),E(1,"button",2),ue("click",function(){return Te(e),G(2).restore()}),W(2,"\u5143\u306b\u623b\u3059"),P(),ze()}}function yH(t,n){if(1&t){const e=et();Be(0),E(1,"div",8)(2,"div"),W(3," \u753b\u50cf "),Q(4,dH,3,1,"div",6),Q(5,hH,3,4,"div",9),P(),E(6,"div"),W(7," \u80cc\u666f "),Q(8,fH,3,1,"div",6),Q(9,pH,3,4,"div",9),P()(),E(10,"div"),W(11,"Name : "),E(12,"input",10),ue("ngModelChange",function(r){return Te(e),G().tableName=r}),P()(),E(13,"div")(14,"input",11),ue("ngModelChange",function(r){return Te(e),G().tableWidth=r}),P(),W(15," Width : "),E(16,"input",12),ue("ngModelChange",function(r){return Te(e),G().tableWidth=r}),P()(),E(17,"div")(18,"input",13),ue("ngModelChange",function(r){return Te(e),G().tableHeight=r}),P(),W(19," Height : "),E(20,"input",12),ue("ngModelChange",function(r){return Te(e),G().tableHeight=r}),P()(),E(21,"div"),W(22," \u30b0\u30ea\u30c3\u30c9: "),E(23,"select",14),ue("ngModelChange",function(r){return Te(e),G().tableGridType=r}),E(24,"option",15),W(25,"\u306a\u3057"),P(),E(26,"option",16),W(27,"\u30b9\u30af\u30a8\u30a2"),P(),E(28,"option",17),W(29,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),P(),E(30,"option",18),W(31,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),P()(),W(32," \u8272: "),E(33,"select",19),ue("ngModelChange",function(r){return Te(e),G().tableGridColor=r}),E(34,"option",20),W(35,"\u9ed2"),P(),E(36,"option",21),W(37,"\u767d"),P()()(),E(38,"div"),W(39," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),E(40,"select",22),ue("ngModelChange",function(r){return Te(e),G().tableDistanceviewFilter=r}),E(41,"option",23),W(42,"\u306a\u3057"),P(),E(43,"option",24),W(44,"\u30db\u30ef\u30a4\u30c8"),P(),E(45,"option",25),W(46,"\u30d6\u30e9\u30c3\u30af"),P()()(),$e(47,"hr"),E(48,"div")(49,"label"),W(50,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),E(51,"input",26),ue("ngModelChange",function(r){return Te(e),G().tableGridShow=r}),P()(),E(52,"label"),W(53,"\u30b9\u30ca\u30c3\u30d7: "),E(54,"input",27),ue("ngModelChange",function(r){return Te(e),G().tableGridSnap=r}),P()(),Q(55,_H,8,6,"ng-container",6),Q(56,vH,3,0,"ng-container",6),P(),ze()}if(2&t){const e=G();k(4),A("ngIf",!e.tableBackgroundImage.url),k(1),A("ngIf",e.tableBackgroundImage.url),k(3),A("ngIf",!e.tableDistanceviewImage.url),k(1),A("ngIf",e.tableDistanceviewImage.url),k(3),A("ngModel",e.tableName)("disabled",!e.isEditable),k(2),sn("min",e.minSize),sn("max",e.maxSize),A("ngModel",e.tableWidth)("disabled",!e.isEditable),k(2),sn("min",e.minSize),sn("max",e.maxSize),A("ngModel",e.tableWidth)("disabled",!e.isEditable),k(2),sn("min",e.minSize),sn("max",e.maxSize),A("ngModel",e.tableHeight)("disabled",!e.isEditable),k(2),sn("min",e.minSize),sn("max",e.maxSize),A("ngModel",e.tableHeight)("disabled",!e.isEditable),k(3),A("ngModel",e.tableGridType)("disabled",!e.isEditable),k(10),A("ngModel",e.tableGridColor)("disabled",!e.isEditable),k(7),A("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),k(11),A("ngModel",e.tableGridShow),k(3),A("ngModel",e.tableGridSnap),k(1),A("ngIf",!e.isDeleted),k(1),A("ngIf",e.isDeleted)}}function bH(t,n){1&t&&(Be(0),E(1,"div",36),W(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),P(),ze())}let AS=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.saveDataService=i,this.imageService=r,this.panelService=o,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,ve.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Ho.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Oe.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),this.selectedTable=this.tableSelecter.viewTable,ve.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Oe.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){ve.unregister(this)}selectGameTable(e){ve.call("SELECT_GAME_TABLE",{identifier:e},He.peerId),this.selectedTable=Oe.instance.get(e),this.selectedTableXml=""}getGameTables(){return Oe.instance.getObjects(ui)}createGameTable(){let e=new ui;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,Tt.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=yn.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(id).then(e=>{!this.selectedTable||!e||(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(id,{isAllowedEmpty:!0}).then(e=>{!this.selectedTable||!e||(this.selectedTable.backgroundImageIdentifier=e)})}}return t.\u0275fac=function(e){return new(e||t)(ee(Di),ee(Sr),ee(bc),ee(rn))},t.\u0275cmp=Bt({type:t,selectors:[["game-table-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[1,"images-select"],[3,"click",4,"ngIf"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"height","120px",3,"disabled","click"],["height","120",3,"src"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(E(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),ue("click",function(){return i.createGameTable()}),W(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),P()(),E(5,"select",3),ue("change",function(o){return i.selectGameTable(o.target.value)}),Q(6,uH,2,2,"option",4),P()(),E(7,"div",5),Q(8,yH,57,32,"ng-container",6),P()(),Q(9,bH,3,0,"ng-container",6)),2&e&&(k(5),A("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),k(1),A("ngForOf",i.getGameTables()),k(2),A("ngIf",i.selectedTable),k(1),A("ngIf",i.isEmpty))},directives:[ss,Li,Ci,Fn,zs,Vs,un,bi,Bs,Ea,Zh,Wh,qm,yi],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();function CH(t,n){if(1&t){const e=et();E(0,"button",10),ue("click",function(){Te(e);const r=G().$implicit;return G().play(r)}),W(1,"\u8a66\u8074/\u518d\u751f"),P()}2&t&&A("disabled",!G().$implicit.isReady)}function wH(t,n){if(1&t){const e=et();E(0,"button",10),ue("click",function(){return Te(e),G(2).stop()}),W(1,"\u8a66\u8074/\u505c\u6b62"),P()}2&t&&A("disabled",!G().$implicit.isReady)}function EH(t,n){if(1&t){const e=et();E(0,"button",10),ue("click",function(){Te(e);const r=G().$implicit;return G().playBGM(r)}),W(1,"BGM/\u518d\u751f"),P()}2&t&&A("disabled",!G().$implicit.isReady)}function xH(t,n){if(1&t){const e=et();E(0,"button",10),ue("click",function(){Te(e);const r=G().$implicit;return G().stopBGM(r)}),W(1,"BGM/\u505c\u6b62"),P()}2&t&&A("disabled",!G().$implicit.isReady)}function TH(t,n){1&t&&(E(0,"span"),W(1,"\u3010\u8a66\u8074\u4e2d\u3011"),P())}function DH(t,n){1&t&&(E(0,"span"),W(1,"\u3010BGM\u3011"),P())}function SH(t,n){if(1&t&&(E(0,"div",8),Q(1,CH,2,1,"button",9),Q(2,wH,2,1,"button",9),Q(3,EH,2,1,"button",9),Q(4,xH,2,1,"button",9),Q(5,TH,2,0,"span",2),Q(6,DH,2,0,"span",2),E(7,"span"),W(8),P()()),2&t){const e=n.$implicit,i=G();k(1),A("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),k(1),A("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),k(1),A("ngIf",e!==(null==i.jukebox?null:i.jukebox.audio)),k(1),A("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),k(1),A("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),k(1),A("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),k(2),ht(e.name)}}function MH(t,n){1&t&&(E(0,"div"),W(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),P())}let kH=(()=>{class t{constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new nt,this.lazyUpdateTimer=null}get volume(){return nt.volume}set volume(e){nt.volume=e}get auditionVolume(){return nt.auditionVolume}set auditionVolume(e){nt.auditionVolume=e}get audios(){return ct.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Oe.instance.get("Jukebox")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=pc.AUDITION,ve.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){ve.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&$o.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(ee(Di),ee(rn),ee(Gt))},t.\u0275cmp=Bt({type:t,selectors:[["app-jukebox"]],decls:29,vars:4,consts:[["type","range","min","0","max","1","step","0.01",3,"ngModel","ngModelChange"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px"],[1,"box"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,i){1&e&&(E(0,"div"),W(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),E(2,"input",0),ue("ngModelChange",function(o){return i.auditionVolume=o}),P()(),E(3,"div"),W(4,"BGM\u97f3\u91cf\uff1a"),E(5,"input",0),ue("ngModelChange",function(o){return i.volume=o}),P()(),$e(6,"hr"),E(7,"div"),Q(8,SH,9,7,"div",1),Q(9,MH,2,0,"div",2),P(),E(10,"label")(11,"div",3)(12,"div")(13,"i",4),W(14,"playlist_add"),P()(),E(15,"div"),W(16,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),P(),E(17,"div",5),W(18,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),P(),E(19,"input",6),ue("change",function(o){return i.handleFileSelect(o)}),P(),E(20,"div",5),$e(21,"br"),W(22,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),P()()(),E(23,"div",7),W(24,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),P(),E(25,"div",7),W(26,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),P(),E(27,"div",7),W(28,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),P()),2&e&&(k(2),A("ngModel",i.auditionVolume),k(3),A("ngModel",i.volume),k(3),A("ngForOf",i.audios),k(1),A("ngIf",i.audios.length<1))},directives:[Bs,bi,Li,Ci,Fn,un],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),t})();const AH=["content"],IH=["*"];let OH=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&Vn(AH,7,Zi),2&e){let r;zn(r=Un())&&(i.content=r.first)}},ngContentSelectors:IH,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(Wg(),E(0,"div",0)(1,"div",1),ue("click",function(o){return i.clickBackground(o)}),P(),E(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),ue("click",function(){return i.resolve()}),E(6,"i",6),W(7,"close"),P()()(),W(8),P(),E(9,"div",7),Zg(10),$e(11,"div",null,8),P()()()),2&e&&(k(1),A("@bgInOut","in"),k(1),A("@flyInOut","in"),k(6),Bn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Ao("flyInOut",[Ei("void => *",[wi("100ms ease-out",uo([_t({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),_t({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Ei("* => void",[wi(100,_t({transform:"scale(0, 0)"}))])]),Ao("bgInOut",[__("in",_t({"background-color":"rgba(30, 30, 30, 0.4)"})),Ei("void => *",[_t({"background-color":"rgba(30, 30, 30, 0.0)"}),wi(200)]),Ei("* => void",[wi(200,_t({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();const PH=["passwordInput"],FH=function(){return{standalone:!0}};let NH=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=vn.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return He.peerId}get isConnected(){return!(He.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9 \uff1c${this.title}\uff1e`),ve.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){ve.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(ee(rn),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&Vn(PH,7),2&e){let r;zn(r=Un())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(E(0,"form",null,0)(2,"div"),W(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),E(4,"input",1,2),ue("ngModelChange",function(o){return i.password=o})("input",function(o){return i.onInputChange(o.target.value)}),P()(),E(6,"button",3),ue("click",function(){return i.submit()}),W(7,"\u5165\u5ba4"),P()(),E(8,"div")(9,"span",4),W(10),P()()),2&e&&(k(4),A("ngModel",i.password)("ngModelOptions",ma(3,FH)),k(6),ht(i.help))},directives:[Kl,ql,Ls,bi,Li,Ci],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function RH(t,n){if(1&t&&(E(0,"div")(1,"div",9),W(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),P(),E(3,"div",9),W(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),P(),E(5,"div",9),W(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),P()()),2&t){G();const e=en(4);k(1),A("hidden",!e.errors.required),k(2),A("hidden",!e.errors.minlength),k(2),A("hidden",!e.errors.maxlength)}}function LH(t,n){if(1&t&&(E(0,"div")(1,"div",9),W(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),P()()),2&t){G();const e=en(8);k(1),A("hidden",!e.errors.maxlength)}}function BH(t,n){1&t&&(E(0,"div"),W(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),P())}function zH(t,n){if(1&t){const e=et();E(0,"div")(1,"div"),W(2,"\u30eb\u30fc\u30e0\u540d : "),E(3,"input",3,4),ue("input",function(r){Te(e);const o=G();return o.calcPeerId(r.target.value,o.password)})("ngModelChange",function(r){return Te(e),G().roomName=r}),P()(),E(5,"div"),W(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),E(7,"input",5,6),ue("input",function(r){Te(e);const o=G();return o.calcPeerId(o.roomName,r.target.value)})("ngModelChange",function(r){return Te(e),G().password=r}),P()(),$e(9,"hr"),Q(10,RH,7,3,"div",7),Q(11,LH,3,1,"div",7),Q(12,BH,2,0,"div",7),E(13,"div")(14,"button",8),ue("click",function(){return Te(e),G().createRoom()}),W(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),P()()()}if(2&t){const e=en(4),i=en(8),r=G();k(3),A("ngModel",r.roomName),k(4),A("ngModel",r.password),k(3),A("ngIf",e.errors&&(e.dirty||e.touched)),k(1),A("ngIf",i.errors&&(i.dirty||i.touched)),k(1),A("ngIf",!r.validateLength),k(2),A("disabled",!e.valid||!i.valid||!r.validateLength)}}function VH(t,n){1&t&&(E(0,"span",1),W(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),$e(2,"br"),W(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),$e(4,"br"),W(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),P())}let UH=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return He.peerId}get isConnected(){return!(He.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),ve.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){ve.unregister(this)}calcPeerId(e,i){let r=He.peerContext?He.peerContext.userId:vn.generateId(),o=vn.create(r,vn.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){let e=He.peerContext?He.peerContext.userId:vn.generateId();He.open(e,vn.generateId("***"),this.roomName,this.password),kt.myCursor.peerId=He.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(ee(rn),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Q(0,zH,16,6,"div",0),E(1,"div")(2,"span",1),W(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),P()(),Q(4,VH,6,0,"ng-template",null,2,Pn)),2&e){const r=en(5);A("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[un,bi,Yh,g_,m_,Li,Ci],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function jH(t,n){1&t&&(E(0,"td")(1,"i",11),W(2,"lock"),P()())}function HH(t,n){1&t&&(E(0,"td"),W(1,"-"),P())}function GH(t,n){if(1&t){const e=et();E(0,"button",12),ue("click",function(){Te(e);const r=G().$implicit;return G(3).connect(r.peerContexts)}),W(1,"\u63a5\u7d9a"),P()}if(2&t){const e=G().$implicit,i=G(3);A("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function $H(t,n){if(1&t&&(Be(0),E(1,"tr")(2,"td",9),W(3),P(),E(4,"td",7),W(5),P(),Q(6,jH,3,0,"td",4),Q(7,HH,2,0,"td",4),E(8,"td"),W(9),P(),E(10,"td"),Q(11,GH,2,1,"button",10),P()(),ze()),2&t){const e=n.$implicit;k(3),ht(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),k(2),ht(e.roomName),k(1),A("ngIf",e.peerContexts[0].hasPassword),k(1),A("ngIf",!e.peerContexts[0].hasPassword),k(2),Bn("",e.peerContexts.length,"\u4eba"),k(2),A("ngIf",0<e.alias.length)}}function WH(t,n){if(1&t&&(Be(0),E(1,"table",6)(2,"tr")(3,"th"),W(4,"\u30eb\u30fc\u30e0ID"),P(),E(5,"th",7),W(6,"\u30eb\u30fc\u30e0\u540d"),P(),E(7,"th"),W(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),P(),E(9,"th"),W(10,"\u53c2\u52a0\u8005"),P(),$e(11,"th"),P(),Q(12,$H,12,6,"ng-container",8),P(),ze()),2&t){const e=G(2);k(12),A("ngForOf",e.rooms)}}function ZH(t,n){if(1&t&&(E(0,"span",13),W(1),P()),2&t){const e=G(2);k(1),ht(e.help)}}function YH(t,n){if(1&t){const e=et();E(0,"div")(1,"button",2),ue("click",function(){return Te(e),G().reload()}),W(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),P(),E(3,"button",3),ue("click",function(){return Te(e),G().showRoomSetting()}),W(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),P(),$e(5,"hr"),Q(6,WH,13,1,"ng-container",4),Q(7,ZH,2,1,"span",5),P()}if(2&t){const e=G();k(1),A("disabled",e.isReloading),k(5),A("ngIf",e.rooms.length),k(1),A("ngIf",e.rooms.length<1)}}function qH(t,n){1&t&&(E(0,"span",13),W(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),$e(2,"br"),W(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),P())}let XH=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return He.peerContext.roomId}get peerId(){return He.peerId}get isConnected(){return!(He.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),ve.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",He.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\uff1c"+He.peerContext.roomName+"/"+He.peerContext.roomId+"\uff1e")}ngOnDestroy(){ve.unregister(this)}reload(){var e=this;return(0,Tt.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield He.listAllPeers();for(let o of r){let s=vn.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,Tt.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=yield i.modalService.open(NH,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==o&&(o="")),!r.verifyPassword(o))return;let s=He.peerContext?He.peerContext.userId:vn.generateId();He.open(s,r.roomId,r.roomName,o),kt.myCursor.peerId=He.peerId;let a=[];ve.register(a).on("OPEN_NETWORK",l=>{console.log("LobbyComponent OPEN_PEER",l.data.peerId),ve.unregister(a),Oe.instance.clearDeleteHistory();for(let c of e)He.connect(c.peerId);ve.register(a).on("CONNECT_PEER",c=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",c.data.peerId),a.push(c.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),ve.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",c=>{console.warn("\u63a5\u7d9a\u5931\u6557",c.data.peerId),a.push(c.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),ve.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){He.peerContexts.length<1&&(He.open(),kt.myCursor.peerId=He.peerId)}closeIfConnected(){0<He.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,Tt.Z)(function*(){yield e.modalService.open(UH,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(ee(rn),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Q(0,YH,8,3,"div",0),Q(1,qH,4,0,"ng-template",null,1,Pn)),2&e){const r=en(2);A("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[un,Fn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();function KH(t,n){if(1&t){const e=et();E(0,"div",8),ue("click",function(){return Te(e),G(2).changeIcon()}),Ut(1,"safe"),P()}2&t&&an("background-image",jt(1,2,"url("+G(2).myPeer.image.url+")","style"))}function QH(t,n){if(1&t){const e=et();E(0,"div")(1,"button",5),ue("click",function(){return Te(e),G().changeIcon()}),W(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),P(),Q(3,KH,2,5,"div",6),E(4,"span"),W(5,"\u3042\u306a\u305f\u306e\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a "),E(6,"input",7),ue("ngModelChange",function(r){return Te(e),G().myPeer.name=r}),P()()()}if(2&t){const e=G();k(3),A("ngIf",e.myPeer.image),k(3),A("ngModel",e.myPeer.name)}}function JH(t,n){if(1&t&&(E(0,"span",9),W(1),P()),2&t){const e=G();k(1),ht(e.networkService.peerContext.userId)}}function e9(t,n){1&t&&(E(0,"span",9),W(1,"???"),P())}function t9(t,n){if(1&t&&(E(0,"span",9),W(1),P()),2&t){const e=G(2);k(1),jl("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,"")}}function n9(t,n){if(1&t&&(E(0,"span",9),W(1),P()),2&t){const e=G(3);k(1),ht(e.isPasswordVisible?e.networkService.peerContext.password:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf")}}function i9(t,n){if(1&t){const e=et();E(0,"span"),Q(1,n9,2,1,"span",1),E(2,"button",10),ue("click",function(){return Te(e),G(2).togglePasswordVisibility()}),E(3,"span",11),W(4),P()()()}if(2&t){const e=G(2);k(1),A("ngIf",e.networkService.isOpen),k(3),ht(e.isPasswordVisible?"visibility":"visibility_off")}}function r9(t,n){if(1&t&&(Be(0),$e(1,"hr"),E(2,"div")(3,"span"),W(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),Q(5,t9,2,2,"span",1),P()(),E(6,"div")(7,"span"),W(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),Q(9,i9,5,2,"span",0),P()(),ze()),2&t){const e=G();k(5),A("ngIf",e.networkService.isOpen),k(4),A("ngIf",e.networkService.peerContext.hasPassword)}}function o9(t,n){1&t&&(E(0,"span"),W(1,"[\u63a5\u7d9a\u4e2d]"),P())}function s9(t,n){if(1&t&&(E(0,"div")(1,"div"),Q(2,o9,2,0,"span",0),E(3,"span"),W(4),P()()()),2&t){const e=n.$implicit,i=G();k(2),A("ngIf",!e.isOpen),k(2),jl("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(e.peerId)," [",i.findPeerName(e.peerId),"]")}}function a9(t,n){if(1&t){const e=et();Be(0),E(1,"input",12),ue("ngModelChange",function(r){return Te(e),G().targetUserId=r}),P(),E(2,"button",13),ue("click",function(){return Te(e),G().connectPeer()}),W(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),P(),$e(4,"br"),ze()}if(2&t){const e=G();k(1),A("ngModel",e.targetUserId),k(1),A("disabled",!e.networkService.isOpen)}}function l9(t,n){if(1&t){const e=et();E(0,"button",13),ue("click",function(){return Te(e),G().showLobby()}),W(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),P()}2&t&&A("disabled",!G().networkService.isOpen)}function c9(t,n){1&t&&(E(0,"div",4),W(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),P())}function u9(t,n){1&t&&(E(0,"div",4),W(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),P())}function d9(t,n){if(1&t&&(Be(0),Q(1,c9,2,0,"div",14),Q(2,u9,2,0,"div",14),ze()),2&t){const e=G();k(1),A("ngIf",e.networkService.peerContexts.length<1),k(1),A("ngIf",e.networkService.peerContexts.length<1)}}function h9(t,n){1&t&&(Be(0),E(1,"div",4),W(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),P(),ze())}let IS=(()=>{class t{constructor(e,i,r,o){this.ngZone=e,this.modalService=i,this.panelService=r,this.appConfigService=o,this.targetUserId="",this.networkService=He,this.gameRoomService=Oe.instance,this.help="",this.isPasswordVisible=!1}get myPeer(){return kt.myCursor}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u63a5\u7d9a\u60c5\u5831")}ngAfterViewInit(){ve.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})})}ngOnDestroy(){ve.unregister(this)}changeIcon(){this.modalService.open(id).then(e=>{!this.myPeer||!e||(this.myPeer.imageIdentifier=e)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=vn.create(e);i.isRoom||(Oe.instance.clearDeleteHistory(),He.connect(i.peerId))}showLobby(){this.modalService.open(XH,{width:700,height:400,left:0,top:400})}togglePasswordVisibility(){this.isPasswordVisible=!this.isPasswordVisible}findUserId(e){const i=kt.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=kt.findByPeerId(e);return i?i.name:""}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(Di),ee(rn),ee(O0))},t.\u0275cmp=Bt({type:t,selectors:[["peer-menu"]],decls:17,vars:10,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",3,"ngModel","ngModelChange"],[1,"image","cover",3,"click"],[2,"font-weight","bold"],[2,"padding","2px","margin-left","1.0em","font-size","1.0em",3,"click"],[1,"material-icons",2,"font-size","1.0em","vertical-align","text-bottom"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","ngModelChange"],[3,"disabled","click"],["style","font-size: 12px;",4,"ngIf"]],template:function(e,i){1&e&&(Q(0,QH,7,2,"div",0),E(1,"div")(2,"span"),W(3,"\u3042\u306a\u305f\u306eID\uff1a"),Q(4,JH,2,1,"span",1),Q(5,e9,2,0,"span",1),P()(),Q(6,r9,10,2,"ng-container",0),$e(7,"hr"),Q(8,s9,5,3,"div",2),E(9,"div"),Q(10,a9,5,2,"ng-container",0),Q(11,l9,2,1,"button",3),P(),E(12,"div")(13,"span",4),W(14),P()(),Q(15,d9,3,2,"ng-container",0),Q(16,h9,3,0,"ng-container",0)),2&e&&(A("ngIf",i.myPeer),k(4),A("ngIf",i.networkService.isOpen),k(1),A("ngIf",!i.networkService.isOpen),k(1),A("ngIf",i.networkService.peerContext.isRoom),k(2),A("ngForOf",i.networkService.peerContexts),k(2),A("ngIf",!i.networkService.peerContext.isRoom),k(1),A("ngIf",i.networkService.peerIds.length<=1),k(3),ht(i.help),k(1),A("ngIf",!i.networkService.peerContext.isRoom),k(1),A("ngIf",i.networkService.peerContext.isRoom))},directives:[un,bi,Li,Ci,Fn],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}"]}),t})();class Zo{constructor(n,e={capture:!1,passive:!1,always:!1}){this.target=n,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(n))}onTouch(n){let e=n.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=n.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===n.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){for(let i of this.lastPointers)if(i.identifier!==n.identifier&&(n.x-i.x)**2+(n.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let PS=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.onstart=new Rt,this.onmove=new Rt,this.onend=new Rt,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new Zo(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():e.stopPropagation()}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let a=l=>{l.cancelable&&l.preventDefault(),l.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",a,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y)),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Gn.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Gn.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(On))},t.\u0275dir=gt({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})();var on=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(on||(on={})),on))();class f9{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new Zo(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case on.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case on.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case on.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case on.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case on.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2";break;case on.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case on.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case on.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let p9=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Rt,this.onmove=new Rt,this.onend=new Rt,this.handleMap=new Map,this.handleTypes=[on.N,on.E,on.W,on.S,on.NE,on.NW,on.SE,on.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new f9(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case on.N:case on.S:r.width=0;break;case on.E:case on.W:r.height=0}switch(i.type){case on.SW:r.left=r.width,r.width*=-1;break;case on.NE:r.top=r.height,r.height*=-1;break;case on.E:case on.S:case on.SE:break;case on.N:case on.W:case on.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Gn.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Gn.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Gn.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Gn.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(On))},t.\u0275dir=gt({type:t,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const g9=["draggablePanel"],m9=["scrollablePanel"],_9=["content"];function v9(t,n){if(1&t){const e=et();E(0,"div",7)(1,"button",8),ue("click",function(){return Te(e),G().toggleFullScreen()}),E(2,"i",9),W(3,"fullscreen"),P()(),E(4,"button",8),ue("click",function(){return Te(e),G().close()}),E(5,"i",9),W(6,"close"),P()()()}}const y9=function(t){return{"pointer-events-none":t}},b9=["*"];let FS=(()=>{class t{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleFullScreen(){let e=this.draggablePanel.nativeElement;this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(ee(rn),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(Vn(g9,7),Vn(m9,7),Vn(_9,7,Zi)),2&e){let r;zn(r=Un())&&(i.draggablePanel=r.first),zn(r=Un())&&(i.scrollablePanel=r.first),zn(r=Un())&&(i.content=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",showTitleButtons:"showTitleButtons"},features:[En([rn])],ngContentSelectors:b9,decls:10,vars:16,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["class","title-button",4,"ngIf"],[1,"scrollable-panel"],["scrollablePanel",""],["content",""],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"]],template:function(e,i){1&e&&(Wg(),E(0,"div",0,1)(2,"div",2),Q(3,v9,7,0,"div",3),W(4),P(),E(5,"div",4,5),Zg(7),$e(8,"div",null,6),P()()),2&e&&(an("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),A("@flyInOut","in")("ngClass",Pt(14,y9,i.isPointerDragging))("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),k(3),A("ngIf",i.showTitleButtons),k(1),Bn(" ",i.panelService.title," "))},directives:[PS,p9,yi,un],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"],data:{animation:[Ao("flyInOut",[Ei("void => *",[wi("100ms ease-out",uo([_t({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),_t({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Ei("* => void",[wi(100,_t({transform:"scale(0, 0)"}))])])]}}),t})();class C9{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=gs.SQUARE,o="#000000e6"){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let s=this.canvasElement.getContext("2d");if(r<0)return;let a=this.generateCalcGridPositionFunc(r);this.makeBrush(s,i,o);for(let l=0;l<=e;l++)for(let c=0;c<=n;c++){let{gx:u,gy:h}=a(c,l,i);this.strokeSquare(s,u,h,i),s.fillText((c+1).toString()+"-"+(l+1).toString(),u+i/2,h+i/2)}}generateCalcGridPositionFunc(n){switch(n){case gs.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case gs.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===gs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),l=e+r/2,c=i+r/2;n.beginPath();for(let u=0;u<6;u++){s+=60;let h=Math.PI/180*s,g=Math.cos(h)*a+l,w=Math.sin(h)*a+c;n.lineTo(g,w)}n.closePath(),n.stroke()}}var Wa=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(Wa||(Wa={})),Wa))(),Zr=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(Zr||(Zr={})),Zr))();class w9{constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new Zo(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,c=0,h=0,g=Wa.DRAG;2===this.buttonCode?(g=Wa.ROTATE,h=-r/5,c=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,c,0,h,g,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Wa.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,l=this.getKeyName(n);switch(l){case Zr.ArrowLeft:n.shiftKey?a=-2:e=10;break;case Zr.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case Zr.ArrowRight:n.shiftKey?a=2:e=-10;break;case Zr.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=Zr[l]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Wa.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return Zr.ArrowLeft;case 38:return Zr.ArrowUp;case 39:return Zr.ArrowRight;case 40:return Zr.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var ta=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(ta||(ta={})),ta))();class E9{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",l=>{let c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:l.center.x,clientY:l.center.y});this.ngZone.run(()=>l.srcEvent.target.dispatchEvent(c))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-n.center.x)**2+(this.tappedPanCenter.y-n.center.y)**2&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,ta.PAN,n.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,ta.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,ta.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,ta.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,ta.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let U0=(()=>{class t{constructor(){}createGameCharacter(e){let i=Cn.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=po.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=vt.instance.get(i);r||(r=vt.instance.add(i));let o=this.getViewTable();if(!o)return;let s=$r.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Go.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=jo.create(i,r,1),a=null;return s.faces.forEach(l=>{let c=`./assets/images/dice/${o}/${o}[${l}].png`;a=vt.instance.get(c),a||(a=vt.instance.add(c)),s.imageDataElement.getFirstElementByName(l).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createTrump(e){let i=gi.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";vt.instance.get(r)||vt.instance.add(r);let o=["c","d","h","s"],s=[];for(let a of o)for(let l=1;l<=13;l++)s.push(a+("00"+l).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let l="./assets/images/trump/"+a+".gif";vt.instance.get(l)||vt.instance.add(l);let c=Ki.create("\u30ab\u30fc\u30c9",l,r);i.putOnBottom(c)}return i}makeDefaultTable(){let e=new ui("gameTable"),i=null,r=Qt.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=vt.instance.add(r),e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),Ho.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Cn("testCharacter_1"),r=Qt.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=vt.instance.add(r),e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new Cn("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new Cn("testCharacter_3"),r=Qt.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=vt.instance.add(r),e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new Cn("testCharacter_4"),r=Qt.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=vt.instance.add(r),e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new Cn("testCharacter_5"),r=Qt.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=vt.instance.add(r),e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new Cn("testCharacter_6"),r=Qt.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=vt.instance.add(r),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),We.play(Me.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),We.play(Me.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),We.play(Me.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),We.play(Me.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),We.play(Me.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"D4",diceName:"D4",type:mi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:mi.D6,imagePathPrefix:"6_dice"},{menuName:"D8",diceName:"D8",type:mi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:mi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:mi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:mi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:mi.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),We.play(Me.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return Ho.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=It({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Za=(()=>{class t{constructor(e,i,r,o,s){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=o,this.coordinateService=s,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.onstart=new Rt,this.ondragstart=new Rt,this.ondrag=new Rt,this.ondragend=new Rt,this.onend=new Rt,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){return Ho.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),ve.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new Zo(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),ve.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1)}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(!0),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(o.x-=this.width/2,o.y-=this.height/2,this.posX===o.x&&this.posY===o.y&&this.posZ===o.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let a=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;a<this.ratio&&(this.ratio+=.1*(a-this.ratio)),this.posX=o.x,this.posY=o.y,this.posZ=o.z}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&"none"!==getComputedStyle(o).pointerEvents&&this.collidableElements.push(o)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&this.findNestedCollidableElements(o)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=e}setCollidableLayer(e){let i=e;for(let r in t.layerHash)i=-1<this.colideLayers.indexOf(r)?!this.input.isGrabbing||e:!e,t.layerHash[r].forEach(o=>{o===this||o.input.isGrabbing||o.setPointerEvents(i)})}register(){this.layerName in t.layerHash||(t.layerHash[this.layerName]=[]),t.layerHash[this.layerName].indexOf(this)<0&&t.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in t.layerHash))return;let e=t.layerHash[this.layerName].indexOf(this);-1<e&&t.layerHash[this.layerName].splice(e,1)}}return t.layerHash={},t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(On),ee(Yf),ee(Qn),ee(ja))},t.\u0275dir=gt({type:t,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),t})(),Cc=(()=>{class t{constructor(e,i,r,o){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Rt,this.ondragstart=new Rt,this.ondrag=new Rt,this.ondragend=new Rt,this.onend=new Rt,this._rotate=0,this.valueChange=new Rt,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),ve.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new Zo(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(ve.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1)}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(ee(On),ee(Yf),ee(Qn),ee(ja))},t.\u0275dir=gt({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),t})();const rd=function(t){return{"blinking-animation":t}},x9=function(t){return{transform:t}};function T9(t,n){if(1&t&&(Be(0),E(1,"div",3),Ut(2,"safe"),P(),ze()),2&t){const e=G();k(1),an("background-image",jt(2,4,"url("+e.floorImage.url+")","style")),A("ngClass",Pt(7,rd,!e.isLocked))("ngStyle",Pt(9,x9,"translateZ("+e.height*e.gridSize+"px)"))}}function D9(t,n){if(1&t&&(E(0,"div",8),Ut(1,"safe"),P()),2&t){const e=G(2);an("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),A("ngClass",Pt(10,rd,!e.isLocked))}}function S9(t,n){if(1&t&&(E(0,"div",9),Ut(1,"safe"),P()),2&t){const e=G(2);an("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),A("ngClass",Pt(10,rd,!e.isLocked))}}function M9(t,n){if(1&t&&(E(0,"div",10),Ut(1,"safe"),P()),2&t){const e=G(2);an("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),A("ngClass",Pt(10,rd,!e.isLocked))}}function k9(t,n){if(1&t&&(E(0,"div",11),Ut(1,"safe"),P()),2&t){const e=G(2);an("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),A("ngClass",Pt(10,rd,!e.isLocked))}}function A9(t,n){if(1&t&&(Be(0),Q(1,D9,2,12,"div",4),Q(2,S9,2,12,"div",5),Q(3,M9,2,12,"div",6),Q(4,k9,2,12,"div",7),ze()),2&t){const e=G();k(1),A("ngIf",e.isVisibleWallTopBottom),k(1),A("ngIf",e.isVisibleWallTopBottom),k(1),A("ngIf",e.isVisibleWallLeftRight),k(1),A("ngIf",e.isVisibleWallLeftRight)}}function I9(t,n){1&t&&(Be(0),$e(1,"div",12),E(2,"div",13)(3,"i",14),W(4,"autorenew"),P()(),E(5,"div",15)(6,"i",14),W(7,"autorenew"),P()(),E(8,"div",16)(9,"i",14),W(10,"autorenew"),P()(),E(11,"div",17)(12,"i",14),W(13,"autorenew"),P()(),ze())}const O9=function(t){return{"is-grab":t}};let P9=(()=>{class t{constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=l,this.pointerDeviceService=c,this.coordinateService=u,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.input=null}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}ngOnInit(){ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.terrain||!i||(this.terrain===i||i instanceof bn&&this.terrain.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Zo(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&ve.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLocked?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLocked=!1,We.play(Me.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLocked=!0,We.play(Me.lock)}},Kn,this.hasWall?{name:"\u58c1\u3092\u975e\u8868\u793a",action:()=>{this.mode=ea.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}:{name:"\u58c1\u3092\u8868\u793a",action:()=>{this.mode=ea.ALL}},Kn,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.terrain.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(o),We.play(Me.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),We.play(Me.sweep)}},Kn,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){We.play(Me.blockPick)}onMoved(){We.play(Me.blockPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-250,top:i.y-150,width:500,height:300}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(bc),ee(U0),ee(ur),ee(On),ee(rn),ee(Ni),ee(Qn),ee(ja))},t.\u0275cmp=Bt({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&ue("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:5,vars:14,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"texture",3,"ngClass","ngStyle"],["class","texture of-wall-top",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-bottom",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-left",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-right",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"texture","of-wall-top",3,"ngClass"],[1,"texture","of-wall-bottom",3,"ngClass"],[1,"texture","of-wall-left",3,"ngClass"],[1,"texture","of-wall-right",3,"ngClass"],[1,"pedestal-grab","rotate-grab"],[1,"rotate-grab","of-left-top","rotate-grab-icon"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-top","rotate-grab-icon"]],template:function(e,i){1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),E(1,"div",1),ue("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,T9,3,11,"ng-container",2),Q(3,A9,5,4,"ng-container",2),Q(4,I9,14,0,"ng-container",2),P()()),2&e&&(an("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),A("movable.option",i.movableOption)("movable.disable",i.isLocked),k(1),A("ngClass",Pt(12,O9,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),k(1),A("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),k(1),A("ngIf",i.hasWall&&0<(null==i.wallImage?null:i.wallImage.url.length)),k(1),A("ngIf",!i.isLocked))},directives:[Za,Cc,yi,un,Ca],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:blink 1s linear infinite alternate}@keyframes blink{0%{opacity:.9}to{opacity:.5}}"],changeDetection:0}),t})();function F9(t,n){1&t&&$e(0,"div")}function N9(t,n){1&t&&$e(0,"div",5),2&t&&an("background-color","rgba(10, 10, 10,"+G().opacity+")")}function R9(t,n){if(1&t&&(E(0,"div",5),$e(1,"img",6),Ut(2,"safe"),P()),2&t){const e=G();k(1),an("opacity",e.opacity),A("src",jt(2,3,e.imageFile.url,"resourceUrl"),Ln)}}function L9(t,n){1&t&&(E(0,"div",7)(1,"i",8),W(2,"lock"),P()())}const B9=function(t){return{"is-grab":t}};let z9=(()=>{class t{constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=l,this.coordinateService=c,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}ngOnInit(){ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.gameTableMask||!i||(this.gameTableMask===i||i instanceof bn&&this.gameTableMask.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Zo(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&ve.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,We.play(Me.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,We.play(Me.lock)}},Kn,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",o),o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(o),We.play(Me.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),We.play(Me.sweep)}},Kn,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){We.play(Me.cardPick)}onMoved(){We.play(Me.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(U0),ee(ur),ee(On),ee(rn),ee(Ni),ee(Qn),ee(ja))},t.\u0275cmp=Bt({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&ue("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:7,vars:13,consts:[["appMovable","",1,"component",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[4,"ngIf","ngIfThen","ngIfElse"],["blackMask",""],["imageMask",""],["class","lock-icon is-center",4,"ngIf"],[1,"border","is-fit-full"],[1,"image","is-fit-full",3,"src"],[1,"lock-icon","is-center"],[1,"material-icons"]],template:function(e,i){if(1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,F9,1,0,"div",1),Q(2,N9,1,2,"ng-template",null,2,Pn),Q(4,R9,3,6,"ng-template",null,3,Pn),Q(6,L9,3,0,"div",4),P()),2&e){const r=en(3),o=en(5);an("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),A("ngClass",Pt(11,B9,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),k(1),A("ngIf",i.imageFile.url.length<1)("ngIfThen",r)("ngIfElse",o),k(5),A("ngIf",i.isLock)}},directives:[Za,yi,un],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),t})();const V9=["textArea"];function U9(t,n){if(1&t&&(E(0,"div",11),W(1),P()),2&t){const e=G();k(1),ht(e.title)}}const j9=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"is-outline-text":e}};let H9=(()=>{class t{constructor(e,i,r,o,s){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.changeDetector=o,this.pointerDeviceService=s,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=a=>this.onMouseUp(a),this.gridSize=50,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={}}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}ngOnInit(){ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof bn&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){}ngOnDestroy(){ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void ve.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),We.play(Me.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),We.play(Me.sweep)}}],this.title)}onMove(){We.play(Me.cardPick)}onMoved(){We.play(Me.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(Wo,{title:r,left:i.x-350,top:i.y-200,width:700,height:400}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(ur),ee(rn),ee(Ni),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&Vn(V9,7),2&e){let r;zn(r=Un())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&ue("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:16,vars:32,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"upright-transform","is-front","is-bg-color","is-bg-texture"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],[1,"upright-transform","is-back","is-bg-color","is-bg-texture"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[1,"title","is-black-background","is-pointer-events-none"]],template:function(e,i){1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),E(1,"div",1),ue("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),E(2,"div",2)(3,"div",3),Ut(4,"safe"),Q(5,U9,2,1,"div",4),E(6,"textarea",5,6),ue("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),P()(),E(8,"div",7),Ut(9,"safe"),P(),E(10,"div",8)(11,"i",9),W(12,"autorenew"),P()(),E(13,"div",10)(14,"i",9),W(15,"autorenew"),P()()()()()),2&e&&(A("movable.option",i.movableOption)("movable.disable",i.isSelected),k(1),A("rotable.option",i.rotableOption),k(1),an("width",i.width*i.gridSize,"px"),k(1),an("background-image",jt(4,22,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),k(2),A("ngIf",i.title.length),k(1),an("font-size",i.fontSize+9,"px"),A("ngClass",ph(28,j9,!i.isSelected,i.isSelected,!i.isSelected))("ngModel",i.text),k(2),an("background-image",jt(9,25,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"))},directives:[Za,Cc,un,bi,yi,Li,Ci],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),t})();const G9=["draggablePanel"];function $9(t,n){1&t&&wn(0)}function W9(t,n){1&t&&wn(0)}const NS=function(t){return{card:t}};function Z9(t,n){if(1&t&&(Be(0),Q(1,W9,1,0,"ng-container",12),ze()),2&t){const e=G(),i=en(12);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,NS,e.tabletopObject))}}function Y9(t,n){1&t&&wn(0)}function q9(t,n){if(1&t&&(Be(0),Q(1,Y9,1,0,"ng-container",12),ze()),2&t){const e=G(),i=en(12);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,NS,e.tabletopObject))}}function X9(t,n){1&t&&wn(0)}const K9=function(t){return{note:t}};function Q9(t,n){if(1&t&&(Be(0),Q(1,X9,1,0,"ng-container",12),ze()),2&t){const e=G(),i=en(14);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,K9,e.tabletopObject))}}function J9(t,n){1&t&&wn(0)}const RS=function(t){return{character:t}};function e7(t,n){if(1&t&&(Be(0),Q(1,J9,1,0,"ng-container",12),ze()),2&t){const e=G(),i=en(16);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,RS,e.tabletopObject))}}function t7(t,n){1&t&&wn(0)}const n7=function(t){return{dice:t}};function i7(t,n){if(1&t&&(Be(0),Q(1,t7,1,0,"ng-container",12),ze()),2&t){const e=G(),i=en(18);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,n7,e.tabletopObject))}}function r7(t,n){1&t&&wn(0)}function o7(t,n){if(1&t&&(Be(0),Q(1,r7,1,0,"ng-container",12),ze()),2&t){const e=G(),i=en(16);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,RS,e.tabletopObject))}}function s7(t,n){1&t&&wn(0)}function a7(t,n){if(1&t&&(Be(0),Q(1,s7,1,0,"ng-container",13),ze()),2&t){G();const e=en(22);k(1),A("ngTemplateOutlet",e)}}const LS=function(t){return{"with-button-marign":t}};function l7(t,n){if(1&t&&(E(0,"div",24)(1,"div",25),W(2),P()()),2&t){const e=G(2).card,i=G();A("ngClass",Pt(2,LS,i.hasImage)),k(2),ht(e.ownerName)}}function c7(t,n){if(1&t){const e=et();E(0,"div",19),$e(1,"img",20),Ut(2,"safe"),E(3,"button",21),ue("click",function(){return Te(e),G(2).chanageImageView(!0)}),E(4,"i",22),W(5,"zoom_in"),P()(),Q(6,l7,3,4,"div",23),P()}if(2&t){const e=G().card,i=G();k(1),A("src",jt(2,2,i.imageUrl,"resourceUrl"),Ln),k(5),A("ngIf",e.hasOwner&&0<e.ownerName.length)}}function u7(t,n){if(1&t&&(Be(0),W(1),ze()),2&t){const e=G(2).card;k(1),ht(e.name)}}function d7(t,n){1&t&&(Be(0),W(1,"\u30ab\u30fc\u30c9"),ze())}function h7(t,n){if(1&t&&(E(0,"div",26),Q(1,u7,2,1,"ng-container",5),Q(2,d7,2,0,"ng-container",5),P()),2&t){const e=G().card,i=G();A("ngClass",Pt(3,LS,i.hasImage)),k(1),A("ngIf",null==e.isVisible||e.isVisible),k(1),A("ngIf",null!=e.isVisible&&!e.isVisible)}}function f7(t,n){1&t&&wn(0)}const qf=function(t){return{dataElm:t}};function p7(t,n){if(1&t&&(Be(0),Q(1,f7,1,0,"ng-container",12),ze()),2&t){const e=n.$implicit;G(3);const i=en(20);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,qf,e))}}function g7(t,n){if(1&t&&(E(0,"div",27)(1,"div",28),Q(2,p7,2,4,"ng-container",29),P()()),2&t){const e=G(2);k(2),A("ngForOf",e.dataElms)}}const mo=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function m7(t,n){if(1&t&&(E(0,"div",14),Q(1,c7,7,5,"div",15),Q(2,h7,3,5,"div",16),E(3,"div",17),Q(4,g7,3,1,"div",18),P()()),2&t){const e=n.card,i=G();A("ngClass",vi(4,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),A("ngIf",i.hasImage),k(1),A("ngIf",0<(null==e||null==e.name?null:e.name.length)),k(2),A("ngIf",i.hasDataElms&&e.isVisible)}}function _7(t,n){if(1&t){const e=et();E(0,"div",30)(1,"div",31),W(2),P(),E(3,"div",32)(4,"div",19)(5,"div",33)(6,"textarea",34),ue("ngModelChange",function(r){return Te(e).note.text=r}),P()(),E(7,"div",35),W(8),P()()()()}if(2&t){const e=n.note,i=G();A("ngClass",vi(4,mo,!i.isPointerDragging,i.isPointerDragging)),k(2),ht(e.title),k(4),A("ngModel",e.text),k(2),ht(e.text)}}function v7(t,n){if(1&t&&(E(0,"div",42),$e(1,"img",43),Ut(2,"safe"),P()),2&t){const e=G(2);A("ngClass",vi(5,mo,!e.isPointerDragging,e.isPointerDragging)),k(1),A("src",jt(2,2,e.imageUrl,"resourceUrl"),Ln)}}function y7(t,n){1&t&&wn(0)}function b7(t,n){if(1&t&&(Be(0),E(1,"div",28),Q(2,y7,1,0,"ng-container",12),P(),ze()),2&t){const e=G().$implicit;G(3);const i=en(20);k(2),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,qf,e))}}function C7(t,n){if(1&t&&(Be(0),Q(1,b7,3,4,"ng-container",5),ze()),2&t){const e=n.$implicit,i=G(3);k(1),A("ngIf",e&&e.name!==i.newLineString)}}function w7(t,n){if(1&t&&(E(0,"div",27),Q(1,C7,2,1,"ng-container",29),P()),2&t){const e=G(2);k(1),A("ngForOf",e.inventoryDataElms)}}function E7(t,n){if(1&t&&(E(0,"div",36),$e(1,"div",37),Q(2,v7,3,8,"div",38),E(3,"div",39),W(4),P(),$e(5,"div",40),E(6,"div",41),Q(7,w7,2,1,"div",18),P()()),2&t){const e=n.character,i=G();k(1),A("ngClass",vi(6,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),A("ngIf",i.hasImage),k(1),A("ngClass",vi(9,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),ht(e.name),k(2),A("ngClass",vi(12,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),A("ngIf",i.hasDataElms)}}function x7(t,n){if(1&t&&(Be(0),W(1),ze()),2&t){const e=G().dice;k(1),ht(e.face)}}function T7(t,n){1&t&&(Be(0),W(1,"???"),ze())}function D7(t,n){if(1&t&&(E(0,"div",45)(1,"div",25),W(2),P()()),2&t){const e=G().dice,i=G();A("ngClass",vi(2,mo,!i.isPointerDragging,i.isPointerDragging)),k(2),Bn("",e.ownerName," ")}}const S7=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function M7(t,n){if(1&t&&(E(0,"div",42),$e(1,"img",46),Ut(2,"safe"),P()),2&t){const e=G().dice,i=G();A("ngClass",vi(6,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),A("ngClass",vi(9,S7,!e.isVisible,e.isMine))("src",jt(2,3,i.imageUrl,"resourceUrl"),Ln)}}function k7(t,n){1&t&&wn(0)}function A7(t,n){if(1&t&&(Be(0),Q(1,k7,1,0,"ng-container",12),ze()),2&t){const e=G().$implicit;G(3);const i=en(20);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,qf,e))}}function I7(t,n){if(1&t&&(Be(0),Q(1,A7,2,4,"ng-container",5),ze()),2&t){const e=n.$implicit,i=G(3);k(1),A("ngIf",e&&e.name!==i.newLineString)}}function O7(t,n){if(1&t&&(E(0,"div",27)(1,"div",28),Q(2,I7,2,1,"ng-container",29),P()()),2&t){const e=G(2);k(2),A("ngForOf",e.dataElms)}}function P7(t,n){if(1&t&&(E(0,"div",36),$e(1,"div",37),E(2,"div",39),W(3),Q(4,x7,2,1,"ng-container",5),Q(5,T7,2,0,"ng-container",5),P(),Q(6,D7,3,5,"div",44),Q(7,M7,3,12,"div",38),$e(8,"div",40),E(9,"div",41),Q(10,O7,3,1,"div",18),P()()),2&t){const e=n.dice,i=G();k(1),A("ngClass",vi(9,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),A("ngClass",vi(12,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),Bn(" ",e.name,": "),k(1),A("ngIf",e.isVisible),k(1),A("ngIf",!e.isVisible),k(1),A("ngIf",e.hasOwner&&0<e.ownerName.length),k(1),A("ngIf",i.hasImage),k(2),A("ngClass",vi(15,mo,!i.isPointerDragging,i.isPointerDragging)),k(1),A("ngIf",i.hasDataElms&&e.isVisible)}}function F7(t,n){1&t&&wn(0)}function N7(t,n){if(1&t&&(E(0,"div",53),W(1),P()),2&t){const e=G(2).dataElm;k(1),ht(e.name)}}function R7(t,n){1&t&&wn(0)}function L7(t,n){if(1&t&&(Be(0),Q(1,R7,1,0,"ng-container",12),ze()),2&t){const e=n.$implicit;G(3);const i=en(20);k(1),A("ngTemplateOutlet",i)("ngTemplateOutletContext",Pt(2,qf,e))}}function B7(t,n){if(1&t&&(E(0,"div",50),Q(1,N7,2,1,"div",51),E(2,"div",52),Q(3,L7,2,4,"ng-container",29),P()()),2&t){const e=G().dataElm;k(1),A("ngIf",0<e.name.trim().length),k(2),A("ngForOf",e.children)}}function z7(t,n){if(1&t){const e=et();Be(0),E(1,"div",55)(2,"div"),W(3),P(),E(4,"div",56)(5,"div",33)(6,"textarea",34),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.value=r}),P()(),E(7,"div",35),W(8),P()()(),ze()}if(2&t){const e=G(2).dataElm;k(3),ht(e.name),k(3),A("ngModel",e.value),k(2),ht(e.value)}}function V7(t,n){if(1&t){const e=et();Be(0),E(1,"div",57),W(2),P(),E(3,"div",58)(4,"div",59)(5,"div",60),W(6),P(),E(7,"input",61),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.currentValue=r}),P()(),E(8,"div",62),W(9),P()(),E(10,"div",63)(11,"input",64),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.currentValue=r}),Ut(12,"safe"),P()(),ze()}if(2&t){const e=G(2).dataElm;k(2),ht(e.name),k(4),ht(e.currentValue),k(1),A("ngModel",e.currentValue),k(2),Bn(" / ",e.value,""),k(2),wr(jt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),sn("max",e.value),A("ngModel",e.currentValue)}}function U7(t,n){if(1&t){const e=et();Be(0),E(1,"div",57),W(2),P(),E(3,"div",58)(4,"div",65),W(5),P(),E(6,"input",66),ue("ngModelChange",function(r){return Te(e),G(2).dataElm.value=r}),P()(),ze()}if(2&t){const e=G(2).dataElm;k(2),ht(e.name),k(3),ht(e.value),k(1),A("ngModel",e.value)}}function j7(t,n){1&t&&(Be(0,2),Q(1,z7,9,3,"ng-container",3),Q(2,V7,13,11,"ng-container",3),Q(3,U7,7,3,"ng-container",4),ze(),$e(4,"div",54)),2&t&&(A("ngSwitch",G().dataElm.type),k(1),A("ngSwitchCase","note"),k(1),A("ngSwitchCase","numberResource"))}function H7(t,n){if(1&t&&(Q(0,F7,1,0,"ng-container",47),Q(1,B7,4,2,"ng-template",null,48,Pn),Q(3,j7,5,3,"ng-template",null,49,Pn)),2&t){const e=n.dataElm,i=en(2),r=en(4);A("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function G7(t,n){if(1&t){const e=et();E(0,"div",67),ue("click",function(){return Te(e),G().chanageImageView(!1)}),E(1,"div",68)(2,"i",22),W(3,"close"),P()(),$e(4,"img",69),Ut(5,"safe"),P()}if(2&t){const e=G();A("@fadeInOut","in"),k(4),A("src",jt(5,2,e.imageUrl,"resourceUrl"),Ln)}}let $7=(()=>{class t{constructor(e,i,r){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.tabletopObject=null,this.left=0,this.top=0,this.isOpenImageView=!1}get imageUrl(){return this.tabletopObject&&this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof bn)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){ve.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}}return t.\u0275fac=function(e){return new(e||t)(ee(N0),ee(Ni),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&Vn(G9,7),2&e){let r;zn(r=Un())&&(i.draggablePanel=r.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:23,vars:9,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass",4,"ngIf"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",3,"ngClass",4,"ngIf"],[1,"component-owner","position-right-bottom",3,"ngClass"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[1,"is-fill"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],[1,"tag"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input",3,"ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"hidden-spacer"],["size","1",1,"input",3,"ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,i){1&e&&(E(0,"div",0,1),Be(2,2),Q(3,$9,1,0,"ng-container",3),Q(4,Z9,2,4,"ng-container",3),Q(5,q9,2,4,"ng-container",3),Q(6,Q9,2,4,"ng-container",3),Q(7,e7,2,4,"ng-container",3),Q(8,i7,2,4,"ng-container",3),Q(9,o7,2,4,"ng-container",4),ze(),P(),Q(10,a7,2,1,"ng-container",5),Q(11,m7,5,7,"ng-template",null,6,Pn),Q(13,_7,9,7,"ng-template",null,7,Pn),Q(15,E7,8,15,"ng-template",null,8,Pn),Q(17,P7,11,18,"ng-template",null,9,Pn),Q(19,H7,5,3,"ng-template",null,10,Pn),Q(21,G7,6,5,"ng-template",null,11,Pn)),2&e&&(A("@fadeInOut","in"),k(2),A("ngSwitch",i.tabletopObject.aliasName),k(1),A("ngSwitchCase","numberResource"),k(1),A("ngSwitchCase","card"),k(1),A("ngSwitchCase","card-stack"),k(1),A("ngSwitchCase","text-note"),k(1),A("ngSwitchCase","character"),k(1),A("ngSwitchCase","dice-symbol"),k(2),A("ngIf",i.isOpenImageView))},directives:[PS,ba,mu,vu,_u,un,yi,Fn,bi,Li,Ci,Ea,Bs],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#ccc;background-color:#1e1e1ecc;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;max-height:120px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;border-radius:1em;z-index:1}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{width:100%;min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],data:{animation:[Ao("fadeInOut",[Ei("void => *",[wi("100ms ease-out",uo([_t({opacity:0,offset:0}),_t({opacity:1,offset:1})]))]),Ei("* => void",[wi("100ms ease-in",uo([_t({opacity:1,offset:0}),_t({opacity:0,offset:1})]))])])]},changeDetection:0}),t})(),BS=(()=>{class t{constructor(e,i,r,o){this.ngZone=e,this.viewContainerRef=i,this.componentFactoryResolver=r,this.pointerDeviceService=o,this.callbackOnMouseEnter=s=>this.onMouseEnter(s),this.callbackOnMouseLeave=s=>this.onMouseLeave(s),this.callbackOnMouseDown=s=>this.onMouseDown(s)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=ur.defaultParentViewContainerRef;const i=e.injector,r=this.componentFactoryResolver.resolveComponentFactory($7);this.tooltipComponentRef=e.createComponent(r,e.length,i),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),ve.register(this).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,ve.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(Zi),ee(Is),ee(Qn))},t.\u0275dir=gt({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),t})();function W7(t,n){if(1&t){const e=et();E(0,"div",2)(1,"div",3)(2,"div",4),Ut(3,"safe"),P(),E(4,"div",4),Ut(5,"safe"),P()(),E(6,"div",5)(7,"button",6),ue("click",function(){const o=Te(e).$implicit;return G().drawCard(o)}),W(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),P(),E(9,"button",0),ue("click",function(){const o=Te(e).$implicit;return G().showDetail(o)}),E(10,"i",7),W(11,"settings"),P(),W(12,"\u7de8\u96c6"),P(),$e(13,"br"),E(14,"button",0),ue("click",function(){const o=Te(e).$implicit;return G().up(o)}),W(15,"\u2191"),P(),E(16,"button",0),ue("click",function(){const o=Te(e).$implicit;return G().down(o)}),W(17,"\u2193"),P(),$e(18,"br"),P()()}if(2&t){const e=n.$implicit;k(1),A("appTooltip",e),k(1),an("background-image",jt(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),k(2),an("background-image",jt(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let Z7=(()=>{class t{constructor(e,i){this.panelService=e,this.changeDetector=i,this.cardStack=null,this.owner=He.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof bn&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){ve.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),We.play(Me.cardDraw)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),ve.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),We.play(Me.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(ee(rn),ee(Ni))},t.\u0275cmp=Bt({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(E(0,"div")(1,"button",0),ue("click",function(){return i.close(!0)}),W(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),P(),$e(3,"hr"),Q(4,W7,19,11,"div",1),P()),2&e&&(k(4),A("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},directives:[Fn,BS],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),t})();const j0=function(t){return{transform:t}};function Y7(t,n){if(1&t){const e=et();E(0,"img",6),ue("@shuffle.start",function(r){return Te(e),G().animationShuffleStarted(r)})("@shuffle.done",function(r){return Te(e),G().animationShuffleDone(r)}),Ut(1,"safe"),P()}if(2&t){const e=G();A("@shuffle",e.animeState)("ngStyle",Pt(6,j0,"rotateZ("+e.topCard.rotate+"deg)"))("src",jt(1,3,e.imageFile.url,"resourceUrl"),Ln)}}function q7(t,n){1&t&&(Be(0),E(1,"div",7)(2,"i",8),W(3,"autorenew"),P()(),E(4,"div",9)(5,"i",8),W(6,"autorenew"),P()(),E(7,"div",10)(8,"i",8),W(9,"autorenew"),P()(),E(10,"div",11)(11,"i",8),W(12,"autorenew"),P()(),ze())}function X7(t,n){if(1&t&&(E(0,"div",12)(1,"span"),W(2),P()()),2&t){const e=G();A("ngStyle",Pt(2,j0,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),k(2),Bn("",e.cards.length,"\u679a")}}function K7(t,n){if(1&t&&(E(0,"div",13)(1,"span"),W(2),P()()),2&t){const e=G();A("ngStyle",Pt(2,j0,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),k(2),Bn("",e.ownerName," \u304c\u78ba\u8a8d\u4e2d")}}const Q7=function(t){return{"is-empty":t}};let J7=(()=>{class t{constructor(e,i,r,o,s,a,l){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=l,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){ve.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof bn&&this.cardStack.contains(i)||i instanceof kt&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=kt.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Zo(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),ve.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Ki||e.detail instanceof gi))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Ki){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&this.cardStack.putOnTop(i)}else if(e.detail instanceof gi){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&this.concatStack(i)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&(console.log("onDoubleClick !!!!"),null!=this.drawCard()&&We.play(Me.cardDraw))}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&We.play(Me.cardDraw)}},Kn,{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),We.play(Me.cardDraw)}},{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),We.play(Me.cardDraw)}},Kn,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),We.play(Me.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),We.play(Me.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),We.play(Me.cardDraw)}},Kn,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),We.play(Me.cardShuffle),ve.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})}},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7",action:()=>{this.showStackList(this.cardStack)}},Kn,this.isShowTotal?{name:"\u679a\u6570\u3092\u975e\u8868\u793a\u306b\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u679a\u6570\u3092\u8868\u793a\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)}},Kn,{name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack(He.peerIds.length),We.play(Me.cardDraw)}},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),We.play(Me.cardShuffle)}},Kn,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.toTopmost(),We.play(Me.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),We.play(Me.sweep)}}],this.name)}onMove(){We.play(Me.cardPick)}onMoved(){We.play(Me.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let l=gi.create(this.cardStack.name);l.location.x=this.cardStack.location.x+50-100*Math.random(),l.location.y=this.cardStack.location.y+50-100*Math.random(),l.posZ=this.cardStack.posZ,l.location.name=this.cardStack.location.name,l.rotate=this.rotate,l.toTopmost(),i.push(l)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=gi.create(e.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}showDetail(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=He.peerContext.userId,this.panelService.open(Z7,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(ur),ee(rn),ee(On),ee(Ni),ee(bc),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&ue("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:11,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image chrome-smooth-image-trick",3,"ngStyle","src",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",3,"ngStyle"]],template:function(e,i){1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),E(1,"div",1),ue("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,Y7,2,8,"img",2),Q(3,q7,13,0,"ng-container",3),Q(4,X7,3,4,"div",4),Q(5,K7,3,4,"div",5),P()()),2&e&&(an("width",i.size*i.gridSize,"px"),A("ngClass",Pt(9,Q7,i.isEmpty))("movable.option",i.movableOption),k(1),A("rotable.option",i.rotableOption),k(1),A("ngIf",i.topCard&&i.imageFile),k(1),A("ngIf",!i.isIconHidden),k(1),A("ngIf",i.isShowTotal),k(1),A("ngIf",i.hasOwner))},directives:[Za,yi,Cc,un,Ca],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("shuffle",[__("active",_t({transform:""})),Ei("* => active",[wi("800ms ease",uo([_t({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),_t({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),_t({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),_t({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),_t({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])])]},changeDetection:0}),t})();function eG(t,n){if(1&t&&($e(0,"img",6),Ut(1,"safe")),2&t){const e=G();A("src",jt(1,1,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),Ln)}}const tG=function(t){return{transform:t}};function nG(t,n){if(1&t&&(E(0,"div",7)(1,"span"),W(2),P()()),2&t){const e=G();A("ngStyle",Pt(2,tG,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),k(2),ht(e.ownerName)}}function iG(t,n){1&t&&($e(0,"img",8),Ut(1,"safe")),2&t&&A("src",jt(1,1,G().frontImage.url,"resourceUrl"),Ln)}function rG(t,n){1&t&&(Be(0),E(1,"div",9)(2,"i",10),W(3,"autorenew"),P()(),E(4,"div",11)(5,"i",10),W(6,"autorenew"),P()(),E(7,"div",12)(8,"i",10),W(9,"autorenew"),P()(),E(10,"div",13)(11,"i",10),W(12,"autorenew"),P()(),$e(13,"div",14),ze())}let oG=(()=>{class t{constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.imageService=l,this.pointerDeviceService=c,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerName(){return this.card.ownerName}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof bn&&this.card.contains(i)||i instanceof kt&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=kt.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Zo(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),ve.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Ki||e.detail instanceof gi)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof gi)){let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){if(console.log("onDoubleClick !!!!"),this.hasOwner&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?ps.BACK:ps.FRONT,this.owner="",We.play(Me.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[!this.isVisible||this.isHand?{name:"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),We.play(Me.cardDraw)}}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),We.play(Me.cardDraw)}},this.isHand?{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),We.play(Me.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{We.play(Me.cardDraw),this.card.faceDown(),this.owner=He.peerContext.userId}},Kn,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),We.play(Me.cardPut)}},Kn,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),We.play(Me.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),We.play(Me.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),We.play(Me.cardPick)}onMoved(){We.play(Me.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=gi.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(ur),ee(rn),ee(On),ee(Ni),ee(L0),ee(bc),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&ue("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},decls:6,vars:8,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background",3,"ngStyle"],[1,"card-image","thumbnail-transform","is-translucent","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"border-bg","is-pointer-events-none"]],template:function(e,i){1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),E(1,"div",1),ue("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,eG,2,4,"img",2),Q(3,nG,3,4,"div",3),Q(4,iG,2,4,"img",4),Q(5,rG,14,0,"ng-container",5),P()()),2&e&&(an("width",i.size*i.gridSize,"px"),A("movable.option",i.movableOption),k(1),A("rotable.option",i.rotableOption),k(1),A("ngIf",i.imageFile),k(1),A("ngIf",!i.isFront&&i.hasOwner&&0<i.ownerName.length),k(1),A("ngIf",i.isHand&&i.frontImage),k(1),A("ngIf",!i.isIconHidden))},directives:[Za,Cc,un,Ca],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),t})();function sG(t,n){1&t&&(Be(0),E(1,"div",11)(2,"div",12)(3,"div",13),W(4,"autorenew"),P(),E(5,"div",14),W(6,"autorenew"),P()()(),ze())}function aG(t,n){if(1&t&&(E(0,"span"),W(1),P()),2&t){const e=G(3);k(1),ht(e.face)}}function lG(t,n){1&t&&(E(0,"span"),W(1,"???"),P())}const zS=function(t){return{transform:t}};function cG(t,n){if(1&t&&(E(0,"div",17)(1,"div"),W(2),Q(3,aG,2,1,"span",5),Q(4,lG,2,0,"span",5),P()()),2&t){const e=G().$implicit,i=G();A("ngStyle",Pt(4,zS,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),k(2),Bn("",i.name,":"),k(1),A("ngIf",i.isVisible),k(1),A("ngIf",!i.isVisible)}}function uG(t,n){if(1&t&&(E(0,"div",18)(1,"div"),W(2),P()()),2&t){const e=G().$implicit,i=G();A("ngStyle",Pt(2,zS,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),k(2),ht(i.ownerName)}}function dG(t,n){if(1&t&&(Be(0),Q(1,cG,5,6,"div",15),Q(2,uG,3,4,"div",16),ze()),2&t){const e=G();k(1),A("ngIf",0<e.name.length),k(1),A("ngIf",e.hasOwner&&0<e.ownerName.length)}}const hG=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function fG(t,n){if(1&t&&($e(0,"img",19),Ut(1,"safe")),2&t){const e=G();A("src",jt(1,2,e.imageFile.url,"resourceUrl"),Ln)("ngClass",vi(5,hG,!e.isVisible,e.isMine))}}const pG=function(t){return{"is-gray-border":t}},gG=function(){return["0","180deg"]};let mG=(()=>{class t{constructor(e,i,r,o,s,a,l){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=l,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get isVisible(){return this.diceSymbol.isVisible}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){ve.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof bn&&this.diceSymbol.contains(i)||i instanceof kt&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=kt.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Zo(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(this.isVisible&&r.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()}}),r.push(Kn),(this.isMine||this.hasOwner)&&r.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",We.play(Me.unlock)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=He.peerContext.userId,We.play(Me.lock)}}),this.isVisible){let o=[];this.faces.forEach(s=>{o.push({name:`${s}`,action:()=>{this.face=s,We.play(Me.dicePut)}})}),r.push({name:"\u30c0\u30a4\u30b9\u76ee\u3092\u8a2d\u5b9a",action:null,subActions:o})}r.push(Kn),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.diceSymbol.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.update(),We.play(Me.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),We.play(Me.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){We.play(Me.dicePick)}onMoved(){We.play(Me.dicePut)}diceRoll(){return ve.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),We.play(Me.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(rn),ee(ur),ee(On),ee(Ni),ee(bc),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&ue("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:12,vars:19,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[4,"ngFor","ngForOf"],["class","image chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"owner-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"image","chrome-smooth-image-trick",3,"src","ngClass"]],template:function(e,i){1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),E(1,"div",1)(2,"div",2),ue("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),$e(3,"div",3)(4,"div",4),Q(5,sG,7,0,"ng-container",5),E(6,"div",1),ue("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),E(7,"div",6)(8,"div",7)(9,"div",8),Q(10,dG,3,2,"ng-container",9),Q(11,fG,2,8,"img",10),P()()()()()()()),2&e&&(an("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),A("movable.option",i.movableOption),k(1),A("@bounceInOut","in"),k(1),A("rotable.option",i.rotableOption),k(1),A("ngClass",Pt(16,pG,i.hasOwner)),k(2),A("ngIf",!i.isIconHidden),k(1),A("@diceRoll",i.animeState),k(2),an("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),k(2),A("ngForOf",ma(18,gG)),k(1),A("ngIf",0<i.imageFile.url.length))},directives:[Za,Cc,yi,un,Fn,Ca],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("diceRoll",[Ei("* => active",[wi("800ms ease",uo([_t({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),_t({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),_t({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),_t({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),_t({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])]),Ao("bounceInOut",[Ei("void => *",[wi("600ms ease",uo([_t({transform:"scale3d(0, 0, 0)",offset:0}),_t({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),_t({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),_t({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),_t({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Ei("* => void",[wi(100,_t({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const H0=function(t){return{transform:t}};function _G(t,n){if(1&t&&(E(0,"div",18)(1,"div",19),W(2),P()()),2&t){const e=n.$implicit,i=G(2);A("ngStyle",Pt(2,H0,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),k(2),ht(i.name)}}const vG=function(){return["0","180deg"]};function yG(t,n){1&t&&(Be(0),Q(1,_G,3,4,"div",17),ze()),2&t&&(k(1),A("ngForOf",ma(1,vG)))}function bG(t,n){1&t&&($e(0,"img",20),Ut(1,"safe")),2&t&&A("src",jt(1,1,G().imageFile.url,"resourceUrl"),Ln)}let CG=(()=>{class t{constructor(e,i,r,o){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=o,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}ngOnInit(){ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Oe.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof bn&&this.gameCharacter.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){}ngOnDestroy(){ve.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},Kn,{name:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("common"),We.play(Me.piecePut)}},{name:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation(He.peerId),We.play(Me.piecePut)}},{name:"\u5893\u5834\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("graveyard"),We.play(Me.sweep)}},Kn,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),We.play(Me.piecePut)}}],this.name)}onMove(){We.play(Me.piecePick)}onMoved(){We.play(Me.piecePut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(kS,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}}return t.\u0275fac=function(e){return new(e||t)(ee(ur),ee(rn),ee(Ni),ee(Qn))},t.\u0275cmp=Bt({type:t,selectors:[["game-character"]],hostBindings:function(e,i){1&e&&ue("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:22,vars:20,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"upright-transform","is-fit-width","is-3d"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],[4,"ngIf"],["class","image chrome-smooth-image-trick",3,"src",4,"ngIf"],[1,"rotate-grab","rotate-grab-icon","of-top",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom",3,"ngStyle"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngFor","ngForOf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"has-length-limit"],[1,"image","chrome-smooth-image-trick",3,"src"]],template:function(e,i){1&e&&(E(0,"div",0),ue("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),E(1,"div",1)(2,"div",2),ue("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),$e(3,"div",3)(4,"div",4),E(5,"div",5)(6,"div",6)(7,"div",7),W(8,"autorenew"),P(),E(9,"div",8),W(10,"autorenew"),P()()(),E(11,"div",9)(12,"div",10),ue("rotable.valueChange",function(o){return i.roll=o})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),E(13,"div",11),Q(14,yG,2,2,"ng-container",12),Q(15,bG,2,4,"img",13),E(16,"div",14)(17,"i",15),W(18,"autorenew"),P()(),E(19,"div",16)(20,"i",15),W(21,"autorenew"),P()()()()()()()()),2&e&&(an("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),A("movable.option",i.movableOption),k(1),A("@bounceInOut","in"),k(1),A("rotable.option",i.rotableOption),k(10),an("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),A("rotable.value",i.roll),k(2),A("ngIf",0<i.name.length),k(1),A("ngIf",0<i.imageFile.url.length),k(1),A("ngStyle",Pt(16,H0,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px)")),k(3),A("ngStyle",Pt(18,H0,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")))},directives:[Za,Cc,un,Fn,Ca],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:-30px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("bounceInOut",[Ei("void => *",[wi("600ms ease",uo([_t({transform:"scale3d(0, 0, 0)",offset:0}),_t({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),_t({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),_t({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),_t({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Ei("* => void",[wi(100,_t({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const wG=["cursor"],EG=["opacity"];function xG(t,n){if(1&t&&(E(0,"div",6)(1,"div",7),Ut(2,"safe"),E(3,"div",8)(4,"span",9),W(5),P()()()()),2&t){const e=n.$implicit,i=G(2);A("ngClass",e),k(1),an("background-image",jt(2,4,"url("+i.iconUrl+")","style")),k(4),ht(i.name)}}const TG=function(){return["is-front","is-back"]};function DG(t,n){1&t&&(Be(0),E(1,"div",1,2)(3,"div",3,4),Q(5,xG,6,7,"div",5),P()(),ze()),2&t&&(k(5),A("ngForOf",ma(1,TG)))}let SG=(()=>{class t{constructor(e,i,r){this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=kt.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get delayMs(){let e=16.6*He.peerIds.length;return e<100?100:e}ngOnInit(){this.isMine||ve.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut()},this)})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),ve.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(e){let i=e.touches?e.changedTouches[0].pageX:e.pageX,r=e.touches?e.changedTouches[0].pageY:e.pageY;i===this._x&&r===this._y||(this._x=i,this._y=r,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,i,r){if(!document.getElementById("app-table-layer").contains(r))return;let o={x:e,y:i,z:0};o=this.coordinateService.calcTabletopLocalCoordinate(o,r),ve.call("CURSOR_MOVE",[o.x,o.y,o.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new ds(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,i,r){this.cursorElement.style.transform=`translateX(${e.toFixed(4)}px) translateY(${i.toFixed(4)}px) translateZ(${r.toFixed(4)}px)`}}return t.\u0275fac=function(e){return new(e||t)(ee(Yf),ee(ja),ee(Gt))},t.\u0275cmp=Bt({type:t,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(Vn(wG,5),Vn(EG,5)),2&e){let r;zn(r=Un())&&(i.cursorElementRef=r.first),zn(r=Un())&&(i.opacityElementRef=r.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-front",3,"ngClass",4,"ngFor","ngForOf"],[1,"peer-cursor","is-front",3,"ngClass"],[1,"icon"],[1,"name","is-center"],[2,"white-space","nowrap"]],template:function(e,i){1&e&&Q(0,DG,6,2,"ng-container",0),2&e&&A("ngIf",!i.isMine)},directives:[un,Fn,yi],pipes:[Wn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;background-color:#f0dabde6;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),t})();const MG=["root"],kG=["gameTable"],AG=["gameObjects"],IG=["gridCanvas"];function OG(t,n){1&t&&$e(0,"terrain",17),2&t&&A("terrain",n.$implicit)}function PG(t,n){1&t&&$e(0,"game-table-mask",18),2&t&&A("gameTableMask",n.$implicit)}const FG=function(t){return{"z-index":t}};function NG(t,n){if(1&t&&$e(0,"text-note",19),2&t){const e=n.$implicit;A("textNote",e)("appTooltip",e)("ngStyle",Pt(3,FG,e.zindex))}}const VS=function(t,n){return{"z-index":t,transform:n}};function RG(t,n){if(1&t&&$e(0,"card-stack",20),2&t){const e=n.$implicit;A("cardStack",e)("appTooltip",e)("ngStyle",vi(3,VS,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function LG(t,n){if(1&t&&$e(0,"card",21),2&t){const e=n.$implicit;A("card",e)("appTooltip",e)("ngStyle",vi(3,VS,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function BG(t,n){if(1&t&&$e(0,"dice-symbol",22),2&t){const e=n.$implicit;A("diceSymbol",e)("appTooltip",e)}}function zG(t,n){if(1&t&&$e(0,"game-character",23),2&t){const e=n.$implicit;A("gameCharacter",e)("appTooltip",e)}}function VG(t,n){1&t&&$e(0,"peer-cursor",24),2&t&&A("cursor",n.$implicit)}const UG=function(t,n){return[t,n]},jG=function(t){return{"is-grabbing":t}};let HG=(()=>{class t{constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=l,this.modalService=c,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}ngOnInit(){ve.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){ve.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new E9(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new w9(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(Kn),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(AS)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a){this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r,this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=gs.SQUARE,s="#000000e6"){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new C9(this.gridCanvas.nativeElement).render(e,i,r,o,s),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(ee(Gt),ee(ur),ee(Qn),ee(ja),ee(bc),ee(L0),ee(U0),ee(Di))},t.\u0275cmp=Bt({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(Vn(MG,7),Vn(kG,7),Vn(AG,7),Vn(IG,7)),2&e){let r;zn(r=Un())&&(i.rootElementRef=r.first),zn(r=Un())&&(i.gameTable=r.first),zn(r=Un())&&(i.gameObjects=r.first),zn(r=Un())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&ue("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,$d)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,$d)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,$d)},decls:19,vars:33,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none"],["gridCanvas",""],["class","is-3d",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(E(0,"div",0),Ut(1,"safe"),P(),E(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Ut(8,"safe"),$e(9,"canvas",7,8),Q(11,OG,1,1,"terrain",9),Q(12,PG,1,1,"game-table-mask",10),Q(13,NG,1,5,"text-note",11),Q(14,RG,1,6,"card-stack",12),Q(15,LG,1,6,"card",13),Q(16,BG,1,2,"dice-symbol",14),Q(17,zG,1,2,"game-character",15),Q(18,VG,1,1,"peer-cursor",16),P()()()),2&e&&(an("background-image",jt(1,22,"url("+i.backgroundImage.url+")","style")),A("ngClass",vi(28,UG,i.backgroundFilterType?"is-filter":"",i.backgroundFilterType)),k(2),A("ngClass",Pt(31,jG,i.isPointerDragging)),k(4),an("background-image",jt(8,25,"url("+i.tableImage.url+")","style")),k(5),A("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),k(1),A("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},directives:[yi,Fn,P9,z9,H9,BS,Ca,J7,oG,mG,CG,SG],pipes:[Wn],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}']}),t})(),GG=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};ve.register(this).on("*",i=>{this.needRepeat||He.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){ve.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(ee(On))},t.\u0275cmp=Bt({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(E(0,"div",0),$e(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),E(10,"div",10),W(11,"sync"),P()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();const $G=["modalLayer"];function WG(t,n){if(1&t){const e=et();E(0,"li",2),ue("click",function(){return Te(e),G().save()}),E(1,"a",3)(2,"div")(3,"i",5),W(4,"sd_storage"),P()(),E(5,"div"),W(6,"\u4fdd\u5b58"),P()()()}}function ZG(t,n){if(1&t&&(E(0,"li",11)(1,"a")(2,"div")(3,"i",12),W(4,"sd_storage"),P()(),E(5,"div"),W(6),P()()()),2&t){const e=G();k(6),Bn("",e.progresPercent,"%")}}let YG=(()=>{class t{constructor(e,i,r,o,s,a,l){var c=this;this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=a,this.ngZone=l,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.ngZone.runOutsideAngular(()=>{$o.instance.initialize(),vc.instance.initialize(),mc.instance.initialize(),yc.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Ho.instance.initialize(),zo.instance.initialize(),Uo.instance.initialize(),new go("DiceBot").initialize(),go.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new $a("Jukebox").initialize(),new We("SoundEffect").initialize(),zo.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),zo.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");let w=Qt.createEmpty("none_icon").toContext();w.url="./assets/images/ic_account_circle_black_24dp_2x.png";let R=vt.instance.add(w);nt.resumeAudioContext(),Me.dicePick=ct.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Me.dicePut=ct.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Me.diceRoll1=ct.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Me.diceRoll2=ct.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Me.cardDraw=ct.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Me.cardPick=ct.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Me.cardPut=ct.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Me.cardShuffle=ct.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Me.piecePick=ct.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Me.piecePut=ct.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Me.blockPick=ct.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Me.blockPut=ct.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Me.lock=ct.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Me.unlock=ct.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Me.sweep=ct.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,ct.instance.get(Me.dicePick).isHidden=!0,ct.instance.get(Me.dicePut).isHidden=!0,ct.instance.get(Me.diceRoll1).isHidden=!0,ct.instance.get(Me.diceRoll2).isHidden=!0,ct.instance.get(Me.cardDraw).isHidden=!0,ct.instance.get(Me.cardPick).isHidden=!0,ct.instance.get(Me.cardPut).isHidden=!0,ct.instance.get(Me.cardShuffle).isHidden=!0,ct.instance.get(Me.piecePick).isHidden=!0,ct.instance.get(Me.piecePut).isHidden=!0,ct.instance.get(Me.blockPick).isHidden=!0,ct.instance.get(Me.blockPut).isHidden=!0,ct.instance.get(Me.lock).isHidden=!0,ct.instance.get(Me.unlock).isHidden=!0,ct.instance.get(Me.sweep).isHidden=!0,kt.createMyCursor(),kt.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc",kt.myCursor.imageIdentifier=R.identifier,ve.register(this).on("UPDATE_GAME_OBJECT",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("DELETE_GAME_OBJECT",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",Z=>{Z.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",Z=>{Z.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",Z=>{console.log("LOAD_CONFIG !!!"),He.setApiKey(Z.data.webrtc.key),He.open()}).on("FILE_LOADED",Z=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",Z=>{console.log("OPEN_NETWORK",Z.data.peerId),kt.myCursor.peerId=He.peerContext.peerId,kt.myCursor.userId=He.peerContext.userId}).on("NETWORK_ERROR",Z=>{console.log("NETWORK_ERROR",Z.data.peerId);let re=Z.data.errorType,le=Z.data.errorMessage;this.ngZone.run((0,Tt.Z)(function*(){["peer-unavailable"].includes(re)||(yield c.modalService.open(V0,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:le}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(re)&&(yield c.modalService.open(V0,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),He.open()))}))}).on("CONNECT_PEER",Z=>{Z.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("DISCONNECT_PEER",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)})}ngAfterViewInit(){rn.defaultParentViewContainerRef=Di.defaultParentViewContainerRef=ur.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(()=>{this.panelService.open(IS,{width:500,height:450,left:100}),this.panelService.open(MS,{width:700,height:400,left:100,top:450})},0)}ngOnDestroy(){ve.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":i=IS;break;case"ChatWindowComponent":i=MS,r.width=700;break;case"GameTableSettingComponent":i=AS,r={width:630,height:400,left:100};break;case"FileStorageComponent":i=BU;break;case"GameCharacterSheetComponent":i=Wo;break;case"JukeboxComponent":i=kH;break;case"GameCharacterGeneratorComponent":i=HU,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=lH}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,Tt.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=He.peerContext&&0<He.peerContext.roomName.length?He.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&$o.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}}return t.\u0275fac=function(e){return new(e||t)(ee(Di),ee(rn),ee(Qn),ee(Va),ee(O0),ee(Sr),ee(Gt))},t.\u0275cmp=Bt({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&Vn($G,7,Zi),2&e){let r;zn(r=Un())&&(i.modalLayerViewContainerRef=r.first)}},decls:61,vars:8,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","showTitleButtons"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(E(0,"div",0),$e(1,"game-table"),P(),E(2,"ui-panel",1)(3,"nav")(4,"ul")(5,"li",2),ue("click",function(){return i.open("PeerMenuComponent")}),E(6,"a",3)(7,"div")(8,"i",4),W(9,"people"),P()(),E(10,"div"),W(11,"\u63a5\u7d9a"),P()()(),E(12,"li",2),ue("click",function(){return i.open("ChatWindowComponent")}),E(13,"a",3)(14,"div")(15,"i",4),W(16,"speaker_notes"),P()(),E(17,"div"),W(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),P()()(),E(19,"li",2),ue("click",function(){return i.open("GameTableSettingComponent")}),E(20,"a",3)(21,"div")(22,"i",4),W(23,"layers"),P()(),E(24,"div"),W(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),P()()(),E(26,"li",2),ue("click",function(){return i.open("FileStorageComponent")}),E(27,"a",3)(28,"div")(29,"i",4),W(30,"photo_library"),P()(),E(31,"div"),W(32,"\u753b\u50cf"),P()()(),E(33,"li",2),ue("click",function(){return i.open("JukeboxComponent")}),E(34,"a",3)(35,"div")(36,"i",5),W(37,"queue_music"),P()(),E(38,"div"),W(39,"\u97f3\u697d"),P()()(),E(40,"li",2),ue("click",function(){return i.open("GameObjectInventoryComponent")}),E(41,"a",3)(42,"div")(43,"i",4),W(44,"folder_shared"),P()(),E(45,"div"),W(46,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),P()()(),E(47,"li")(48,"a",3)(49,"label")(50,"div")(51,"i",5),W(52,"open_in_browser"),P()(),E(53,"div"),W(54,"ZIP\u8aad\u8fbc"),P(),E(55,"input",6),ue("change",function(o){return i.handleFileSelect(o)}),P()()()(),Q(56,WG,7,0,"li",7),Q(57,ZG,7,1,"li",8),P()()(),$e(58,"div",null,9)(60,"network-indicator",10)),2&e&&(k(2),A("top",0)("left",0)("width",100)("height",470)("title","\u30e1\u30cb\u30e5\u30fc")("showTitleButtons",!1),k(54),A("ngIf",!i.isSaveing),k(1),A("ngIf",i.isSaveing))},directives:[HG,FS,un,GG],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:vibration .2s infinite}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}"]}),t})();rn.UIPanelComponentClass=FS,ur.ContextMenuComponentClass=FU,Di.ModalComponentClass=OH;let qG=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Jo({type:t,bootstrap:[YG]}),t.\u0275inj=yo({providers:[O0,Va,ur,Di,N0,rn,Qn,L0],imports:[[Ww,n5,Pw,rL]]}),t})();(function BP(){aw=!1})(),UN().bootstrapModule(qG).catch(t=>console.error(t))},7585:function(Xe,N,q){var M;Xe.exports=(M=M||function(O,D){var f;if("undefined"!=typeof window&&window.crypto&&(f=window.crypto),"undefined"!=typeof self&&self.crypto&&(f=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(f=globalThis.crypto),!f&&"undefined"!=typeof window&&window.msCrypto&&(f=window.msCrypto),!f&&"undefined"!=typeof global&&global.crypto&&(f=global.crypto),!f)try{f=q(2480)}catch(B){}var p=function(){if(f){if("function"==typeof f.getRandomValues)try{return f.getRandomValues(new Uint32Array(1))[0]}catch(B){}if("function"==typeof f.randomBytes)try{return f.randomBytes(4).readInt32LE()}catch(B){}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function B(){}return function(j){var z;return B.prototype=j,z=new B,B.prototype=null,z}}(),x={},S=x.lib={},m=S.Base={extend:function(B){var j=C(this);return B&&j.mixIn(B),(!j.hasOwnProperty("init")||this.init===j.init)&&(j.init=function(){j.$super.init.apply(this,arguments)}),j.init.prototype=j,j.$super=this,j},create:function(){var B=this.extend();return B.init.apply(B,arguments),B},init:function(){},mixIn:function(B){for(var j in B)B.hasOwnProperty(j)&&(this[j]=B[j]);B.hasOwnProperty("toString")&&(this.toString=B.toString)},clone:function(){return this.init.prototype.extend(this)}},d=S.WordArray=m.extend({init:function(B,j){B=this.words=B||[],this.sigBytes=null!=j?j:4*B.length},toString:function(B){return(B||v).stringify(this)},concat:function(B){var j=this.words,z=B.words,te=this.sigBytes,ne=B.sigBytes;if(this.clamp(),te%4)for(var K=0;K<ne;K++)j[te+K>>>2]|=(z[K>>>2]>>>24-K%4*8&255)<<24-(te+K)%4*8;else for(var $=0;$<ne;$+=4)j[te+$>>>2]=z[$>>>2];return this.sigBytes+=ne,this},clamp:function(){var B=this.words,j=this.sigBytes;B[j>>>2]&=4294967295<<32-j%4*8,B.length=O.ceil(j/4)},clone:function(){var B=m.clone.call(this);return B.words=this.words.slice(0),B},random:function(B){for(var j=[],z=0;z<B;z+=4)j.push(p());return new d.init(j,B)}}),_=x.enc={},v=_.Hex={stringify:function(B){for(var j=B.words,z=B.sigBytes,te=[],ne=0;ne<z;ne++){var K=j[ne>>>2]>>>24-ne%4*8&255;te.push((K>>>4).toString(16)),te.push((15&K).toString(16))}return te.join("")},parse:function(B){for(var j=B.length,z=[],te=0;te<j;te+=2)z[te>>>3]|=parseInt(B.substr(te,2),16)<<24-te%8*4;return new d.init(z,j/2)}},I=_.Latin1={stringify:function(B){for(var j=B.words,z=B.sigBytes,te=[],ne=0;ne<z;ne++)te.push(String.fromCharCode(j[ne>>>2]>>>24-ne%4*8&255));return te.join("")},parse:function(B){for(var j=B.length,z=[],te=0;te<j;te++)z[te>>>2]|=(255&B.charCodeAt(te))<<24-te%4*8;return new d.init(z,j)}},T=_.Utf8={stringify:function(B){try{return decodeURIComponent(escape(I.stringify(B)))}catch(j){throw new Error("Malformed UTF-8 data")}},parse:function(B){return I.parse(unescape(encodeURIComponent(B)))}},L=S.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(B){"string"==typeof B&&(B=T.parse(B)),this._data.concat(B),this._nDataBytes+=B.sigBytes},_process:function(B){var j,z=this._data,te=z.words,ne=z.sigBytes,K=this.blockSize,$=ne/(4*K),ae=($=B?O.ceil($):O.max((0|$)-this._minBufferSize,0))*K,b=O.min(4*ae,ne);if(ae){for(var fe=0;fe<ae;fe+=K)this._doProcessBlock(te,fe);j=te.splice(0,ae),z.sigBytes-=b}return new d.init(j,b)},clone:function(){var B=m.clone.call(this);return B._data=this._data.clone(),B},_minBufferSize:0}),oe=(S.Hasher=L.extend({cfg:m.extend(),init:function(B){this.cfg=this.cfg.extend(B),this.reset()},reset:function(){L.reset.call(this),this._doReset()},update:function(B){return this._append(B),this._process(),this},finalize:function(B){return B&&this._append(B),this._doFinalize()},blockSize:16,_createHelper:function(B){return function(j,z){return new B.init(z).finalize(j)}},_createHmacHelper:function(B){return function(j,z){return new oe.HMAC.init(B,z).finalize(j)}}}),x.algo={});return x}(Math),M)},7412:function(Xe,N,q){var M;Xe.exports=(M=q(7585),function(){if("function"==typeof ArrayBuffer){var f=M.lib.WordArray,p=f.init,C=f.init=function(x){if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),(x instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&x instanceof Uint8ClampedArray||x instanceof Int16Array||x instanceof Uint16Array||x instanceof Int32Array||x instanceof Uint32Array||x instanceof Float32Array||x instanceof Float64Array)&&(x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength)),x instanceof Uint8Array){for(var S=x.byteLength,m=[],d=0;d<S;d++)m[d>>>2]|=x[d]<<24-d%4*8;p.call(this,m,S)}else p.apply(this,arguments)};C.prototype=f}}(),M.lib.WordArray)},1817:function(Xe,N,q){var M;Xe.exports=(M=q(7585),function(O){var D=M,f=D.lib,p=f.WordArray,C=f.Hasher,x=D.algo,S=[],m=[];!function(){function v(Y){for(var oe=O.sqrt(Y),B=2;B<=oe;B++)if(!(Y%B))return!1;return!0}function I(Y){return 4294967296*(Y-(0|Y))|0}for(var T=2,L=0;L<64;)v(T)&&(L<8&&(S[L]=I(O.pow(T,.5))),m[L]=I(O.pow(T,1/3)),L++),T++}();var d=[],_=x.SHA256=C.extend({_doReset:function(){this._hash=new p.init(S.slice(0))},_doProcessBlock:function(v,I){for(var T=this._hash.words,L=T[0],Y=T[1],oe=T[2],B=T[3],j=T[4],z=T[5],te=T[6],ne=T[7],K=0;K<64;K++){if(K<16)d[K]=0|v[I+K];else{var Ce=d[K-15],ae=d[K-2];d[K]=((Ce<<25|Ce>>>7)^(Ce<<14|Ce>>>18)^Ce>>>3)+d[K-7]+((ae<<15|ae>>>17)^(ae<<13|ae>>>19)^ae>>>10)+d[K-16]}var Ne=L&Y^L&oe^Y&oe,_e=ne+((j<<26|j>>>6)^(j<<21|j>>>11)^(j<<7|j>>>25))+(j&z^~j&te)+m[K]+d[K];ne=te,te=z,z=j,j=B+_e|0,B=oe,oe=Y,Y=L,L=_e+(((L<<30|L>>>2)^(L<<19|L>>>13)^(L<<10|L>>>22))+Ne)|0}T[0]=T[0]+L|0,T[1]=T[1]+Y|0,T[2]=T[2]+oe|0,T[3]=T[3]+B|0,T[4]=T[4]+j|0,T[5]=T[5]+z|0,T[6]=T[6]+te|0,T[7]=T[7]+ne|0},_doFinalize:function(){var v=this._data,I=v.words,T=8*this._nDataBytes,L=8*v.sigBytes;return I[L>>>5]|=128<<24-L%32,I[14+(L+64>>>9<<4)]=O.floor(T/4294967296),I[15+(L+64>>>9<<4)]=T,v.sigBytes=4*I.length,this._process(),this._hash},clone:function(){var v=C.clone.call(this);return v._hash=this._hash.clone(),v}});D.SHA256=C._createHelper(_),D.HmacSHA256=C._createHmacHelper(_)}(Math),M.SHA256)},6654:Xe=>{!function(q){Xe.exports=q;var M="listeners",O={on:function f(m,d){return S(this,m).push(d),this},once:function p(m,d){var _=this;return v.originalListener=d,S(_,m).push(v),_;function v(){C.call(_,m,v),d.apply(this,arguments)}},off:C,emit:function x(m,d){var _=this,v=S(_,m,!0);if(!v)return!1;var I=arguments.length;if(1===I)v.forEach(L);else if(2===I)v.forEach(Y);else{var T=Array.prototype.slice.call(arguments,1);v.forEach(oe)}return!!v.length;function L(B){B.call(_)}function Y(B){B.call(_,d)}function oe(B){B.apply(_,T)}}};function D(m){for(var d in O)m[d]=O[d];return m}function C(m,d){var v,_=this;if(arguments.length){if(d){if(v=S(_,m,!0)){if(!(v=v.filter(I)).length)return C.call(_,m);_[M][m]=v}}else if((v=_[M])&&(delete v[m],!Object.keys(v).length))return C.call(_)}else delete _[M];return _;function I(T){return T!==d&&T.originalListener!==d}}function S(m,d,_){if(!_||m[M]){var v=m[M]||(m[M]={});return v[d]||(v[d]=[])}}D(q.prototype),q.mixin=D}(function N(){if(!(this instanceof N))return new N})},9069:Xe=>{"use strict";var M,N="object"==typeof Reflect?Reflect:null,q=N&&"function"==typeof N.apply?N.apply:function(z,te,ne){return Function.prototype.apply.call(z,te,ne)};M=N&&"function"==typeof N.ownKeys?N.ownKeys:Object.getOwnPropertySymbols?function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:function(z){return Object.getOwnPropertyNames(z)};var D=Number.isNaN||function(z){return z!=z};function f(){f.init.call(this)}Xe.exports=f,Xe.exports.once=function Y(j,z){return new Promise(function(te,ne){function K($){j.removeListener(z,Ce),ne($)}function Ce(){"function"==typeof j.removeListener&&j.removeListener("error",K),te([].slice.call(arguments))}B(j,z,Ce,{once:!0}),"error"!==z&&function oe(j,z,te){"function"==typeof j.on&&B(j,"error",z,te)}(j,K,{once:!0})})},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var p=10;function C(j){if("function"!=typeof j)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof j)}function x(j){return void 0===j._maxListeners?f.defaultMaxListeners:j._maxListeners}function S(j,z,te,ne){var K,Ce,$;if(C(te),void 0===(Ce=j._events)?(Ce=j._events=Object.create(null),j._eventsCount=0):(void 0!==Ce.newListener&&(j.emit("newListener",z,te.listener?te.listener:te),Ce=j._events),$=Ce[z]),void 0===$)$=Ce[z]=te,++j._eventsCount;else if("function"==typeof $?$=Ce[z]=ne?[te,$]:[$,te]:ne?$.unshift(te):$.push(te),(K=x(j))>0&&$.length>K&&!$.warned){$.warned=!0;var ae=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");ae.name="MaxListenersExceededWarning",ae.emitter=j,ae.type=z,ae.count=$.length,function O(j){console&&console.warn&&console.warn(j)}(ae)}return j}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(j,z,te){var ne={fired:!1,wrapFn:void 0,target:j,type:z,listener:te},K=m.bind(ne);return K.listener=te,ne.wrapFn=K,K}function _(j,z,te){var ne=j._events;if(void 0===ne)return[];var K=ne[z];return void 0===K?[]:"function"==typeof K?te?[K.listener||K]:[K]:te?function L(j){for(var z=new Array(j.length),te=0;te<z.length;++te)z[te]=j[te].listener||j[te];return z}(K):I(K,K.length)}function v(j){var z=this._events;if(void 0!==z){var te=z[j];if("function"==typeof te)return 1;if(void 0!==te)return te.length}return 0}function I(j,z){for(var te=new Array(z),ne=0;ne<z;++ne)te[ne]=j[ne];return te}function B(j,z,te,ne){if("function"==typeof j.on)ne.once?j.once(z,te):j.on(z,te);else{if("function"!=typeof j.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof j);j.addEventListener(z,function K(Ce){ne.once&&j.removeEventListener(z,K),te(Ce)})}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(j){if("number"!=typeof j||j<0||D(j))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+j+".");p=j}}),f.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(z){if("number"!=typeof z||z<0||D(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this},f.prototype.getMaxListeners=function(){return x(this)},f.prototype.emit=function(z){for(var te=[],ne=1;ne<arguments.length;ne++)te.push(arguments[ne]);var K="error"===z,Ce=this._events;if(void 0!==Ce)K=K&&void 0===Ce.error;else if(!K)return!1;if(K){var $;if(te.length>0&&($=te[0]),$ instanceof Error)throw $;var ae=new Error("Unhandled error."+($?" ("+$.message+")":""));throw ae.context=$,ae}var b=Ce[z];if(void 0===b)return!1;if("function"==typeof b)q(b,this,te);else{var fe=b.length,Ne=I(b,fe);for(ne=0;ne<fe;++ne)q(Ne[ne],this,te)}return!0},f.prototype.on=f.prototype.addListener=function(z,te){return S(this,z,te,!1)},f.prototype.prependListener=function(z,te){return S(this,z,te,!0)},f.prototype.once=function(z,te){return C(te),this.on(z,d(this,z,te)),this},f.prototype.prependOnceListener=function(z,te){return C(te),this.prependListener(z,d(this,z,te)),this},f.prototype.off=f.prototype.removeListener=function(z,te){var ne,K,Ce,$,ae;if(C(te),void 0===(K=this._events))return this;if(void 0===(ne=K[z]))return this;if(ne===te||ne.listener===te)0==--this._eventsCount?this._events=Object.create(null):(delete K[z],K.removeListener&&this.emit("removeListener",z,ne.listener||te));else if("function"!=typeof ne){for(Ce=-1,$=ne.length-1;$>=0;$--)if(ne[$]===te||ne[$].listener===te){ae=ne[$].listener,Ce=$;break}if(Ce<0)return this;0===Ce?ne.shift():function T(j,z){for(;z+1<j.length;z++)j[z]=j[z+1];j.pop()}(ne,Ce),1===ne.length&&(K[z]=ne[0]),void 0!==K.removeListener&&this.emit("removeListener",z,ae||te)}return this},f.prototype.removeAllListeners=function(z){var te,ne,K;if(void 0===(ne=this._events))return this;if(void 0===ne.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ne[z]&&(0==--this._eventsCount?this._events=Object.create(null):delete ne[z]),this;if(0===arguments.length){var $,Ce=Object.keys(ne);for(K=0;K<Ce.length;++K)"removeListener"!==($=Ce[K])&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(te=ne[z]))this.removeListener(z,te);else if(void 0!==te)for(K=te.length-1;K>=0;K--)this.removeListener(z,te[K]);return this},f.prototype.listeners=function(z){return _(this,z,!0)},f.prototype.rawListeners=function(z){return _(this,z,!1)},f.listenerCount=function(j,z){return"function"==typeof j.listenerCount?j.listenerCount(z):v.call(j,z)},f.prototype.listenerCount=v,f.prototype.eventNames=function(){return this._eventsCount>0?M(this._events):[]}},4327:function(Xe,N){var O;void 0!==(O=function(){"use strict";function f(d,_,v){var I=new XMLHttpRequest;I.open("GET",d),I.responseType="blob",I.onload=function(){m(I.response,_,v)},I.onerror=function(){console.error("could not download file")},I.send()}function p(d){var _=new XMLHttpRequest;_.open("HEAD",d,!1);try{_.send()}catch(v){}return 200<=_.status&&299>=_.status}function C(d){try{d.dispatchEvent(new MouseEvent("click"))}catch(v){var _=document.createEvent("MouseEvents");_.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(_)}}var x="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,S=x.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=x.saveAs||("object"!=typeof window||window!==x?function(){}:"download"in HTMLAnchorElement.prototype&&!S?function(d,_,v){var I=x.URL||x.webkitURL,T=document.createElement("a");T.download=_=_||d.name||"download",T.rel="noopener","string"==typeof d?(T.href=d,T.origin===location.origin?C(T):p(T.href)?f(d,_,v):C(T,T.target="_blank")):(T.href=I.createObjectURL(d),setTimeout(function(){I.revokeObjectURL(T.href)},4e4),setTimeout(function(){C(T)},0))}:"msSaveOrOpenBlob"in navigator?function(d,_,v){if(_=_||d.name||"download","string"!=typeof d)navigator.msSaveOrOpenBlob(function D(d,_){return void 0===_?_={autoBom:!1}:"object"!=typeof _&&(console.warn("Deprecated: Expected third argument to be a object"),_={autoBom:!_}),_.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\ufeff",d],{type:d.type}):d}(d,v),_);else if(p(d))f(d,_,v);else{var I=document.createElement("a");I.href=d,I.target="_blank",setTimeout(function(){C(I)})}}:function(d,_,v,I){if((I=I||open("","_blank"))&&(I.document.title=I.document.body.innerText="downloading..."),"string"==typeof d)return f(d,_,v);var T="application/octet-stream"===d.type,L=/constructor/i.test(x.HTMLElement)||x.safari,Y=/CriOS\/[\d]+/.test(navigator.userAgent);if((Y||T&&L||S)&&"undefined"!=typeof FileReader){var oe=new FileReader;oe.onloadend=function(){var z=oe.result;z=Y?z:z.replace(/^data:[^;]*;/,"data:attachment/file;"),I?I.location.href=z:location=z,I=null},oe.readAsDataURL(d)}else{var B=x.URL||x.webkitURL,j=B.createObjectURL(d);I?I.location=j:location.href=j,I=null,setTimeout(function(){B.revokeObjectURL(j)},4e4)}});x.saveAs=m.saveAs=m,Xe.exports=m}.apply(N,[]))&&(Xe.exports=O)},5386:(Xe,N,q)=>{var M;!function(O,D,f,p){"use strict";var Y,C=["","webkit","Moz","MS","ms","o"],x=D.createElement("div"),m=Math.round,d=Math.abs,_=Date.now;function v(F,U,ie){return setTimeout(z(F,ie),U)}function I(F,U,ie){return!!Array.isArray(F)&&(T(F,ie[U],ie),!0)}function T(F,U,ie){var me;if(F)if(F.forEach)F.forEach(U,ie);else if(F.length!==p)for(me=0;me<F.length;)U.call(ie,F[me],me,F),me++;else for(me in F)F.hasOwnProperty(me)&&U.call(ie,F[me],me,F)}function L(F,U,ie){var me="DEPRECATED METHOD: "+U+"\n"+ie+" AT \n";return function(){var Ae=new Error("get-stack-trace"),Qe=Ae&&Ae.stack?Ae.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Lt=O.console&&(O.console.warn||O.console.log);return Lt&&Lt.call(O.console,me,Qe),F.apply(this,arguments)}}Y="function"!=typeof Object.assign?function(U){if(U===p||null===U)throw new TypeError("Cannot convert undefined or null to object");for(var ie=Object(U),me=1;me<arguments.length;me++){var Ae=arguments[me];if(Ae!==p&&null!==Ae)for(var Qe in Ae)Ae.hasOwnProperty(Qe)&&(ie[Qe]=Ae[Qe])}return ie}:Object.assign;var oe=L(function(U,ie,me){for(var Ae=Object.keys(ie),Qe=0;Qe<Ae.length;)(!me||me&&U[Ae[Qe]]===p)&&(U[Ae[Qe]]=ie[Ae[Qe]]),Qe++;return U},"extend","Use `assign`."),B=L(function(U,ie){return oe(U,ie,!0)},"merge","Use `assign`.");function j(F,U,ie){var Ae,me=U.prototype;(Ae=F.prototype=Object.create(me)).constructor=F,Ae._super=me,ie&&Y(Ae,ie)}function z(F,U){return function(){return F.apply(U,arguments)}}function te(F,U){return"function"==typeof F?F.apply(U&&U[0]||p,U):F}function ne(F,U){return F===p?U:F}function K(F,U,ie){T(b(U),function(me){F.addEventListener(me,ie,!1)})}function Ce(F,U,ie){T(b(U),function(me){F.removeEventListener(me,ie,!1)})}function $(F,U){for(;F;){if(F==U)return!0;F=F.parentNode}return!1}function ae(F,U){return F.indexOf(U)>-1}function b(F){return F.trim().split(/\s+/g)}function fe(F,U,ie){if(F.indexOf&&!ie)return F.indexOf(U);for(var me=0;me<F.length;){if(ie&&F[me][ie]==U||!ie&&F[me]===U)return me;me++}return-1}function Ne(F){return Array.prototype.slice.call(F,0)}function ce(F,U,ie){for(var me=[],Ae=[],Qe=0;Qe<F.length;){var Lt=U?F[Qe][U]:F[Qe];fe(Ae,Lt)<0&&me.push(F[Qe]),Ae[Qe]=Lt,Qe++}return ie&&(me=U?me.sort(function(ni,ki){return ni[U]>ki[U]}):me.sort()),me}function ke(F,U){for(var ie,me,Ae=U[0].toUpperCase()+U.slice(1),Qe=0;Qe<C.length;){if((me=(ie=C[Qe])?ie+Ae:U)in F)return me;Qe++}return p}var _e=1;function he(F){var U=F.ownerDocument||F;return U.defaultView||U.parentWindow||O}var Je="ontouchstart"in O,Ve=ke(O,"PointerEvent")!==p,Re=Je&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Wt="touch",De="mouse",Fe=["x","y"],je=["clientX","clientY"];function Ie(F,U){var ie=this;this.manager=F,this.callback=U,this.element=F.element,this.target=F.options.inputTarget,this.domHandler=function(me){te(F.options.enable,[F])&&ie.handler(me)},this.init()}function ln(F,U,ie){var me=ie.pointers.length,Ae=ie.changedPointers.length,Qe=1&U&&me-Ae==0,Lt=12&U&&me-Ae==0;ie.isFirst=!!Qe,ie.isFinal=!!Lt,Qe&&(F.session={}),ie.eventType=U,function Dt(F,U){var ie=F.session,me=U.pointers,Ae=me.length;ie.firstInput||(ie.firstInput=Vi(U)),Ae>1&&!ie.firstMultiple?ie.firstMultiple=Vi(U):1===Ae&&(ie.firstMultiple=!1);var Qe=ie.firstInput,Lt=ie.firstMultiple,ti=Lt?Lt.center:Qe.center,ni=U.center=Yo(me);U.timeStamp=_(),U.deltaTime=U.timeStamp-Qe.timeStamp,U.angle=er(ti,ni),U.distance=qo(ti,ni),function Mi(F,U){var ie=U.center,me=F.offsetDelta||{},Ae=F.prevDelta||{},Qe=F.prevInput||{};(1===U.eventType||4===Qe.eventType)&&(Ae=F.prevDelta={x:Qe.deltaX||0,y:Qe.deltaY||0},me=F.offsetDelta={x:ie.x,y:ie.y}),U.deltaX=Ae.x+(ie.x-me.x),U.deltaY=Ae.y+(ie.y-me.y)}(ie,U),U.offsetDirection=_s(U.deltaX,U.deltaY);var ki=pn(U.deltaTime,U.deltaX,U.deltaY);U.overallVelocityX=ki.x,U.overallVelocityY=ki.y,U.overallVelocity=d(ki.x)>d(ki.y)?ki.x:ki.y,U.scale=Lt?function od(F,U){return qo(U[0],U[1],je)/qo(F[0],F[1],je)}(Lt.pointers,me):1,U.rotation=Lt?function wc(F,U){return er(U[1],U[0],je)+er(F[1],F[0],je)}(Lt.pointers,me):0,U.maxPointers=ie.prevInput?U.pointers.length>ie.prevInput.maxPointers?U.pointers.length:ie.prevInput.maxPointers:U.pointers.length,function ms(F,U){var Ae,Qe,Lt,ti,ie=F.lastInterval||U,me=U.timeStamp-ie.timeStamp;if(8!=U.eventType&&(me>25||ie.velocity===p)){var ni=U.deltaX-ie.deltaX,ki=U.deltaY-ie.deltaY,kr=pn(me,ni,ki);Qe=kr.x,Lt=kr.y,Ae=d(kr.x)>d(kr.y)?kr.x:kr.y,ti=_s(ni,ki),F.lastInterval=U}else Ae=ie.velocity,Qe=ie.velocityX,Lt=ie.velocityY,ti=ie.direction;U.velocity=Ae,U.velocityX=Qe,U.velocityY=Lt,U.direction=ti}(ie,U);var kr=F.element;$(U.srcEvent.target,kr)&&(kr=U.srcEvent.target),U.target=kr}(F,ie),F.emit("hammer.input",ie),F.recognize(ie),F.session.prevInput=ie}function Vi(F){for(var U=[],ie=0;ie<F.pointers.length;)U[ie]={clientX:m(F.pointers[ie].clientX),clientY:m(F.pointers[ie].clientY)},ie++;return{timeStamp:_(),pointers:U,center:Yo(U),deltaX:F.deltaX,deltaY:F.deltaY}}function Yo(F){var U=F.length;if(1===U)return{x:m(F[0].clientX),y:m(F[0].clientY)};for(var ie=0,me=0,Ae=0;Ae<U;)ie+=F[Ae].clientX,me+=F[Ae].clientY,Ae++;return{x:m(ie/U),y:m(me/U)}}function pn(F,U,ie){return{x:U/F||0,y:ie/F||0}}function _s(F,U){return F===U?1:d(F)>=d(U)?F<0?2:4:U<0?8:16}function qo(F,U,ie){ie||(ie=Fe);var me=U[ie[0]]-F[ie[0]],Ae=U[ie[1]]-F[ie[1]];return Math.sqrt(me*me+Ae*Ae)}function er(F,U,ie){return ie||(ie=Fe),180*Math.atan2(U[ie[1]]-F[ie[1]],U[ie[0]]-F[ie[0]])/Math.PI}Ie.prototype={handler:function(){},init:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(he(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ce(this.element,this.evEl,this.domHandler),this.evTarget&&Ce(this.target,this.evTarget,this.domHandler),this.evWin&&Ce(he(this.element),this.evWin,this.domHandler)}};var Xa={mousedown:1,mousemove:2,mouseup:4},Ka="mousedown",ia="mousemove mouseup";function hr(){this.evEl=Ka,this.evWin=ia,this.pressed=!1,Ie.apply(this,arguments)}j(hr,Ie,{handler:function(U){var ie=Xa[U.type];1&ie&&0===U.button&&(this.pressed=!0),2&ie&&1!==U.which&&(ie=4),this.pressed&&(4&ie&&(this.pressed=!1),this.callback(this.manager,ie,{pointers:[U],changedPointers:[U],pointerType:De,srcEvent:U}))}});var Xo={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Xf={2:Wt,3:"pen",4:De,5:"kinect"},Ec="pointerdown",xc="pointermove pointerup pointercancel";function Qa(){this.evEl=Ec,this.evWin=xc,Ie.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}O.MSPointerEvent&&!O.PointerEvent&&(Ec="MSPointerDown",xc="MSPointerMove MSPointerUp MSPointerCancel"),j(Qa,Ie,{handler:function(U){var ie=this.store,me=!1,Ae=U.type.toLowerCase().replace("ms",""),Qe=Xo[Ae],Lt=Xf[U.pointerType]||U.pointerType,ti=Lt==Wt,ni=fe(ie,U.pointerId,"pointerId");1&Qe&&(0===U.button||ti)?ni<0&&(ie.push(U),ni=ie.length-1):12&Qe&&(me=!0),!(ni<0)&&(ie[ni]=U,this.callback(this.manager,Qe,{pointers:ie,changedPointers:[U],pointerType:Lt,srcEvent:U}),me&&ie.splice(ni,1))}});var sd={touchstart:1,touchmove:2,touchend:4,touchcancel:8},_o="touchstart",Kf="touchstart touchmove touchend touchcancel";function ad(){this.evTarget=_o,this.evWin=Kf,this.started=!1,Ie.apply(this,arguments)}function Qf(F,U){var ie=Ne(F.touches),me=Ne(F.changedTouches);return 12&U&&(ie=ce(ie.concat(me),"identifier",!0)),[ie,me]}j(ad,Ie,{handler:function(U){var ie=sd[U.type];if(1===ie&&(this.started=!0),this.started){var me=Qf.call(this,U,ie);12&ie&&me[0].length-me[1].length==0&&(this.started=!1),this.callback(this.manager,ie,{pointers:me[0],changedPointers:me[1],pointerType:Wt,srcEvent:U})}}});var Jf={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ld="touchstart touchmove touchend touchcancel";function Ja(){this.evTarget=ld,this.targetIds={},Ie.apply(this,arguments)}function ep(F,U){var ie=Ne(F.touches),me=this.targetIds;if(3&U&&1===ie.length)return me[ie[0].identifier]=!0,[ie,ie];var Ae,Qe,Lt=Ne(F.changedTouches),ti=[],ni=this.target;if(Qe=ie.filter(function(ki){return $(ki.target,ni)}),1===U)for(Ae=0;Ae<Qe.length;)me[Qe[Ae].identifier]=!0,Ae++;for(Ae=0;Ae<Lt.length;)me[Lt[Ae].identifier]&&ti.push(Lt[Ae]),12&U&&delete me[Lt[Ae].identifier],Ae++;return ti.length?[ce(Qe.concat(ti),"identifier",!0),ti]:void 0}function el(){Ie.apply(this,arguments);var F=z(this.handler,this);this.touch=new Ja(this.manager,F),this.mouse=new hr(this.manager,F),this.primaryTouch=null,this.lastTouches=[]}function tp(F,U){1&F?(this.primaryTouch=U.changedPointers[0].identifier,Tc.call(this,U)):12&F&&Tc.call(this,U)}function Tc(F){var U=F.changedPointers[0];if(U.identifier===this.primaryTouch){var ie={x:U.clientX,y:U.clientY};this.lastTouches.push(ie);var me=this.lastTouches;setTimeout(function(){var Qe=me.indexOf(ie);Qe>-1&&me.splice(Qe,1)},2500)}}function $0(F){for(var U=F.srcEvent.clientX,ie=F.srcEvent.clientY,me=0;me<this.lastTouches.length;me++){var Ae=this.lastTouches[me],Qe=Math.abs(U-Ae.x),Lt=Math.abs(ie-Ae.y);if(Qe<=25&&Lt<=25)return!0}return!1}j(Ja,Ie,{handler:function(U){var ie=Jf[U.type],me=ep.call(this,U,ie);!me||this.callback(this.manager,ie,{pointers:me[0],changedPointers:me[1],pointerType:Wt,srcEvent:U})}}),j(el,Ie,{handler:function(U,ie,me){var Qe=me.pointerType==De;if(!(Qe&&me.sourceCapabilities&&me.sourceCapabilities.firesTouchEvents)){if(me.pointerType==Wt)tp.call(this,ie,me);else if(Qe&&$0.call(this,me))return;this.callback(U,ie,me)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ud=ke(x.style,"touchAction"),dd=ud!==p,tl="compute",Dc="manipulation",Ko="none",vs="pan-x",ys="pan-y",nl=function ip(){if(!dd)return!1;var F={},U=O.CSS&&O.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ie){F[ie]=!U||O.CSS.supports("touch-action",ie)}),F}();function Sc(F,U){this.manager=F,this.set(U)}function Vt(F){this.options=Y({},this.defaults,F||{}),this.id=function xe(){return _e++}(),this.manager=null,this.options.enable=ne(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function il(F){return 16&F?"cancel":8&F?"end":4&F?"move":2&F?"start":""}function Jt(F){return 16==F?"down":8==F?"up":2==F?"left":4==F?"right":""}function Cs(F,U){var ie=U.manager;return ie?ie.get(F):F}function fr(){Vt.apply(this,arguments)}function nn(){fr.apply(this,arguments),this.pX=null,this.pY=null}function xt(){fr.apply(this,arguments)}function rl(){Vt.apply(this,arguments),this._timer=null,this._input=null}function fd(){fr.apply(this,arguments)}function Ke(){fr.apply(this,arguments)}function ws(){Vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function dt(F,U){return(U=U||{}).recognizers=ne(U.recognizers,dt.defaults.preset),new gd(F,U)}function gd(F,U){this.options=Y({},dt.defaults,U||{}),this.options.inputTarget=this.options.inputTarget||F,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=F,this.input=function lt(F){return new(F.options.inputClass||(Ve?Qa:Re?Ja:Je?el:hr))(F,ln)}(this),this.touchAction=new Sc(this,this.options.touchAction),rp(this,!0),T(this.options.recognizers,function(ie){var me=this.add(new ie[0](ie[1]));ie[2]&&me.recognizeWith(ie[2]),ie[3]&&me.requireFailure(ie[3])},this)}function rp(F,U){var me,ie=F.element;ie.style&&(T(F.options.cssProps,function(Ae,Qe){me=ke(ie.style,Qe),U?(F.oldCssProps[me]=ie.style[me],ie.style[me]=Ae):ie.style[me]=F.oldCssProps[me]||""}),U||(F.oldCssProps={}))}Sc.prototype={set:function(F){F==tl&&(F=this.compute()),dd&&this.manager.element.style&&nl[F]&&(this.manager.element.style[ud]=F),this.actions=F.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var F=[];return T(this.manager.recognizers,function(U){te(U.options.enable,[U])&&(F=F.concat(U.getTouchAction()))}),function np(F){if(ae(F,Ko))return Ko;var U=ae(F,vs),ie=ae(F,ys);return U&&ie?Ko:U||ie?U?vs:ys:ae(F,Dc)?Dc:"auto"}(F.join(" "))},preventDefaults:function(F){var U=F.srcEvent,ie=F.offsetDirection;if(!this.manager.session.prevented){var me=this.actions,Ae=ae(me,Ko)&&!nl[Ko],Qe=ae(me,ys)&&!nl[ys],Lt=ae(me,vs)&&!nl[vs];if(Ae&&1===F.pointers.length&&F.distance<2&&F.deltaTime<250)return;return Lt&&Qe||!(Ae||Qe&&6&ie||Lt&&24&ie)?void 0:this.preventSrc(U)}U.preventDefault()},preventSrc:function(F){this.manager.session.prevented=!0,F.preventDefault()}},Vt.prototype={defaults:{},set:function(F){return Y(this.options,F),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(F){if(I(F,"recognizeWith",this))return this;var U=this.simultaneous;return U[(F=Cs(F,this)).id]||(U[F.id]=F,F.recognizeWith(this)),this},dropRecognizeWith:function(F){return I(F,"dropRecognizeWith",this)||(F=Cs(F,this),delete this.simultaneous[F.id]),this},requireFailure:function(F){if(I(F,"requireFailure",this))return this;var U=this.requireFail;return-1===fe(U,F=Cs(F,this))&&(U.push(F),F.requireFailure(this)),this},dropRequireFailure:function(F){if(I(F,"dropRequireFailure",this))return this;F=Cs(F,this);var U=fe(this.requireFail,F);return U>-1&&this.requireFail.splice(U,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(F){return!!this.simultaneous[F.id]},emit:function(F){var U=this,ie=this.state;function me(Ae){U.manager.emit(Ae,F)}ie<8&&me(U.options.event+il(ie)),me(U.options.event),F.additionalEvent&&me(F.additionalEvent),ie>=8&&me(U.options.event+il(ie))},tryEmit:function(F){if(this.canEmit())return this.emit(F);this.state=32},canEmit:function(){for(var F=0;F<this.requireFail.length;){if(!(33&this.requireFail[F].state))return!1;F++}return!0},recognize:function(F){var U=Y({},F);if(!te(this.options.enable,[this,U]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(U),30&this.state&&this.tryEmit(U)},process:function(F){},getTouchAction:function(){},reset:function(){}},j(fr,Vt,{defaults:{pointers:1},attrTest:function(F){var U=this.options.pointers;return 0===U||F.pointers.length===U},process:function(F){var U=this.state,ie=F.eventType,me=6&U,Ae=this.attrTest(F);return me&&(8&ie||!Ae)?16|U:me||Ae?4&ie?8|U:2&U?4|U:2:32}}),j(nn,fr,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var F=this.options.direction,U=[];return 6&F&&U.push(ys),24&F&&U.push(vs),U},directionTest:function(F){var U=this.options,ie=!0,me=F.distance,Ae=F.direction,Qe=F.deltaX,Lt=F.deltaY;return Ae&U.direction||(6&U.direction?(Ae=0===Qe?1:Qe<0?2:4,ie=Qe!=this.pX,me=Math.abs(F.deltaX)):(Ae=0===Lt?1:Lt<0?8:16,ie=Lt!=this.pY,me=Math.abs(F.deltaY))),F.direction=Ae,ie&&me>U.threshold&&Ae&U.direction},attrTest:function(F){return fr.prototype.attrTest.call(this,F)&&(2&this.state||!(2&this.state)&&this.directionTest(F))},emit:function(F){this.pX=F.deltaX,this.pY=F.deltaY;var U=Jt(F.direction);U&&(F.additionalEvent=this.options.event+U),this._super.emit.call(this,F)}}),j(xt,fr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ko]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.scale-1)>this.options.threshold||2&this.state)},emit:function(F){1!==F.scale&&(F.additionalEvent=this.options.event+(F.scale<1?"in":"out")),this._super.emit.call(this,F)}}),j(rl,Vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(F){var U=this.options,ie=F.pointers.length===U.pointers,me=F.distance<U.threshold,Ae=F.deltaTime>U.time;if(this._input=F,!me||!ie||12&F.eventType&&!Ae)this.reset();else if(1&F.eventType)this.reset(),this._timer=v(function(){this.state=8,this.tryEmit()},U.time,this);else if(4&F.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(F){8===this.state&&(F&&4&F.eventType?this.manager.emit(this.options.event+"up",F):(this._input.timeStamp=_(),this.manager.emit(this.options.event,this._input)))}}),j(fd,fr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ko]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.rotation)>this.options.threshold||2&this.state)}}),j(Ke,fr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return nn.prototype.getTouchAction.call(this)},attrTest:function(F){var ie,U=this.options.direction;return 30&U?ie=F.overallVelocity:6&U?ie=F.overallVelocityX:24&U&&(ie=F.overallVelocityY),this._super.attrTest.call(this,F)&&U&F.offsetDirection&&F.distance>this.options.threshold&&F.maxPointers==this.options.pointers&&d(ie)>this.options.velocity&&4&F.eventType},emit:function(F){var U=Jt(F.offsetDirection);U&&this.manager.emit(this.options.event+U,F),this.manager.emit(this.options.event,F)}}),j(ws,Vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Dc]},process:function(F){var U=this.options,ie=F.pointers.length===U.pointers,me=F.distance<U.threshold,Ae=F.deltaTime<U.time;if(this.reset(),1&F.eventType&&0===this.count)return this.failTimeout();if(me&&Ae&&ie){if(4!=F.eventType)return this.failTimeout();var Qe=!this.pTime||F.timeStamp-this.pTime<U.interval,Lt=!this.pCenter||qo(this.pCenter,F.center)<U.posThreshold;if(this.pTime=F.timeStamp,this.pCenter=F.center,Lt&&Qe?this.count+=1:this.count=1,this._input=F,0==this.count%U.taps)return this.hasRequireFailures()?(this._timer=v(function(){this.state=8,this.tryEmit()},U.interval,this),2):8}return 32},failTimeout:function(){return this._timer=v(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),dt.VERSION="2.0.7",dt.defaults={domEvents:!1,touchAction:tl,enable:!0,inputTarget:null,inputClass:null,preset:[[fd,{enable:!1}],[xt,{enable:!1},["rotate"]],[Ke,{direction:6}],[nn,{direction:6},["swipe"]],[ws],[ws,{event:"doubletap",taps:2},["tap"]],[rl]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},gd.prototype={set:function(F){return Y(this.options,F),F.touchAction&&this.touchAction.update(),F.inputTarget&&(this.input.destroy(),this.input.target=F.inputTarget,this.input.init()),this},stop:function(F){this.session.stopped=F?2:1},recognize:function(F){var U=this.session;if(!U.stopped){this.touchAction.preventDefaults(F);var ie,me=this.recognizers,Ae=U.curRecognizer;(!Ae||Ae&&8&Ae.state)&&(Ae=U.curRecognizer=null);for(var Qe=0;Qe<me.length;)ie=me[Qe],2===U.stopped||Ae&&ie!=Ae&&!ie.canRecognizeWith(Ae)?ie.reset():ie.recognize(F),!Ae&&14&ie.state&&(Ae=U.curRecognizer=ie),Qe++}},get:function(F){if(F instanceof Vt)return F;for(var U=this.recognizers,ie=0;ie<U.length;ie++)if(U[ie].options.event==F)return U[ie];return null},add:function(F){if(I(F,"add",this))return this;var U=this.get(F.options.event);return U&&this.remove(U),this.recognizers.push(F),F.manager=this,this.touchAction.update(),F},remove:function(F){if(I(F,"remove",this))return this;if(F=this.get(F)){var U=this.recognizers,ie=fe(U,F);-1!==ie&&(U.splice(ie,1),this.touchAction.update())}return this},on:function(F,U){if(F!==p&&U!==p){var ie=this.handlers;return T(b(F),function(me){ie[me]=ie[me]||[],ie[me].push(U)}),this}},off:function(F,U){if(F!==p){var ie=this.handlers;return T(b(F),function(me){U?ie[me]&&ie[me].splice(fe(ie[me],U),1):delete ie[me]}),this}},emit:function(F,U){this.options.domEvents&&function ol(F,U){var ie=D.createEvent("Event");ie.initEvent(F,!0,!0),ie.gesture=U,U.target.dispatchEvent(ie)}(F,U);var ie=this.handlers[F]&&this.handlers[F].slice();if(ie&&ie.length){U.type=F,U.preventDefault=function(){U.srcEvent.preventDefault()};for(var me=0;me<ie.length;)ie[me](U),me++}},destroy:function(){this.element&&rp(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},Y(dt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:gd,Input:Ie,TouchAction:Sc,TouchInput:Ja,MouseInput:hr,PointerEventInput:Qa,TouchMouseInput:el,SingleTouchInput:ad,Recognizer:Vt,AttrRecognizer:fr,Tap:ws,Pan:nn,Swipe:Ke,Pinch:xt,Rotate:fd,Press:rl,on:K,off:Ce,each:T,merge:B,extend:oe,assign:Y,inherit:j,bindFn:z,prefixed:ke}),(void 0!==O?O:"undefined"!=typeof self?self:{}).Hammer=dt,(M=function(){return dt}.call(N,q,N,Xe))!==p&&(Xe.exports=M)}(window,document)},8461:(Xe,N)=>{N.read=function(q,M,O,D,f){var p,C,x=8*f-D-1,S=(1<<x)-1,m=S>>1,d=-7,_=O?f-1:0,v=O?-1:1,I=q[M+_];for(_+=v,p=I&(1<<-d)-1,I>>=-d,d+=x;d>0;p=256*p+q[M+_],_+=v,d-=8);for(C=p&(1<<-d)-1,p>>=-d,d+=D;d>0;C=256*C+q[M+_],_+=v,d-=8);if(0===p)p=1-m;else{if(p===S)return C?NaN:1/0*(I?-1:1);C+=Math.pow(2,D),p-=m}return(I?-1:1)*C*Math.pow(2,p-D)},N.write=function(q,M,O,D,f,p){var C,x,S,m=8*p-f-1,d=(1<<m)-1,_=d>>1,v=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,I=D?0:p-1,T=D?1:-1,L=M<0||0===M&&1/M<0?1:0;for(M=Math.abs(M),isNaN(M)||M===1/0?(x=isNaN(M)?1:0,C=d):(C=Math.floor(Math.log(M)/Math.LN2),M*(S=Math.pow(2,-C))<1&&(C--,S*=2),(M+=C+_>=1?v/S:v*Math.pow(2,1-_))*S>=2&&(C++,S/=2),C+_>=d?(x=0,C=d):C+_>=1?(x=(M*S-1)*Math.pow(2,f),C+=_):(x=M*Math.pow(2,_-1)*Math.pow(2,f),C=0));f>=8;q[O+I]=255&x,I+=T,x/=256,f-=8);for(C=C<<f|x,m+=f;m>0;q[O+I]=255&C,I+=T,C/=256,m-=8);q[O+I-T]|=128*L}},6256:function(Xe,N){!function(f){var I,p="undefined",C=p!==typeof Buffer&&Buffer,x=p!==typeof Uint8Array&&Uint8Array,S=p!==typeof ArrayBuffer&&ArrayBuffer,m=[0,0,0,0,0,0,0,0],d=Array.isArray||function $(ae){return!!ae&&"[object Array]"==Object.prototype.toString.call(ae)},_=4294967296;function T(ae,b,fe){var Ne=b?0:4,ce=b?4:0,ke=b?0:3,_e=b?1:2,xe=b?2:1,he=b?3:0,pe=b?te:K,Je=b?ne:Ce,Ve=Le.prototype,Re="is"+ae,Wt="_"+Re;return Ve.buffer=void 0,Ve.offset=0,Ve[Wt]=!0,Ve.toNumber=tt,Ve.toString=function Zt(ge){var X=this.buffer,H=this.offset,V=y(X,H+Ne),se=y(X,H+ce),we="",Ee=!fe&&2147483648&V;for(Ee&&(V=~V,se=_-se),ge=ge||10;;){var de=V%ge*_+se;if(V=Math.floor(V/ge),se=Math.floor(de/ge),we=(de%ge).toString(ge)+we,!V&&!se)break}return Ee&&(we="-"+we),we},Ve.toJSON=tt,Ve.toArray=L,C&&(Ve.toBuffer=Y),x&&(Ve.toArrayBuffer=oe),Le[Re]=function De(ge){return!(!ge||!ge[Wt])},f[ae]=Le,Le;function Le(ge,X,H,V){return this instanceof Le?function Pe(ge,X,H,V,se){x&&S&&(X instanceof S&&(X=new x(X)),V instanceof S&&(V=new x(V))),X||H||V||I?(B(X,H)||(se=H,V=X,H=0,X=new(I||Array)(8)),ge.buffer=X,ge.offset=H|=0,p!==typeof V&&("string"==typeof V?function ut(ge,X,H,V){var se=0,we=H.length,Ee=0,de=0;"-"===H[0]&&se++;for(var Fe=se;se<we;){var je=parseInt(H[se++],V);if(!(je>=0))break;de=de*V+je,Ee=Ee*V+Math.floor(de/_),de%=_}Fe&&(Ee=~Ee,de?de=_-de:Ee++),bt(ge,X+Ne,Ee),bt(ge,X+ce,de)}(X,H,V,se||10):B(V,se)?j(X,H,V,se):"number"==typeof se?(bt(X,H+Ne,V),bt(X,H+ce,se)):V>0?pe(X,H,V):V<0?Je(X,H,V):j(X,H,m,0))):ge.buffer=z(m,0)}(this,ge,X,H,V):new Le(ge,X,H,V)}function tt(){var ge=this.buffer,X=this.offset,H=y(ge,X+Ne),V=y(ge,X+ce);return fe||(H|=0),H?H*_+V:V}function bt(ge,X,H){ge[X+he]=255&H,ge[X+xe]=255&(H>>=8),ge[X+_e]=255&(H>>=8),ge[X+ke]=255&(H>>=8)}function y(ge,X){return 16777216*ge[X+ke]+(ge[X+_e]<<16)+(ge[X+xe]<<8)+ge[X+he]}}function L(ae){var b=this.buffer,fe=this.offset;return I=null,!1!==ae&&0===fe&&8===b.length&&d(b)?b:z(b,fe)}function Y(ae){var b=this.buffer,fe=this.offset;if(I=C,!1!==ae&&0===fe&&8===b.length&&Buffer.isBuffer(b))return b;var Ne=new C(8);return j(Ne,0,b,fe),Ne}function oe(ae){var b=this.buffer,fe=this.offset,Ne=b.buffer;if(I=x,!1!==ae&&0===fe&&Ne instanceof S&&8===Ne.byteLength)return Ne;var ce=new x(8);return j(ce,0,b,fe),ce.buffer}function B(ae,b){var fe=ae&&ae.length;return b|=0,fe&&b+8<=fe&&"string"!=typeof ae[b]}function j(ae,b,fe,Ne){b|=0,Ne|=0;for(var ce=0;ce<8;ce++)ae[b++]=255&fe[Ne++]}function z(ae,b){return Array.prototype.slice.call(ae,b,b+8)}function te(ae,b,fe){for(var Ne=b+8;Ne>b;)ae[--Ne]=255&fe,fe/=256}function ne(ae,b,fe){var Ne=b+8;for(fe++;Ne>b;)ae[--Ne]=255&-fe^255,fe/=256}function K(ae,b,fe){for(var Ne=b+8;b<Ne;)ae[b++]=255&fe,fe/=256}function Ce(ae,b,fe){var Ne=b+8;for(fe++;b<Ne;)ae[b++]=255&-fe^255,fe/=256}T("Uint64BE",!0,!0),T("Int64BE",!0,!1),T("Uint64LE",!1,!0),T("Int64LE",!1,!1)}("string"!=typeof N.nodeName?N:this||{})},6425:Xe=>{var N={}.toString;Xe.exports=Array.isArray||function(q){return"[object Array]"==N.call(q)}},5650:Xe=>{Xe.exports=function N(q,M,O){function D(C,x){if(!M[C]){if(!q[C]){if(f)return f(C,!0);var m=new Error("Cannot find module '"+C+"'");throw m.code="MODULE_NOT_FOUND",m}var d=M[C]={exports:{}};q[C][0].call(d.exports,function(_){return D(q[C][1][_]||_)},d,d.exports,N,q,M,O)}return M[C].exports}for(var f=void 0,p=0;p<O.length;p++)D(O[p]);return D}({1:[function(N,q,M){"use strict";var O=N("./utils"),D=N("./support"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";M.encode=function(p){for(var C,x,S,d,_,v,I=[],T=0,L=p.length,Y=L,oe="string"!==O.getTypeOf(p);T<p.length;)Y=L-T,S=oe?(C=p[T++],x=T<L?p[T++]:0,T<L?p[T++]:0):(C=p.charCodeAt(T++),x=T<L?p.charCodeAt(T++):0,T<L?p.charCodeAt(T++):0),d=(3&C)<<4|x>>4,_=1<Y?(15&x)<<2|S>>6:64,v=2<Y?63&S:64,I.push(f.charAt(C>>2)+f.charAt(d)+f.charAt(_)+f.charAt(v));return I.join("")},M.decode=function(p){var C,x,S,m,d,_,v=0,I=0,T="data:";if(p.substr(0,T.length)===T)throw new Error("Invalid base64 input, it looks like a data url.");var L,Y=3*(p=p.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(p.charAt(p.length-1)===f.charAt(64)&&Y--,p.charAt(p.length-2)===f.charAt(64)&&Y--,Y%1!=0)throw new Error("Invalid base64 input, bad content length.");for(L=D.uint8array?new Uint8Array(0|Y):new Array(0|Y);v<p.length;)C=f.indexOf(p.charAt(v++))<<2|(m=f.indexOf(p.charAt(v++)))>>4,x=(15&m)<<4|(d=f.indexOf(p.charAt(v++)))>>2,S=(3&d)<<6|(_=f.indexOf(p.charAt(v++))),L[I++]=C,64!==d&&(L[I++]=x),64!==_&&(L[I++]=S);return L}},{"./support":30,"./utils":32}],2:[function(N,q,M){"use strict";var O=N("./external"),D=N("./stream/DataWorker"),f=N("./stream/Crc32Probe"),p=N("./stream/DataLengthProbe");function C(x,S,m,d,_){this.compressedSize=x,this.uncompressedSize=S,this.crc32=m,this.compression=d,this.compressedContent=_}C.prototype={getContentWorker:function(){var x=new D(O.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new p("data_length")),S=this;return x.on("end",function(){if(this.streamInfo.data_length!==S.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),x},getCompressedWorker:function(){return new D(O.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},C.createWorkerFrom=function(x,S,m){return x.pipe(new f).pipe(new p("uncompressedSize")).pipe(S.compressWorker(m)).pipe(new p("compressedSize")).withStreamInfo("compression",S)},q.exports=C},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(N,q,M){"use strict";var O=N("./stream/GenericWorker");M.STORE={magic:"\0\0",compressWorker:function(){return new O("STORE compression")},uncompressWorker:function(){return new O("STORE decompression")}},M.DEFLATE=N("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(N,q,M){"use strict";var O=N("./utils"),D=function(){for(var f,p=[],C=0;C<256;C++){f=C;for(var x=0;x<8;x++)f=1&f?3988292384^f>>>1:f>>>1;p[C]=f}return p}();q.exports=function(f,p){return void 0!==f&&f.length?"string"!==O.getTypeOf(f)?function(C,x,S,m){var d=D,_=0+S;C^=-1;for(var v=0;v<_;v++)C=C>>>8^d[255&(C^x[v])];return-1^C}(0|p,f,f.length):function(C,x,S,m){var d=D,_=0+S;C^=-1;for(var v=0;v<_;v++)C=C>>>8^d[255&(C^x.charCodeAt(v))];return-1^C}(0|p,f,f.length):0}},{"./utils":32}],5:[function(N,q,M){"use strict";M.base64=!1,M.binary=!1,M.dir=!1,M.createFolders=!0,M.date=null,M.compression=null,M.compressionOptions=null,M.comment=null,M.unixPermissions=null,M.dosPermissions=null},{}],6:[function(N,q,M){"use strict";var O;O="undefined"!=typeof Promise?Promise:N("lie"),q.exports={Promise:O}},{lie:37}],7:[function(N,q,M){"use strict";var O="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,D=N("pako"),f=N("./utils"),p=N("./stream/GenericWorker"),C=O?"uint8array":"array";function x(S,m){p.call(this,"FlateWorker/"+S),this._pako=null,this._pakoAction=S,this._pakoOptions=m,this.meta={}}M.magic="\b\0",f.inherits(x,p),x.prototype.processChunk=function(S){this.meta=S.meta,null===this._pako&&this._createPako(),this._pako.push(f.transformTo(C,S.data),!1)},x.prototype.flush=function(){p.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},x.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this._pako=null},x.prototype._createPako=function(){this._pako=new D[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var S=this;this._pako.onData=function(m){S.push({data:m,meta:S.meta})}},M.compressWorker=function(S){return new x("Deflate",S)},M.uncompressWorker=function(){return new x("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(N,q,M){"use strict";function O(d,_){var v,I="";for(v=0;v<_;v++)I+=String.fromCharCode(255&d),d>>>=8;return I}function D(d,_,v,I,T,L){var Y,oe,B=d.file,j=d.compression,z=L!==C.utf8encode,te=f.transformTo("string",L(B.name)),ne=f.transformTo("string",C.utf8encode(B.name)),K=B.comment,Ce=f.transformTo("string",L(K)),$=f.transformTo("string",C.utf8encode(K)),ae=ne.length!==B.name.length,b=$.length!==K.length,fe="",Ne="",ce="",ke=B.dir,_e=B.date,xe={crc32:0,compressedSize:0,uncompressedSize:0};_&&!v||(xe.crc32=d.crc32,xe.compressedSize=d.compressedSize,xe.uncompressedSize=d.uncompressedSize);var he=0;_&&(he|=8),z||!ae&&!b||(he|=2048);var Re,Le,pe=0,Je=0;ke&&(pe|=16),"UNIX"===T?(Je=798,pe|=(Le=Re=B.unixPermissions,Re||(Le=ke?16893:33204),(65535&Le)<<16)):(Je=20,pe|=function(Re){return 63&(Re||0)}(B.dosPermissions)),Y=_e.getUTCHours(),Y<<=6,Y|=_e.getUTCMinutes(),Y<<=5,Y|=_e.getUTCSeconds()/2,oe=_e.getUTCFullYear()-1980,oe<<=4,oe|=_e.getUTCMonth()+1,oe<<=5,oe|=_e.getUTCDate(),ae&&(Ne=O(1,1)+O(x(te),4)+ne,fe+="up"+O(Ne.length,2)+Ne),b&&(ce=O(1,1)+O(x(Ce),4)+$,fe+="uc"+O(ce.length,2)+ce);var Ve="";return Ve+="\n\0",Ve+=O(he,2),Ve+=j.magic,Ve+=O(Y,2),Ve+=O(oe,2),Ve+=O(xe.crc32,4),Ve+=O(xe.compressedSize,4),Ve+=O(xe.uncompressedSize,4),Ve+=O(te.length,2),Ve+=O(fe.length,2),{fileRecord:S.LOCAL_FILE_HEADER+Ve+te+fe,dirRecord:S.CENTRAL_FILE_HEADER+O(Je,2)+Ve+O(Ce.length,2)+"\0\0\0\0"+O(pe,4)+O(I,4)+te+fe+Ce}}var f=N("../utils"),p=N("../stream/GenericWorker"),C=N("../utf8"),x=N("../crc32"),S=N("../signature");function m(d,_,v,I){p.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=v,this.encodeFileName=I,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}f.inherits(m,p),m.prototype.push=function(d){var _=d.meta.percent||0,v=this.entriesCount,I=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,p.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:v?(_+100*(v-I-1))/v:100}}))},m.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var _=this.streamFiles&&!d.file.dir;if(_){var v=D(d,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(d){this.accumulate=!1;var I,_=this.streamFiles&&!d.file.dir,v=D(d,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),_)this.push({data:(I=d,S.DATA_DESCRIPTOR+O(I.crc32,4)+O(I.compressedSize,4)+O(I.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var d=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var T,L,Y,j,I=(T=this.dirRecords.length,L=this.bytesWritten-d,Y=d,j=f.transformTo("string",(0,this.encodeFileName)(this.zipComment)),S.CENTRAL_DIRECTORY_END+"\0\0\0\0"+O(T,2)+O(T,2)+O(L,4)+O(Y,4)+O(j.length,2)+j);this.push({data:I,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(d){this._sources.push(d);var _=this;return d.on("data",function(v){_.processChunk(v)}),d.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),d.on("error",function(v){_.error(v)}),this},m.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(d){var _=this._sources;if(!p.prototype.error.call(this,d))return!1;for(var v=0;v<_.length;v++)try{_[v].error(d)}catch(I){}return!0},m.prototype.lock=function(){p.prototype.lock.call(this);for(var d=this._sources,_=0;_<d.length;_++)d[_].lock()},q.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(N,q,M){"use strict";var O=N("../compressions"),D=N("./ZipFileWorker");M.generateWorker=function(f,p,C){var x=new D(p.streamFiles,C,p.platform,p.encodeFileName),S=0;try{f.forEach(function(m,d){S++;var _=function(L,Y){var oe=L||Y,B=O[oe];if(!B)throw new Error(oe+" is not a valid compression method !");return B}(d.options.compression,p.compression),I=d.dir,T=d.date;d._compressWorker(_,d.options.compressionOptions||p.compressionOptions||{}).withStreamInfo("file",{name:m,dir:I,date:T,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(x)}),x.entriesCount=S}catch(m){x.error(m)}return x}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(N,q,M){"use strict";function O(){if(!(this instanceof O))return new O;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var D=new O;for(var f in this)"function"!=typeof this[f]&&(D[f]=this[f]);return D}}(O.prototype=N("./object")).loadAsync=N("./load"),O.support=N("./support"),O.defaults=N("./defaults"),O.version="3.10.1",O.loadAsync=function(D,f){return(new O).loadAsync(D,f)},O.external=N("./external"),q.exports=O},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(N,q,M){"use strict";var O=N("./utils"),D=N("./external"),f=N("./utf8"),p=N("./zipEntries"),C=N("./stream/Crc32Probe"),x=N("./nodejsUtils");function S(m){return new D.Promise(function(d,_){var v=m.decompressed.getContentWorker().pipe(new C);v.on("error",function(I){_(I)}).on("end",function(){v.streamInfo.crc32!==m.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}q.exports=function(m,d){var _=this;return d=O.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:f.utf8decode}),x.isNode&&x.isStream(m)?D.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):O.prepareContent("the loaded zip file",m,!0,d.optimizedBinaryString,d.base64).then(function(v){var I=new p(d);return I.load(v),I}).then(function(v){var I=[D.Promise.resolve(v)],T=v.files;if(d.checkCRC32)for(var L=0;L<T.length;L++)I.push(S(T[L]));return D.Promise.all(I)}).then(function(v){for(var I=v.shift(),T=I.files,L=0;L<T.length;L++){var Y=T[L],oe=Y.fileNameStr,B=O.resolve(Y.fileNameStr);_.file(B,Y.decompressed,{binary:!0,optimizedBinaryString:!0,date:Y.date,dir:Y.dir,comment:Y.fileCommentStr.length?Y.fileCommentStr:null,unixPermissions:Y.unixPermissions,dosPermissions:Y.dosPermissions,createFolders:d.createFolders}),Y.dir||(_.file(B).unsafeOriginalName=oe)}return I.zipComment.length&&(_.comment=I.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(N,q,M){"use strict";var O=N("../utils"),D=N("../stream/GenericWorker");function f(p,C){D.call(this,"Nodejs stream input adapter for "+p),this._upstreamEnded=!1,this._bindStream(C)}O.inherits(f,D),f.prototype._bindStream=function(p){var C=this;(this._stream=p).pause(),p.on("data",function(x){C.push({data:x,meta:{percent:0}})}).on("error",function(x){C.isPaused?this.generatedError=x:C.error(x)}).on("end",function(){C.isPaused?C._upstreamEnded=!0:C.end()})},f.prototype.pause=function(){return!!D.prototype.pause.call(this)&&(this._stream.pause(),!0)},f.prototype.resume=function(){return!!D.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},q.exports=f},{"../stream/GenericWorker":28,"../utils":32}],13:[function(N,q,M){"use strict";var O=N("readable-stream").Readable;function D(f,p,C){O.call(this,p),this._helper=f;var x=this;f.on("data",function(S,m){x.push(S)||x._helper.pause(),C&&C(m)}).on("error",function(S){x.emit("error",S)}).on("end",function(){x.push(null)})}N("../utils").inherits(D,O),D.prototype._read=function(){this._helper.resume()},q.exports=D},{"../utils":32,"readable-stream":16}],14:[function(N,q,M){"use strict";q.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(O,D){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(O,D);if("number"==typeof O)throw new Error('The "data" argument must not be a number');return new Buffer(O,D)},allocBuffer:function(O){if(Buffer.alloc)return Buffer.alloc(O);var D=new Buffer(O);return D.fill(0),D},isBuffer:function(O){return Buffer.isBuffer(O)},isStream:function(O){return O&&"function"==typeof O.on&&"function"==typeof O.pause&&"function"==typeof O.resume}}},{}],15:[function(N,q,M){"use strict";function O(B,j,z){var te,ne=f.getTypeOf(j),K=f.extend(z||{},x);K.date=K.date||new Date,null!==K.compression&&(K.compression=K.compression.toUpperCase()),"string"==typeof K.unixPermissions&&(K.unixPermissions=parseInt(K.unixPermissions,8)),K.unixPermissions&&16384&K.unixPermissions&&(K.dir=!0),K.dosPermissions&&16&K.dosPermissions&&(K.dir=!0),K.dir&&(B=T(B)),K.createFolders&&(te=I(B))&&L.call(this,te,!0),z&&void 0!==z.binary||(K.binary=!("string"===ne&&!1===K.binary&&!1===K.base64)),(j instanceof S&&0===j.uncompressedSize||K.dir||!j||0===j.length)&&(K.base64=!1,K.binary=!0,j="",K.compression="STORE",ne="string");var $;$=j instanceof S||j instanceof p?j:_.isNode&&_.isStream(j)?new v(B,j):f.prepareContent(B,j,K.binary,K.optimizedBinaryString,K.base64);var ae=new m(B,$,K);this.files[B]=ae}var D=N("./utf8"),f=N("./utils"),p=N("./stream/GenericWorker"),C=N("./stream/StreamHelper"),x=N("./defaults"),S=N("./compressedObject"),m=N("./zipObject"),d=N("./generate"),_=N("./nodejsUtils"),v=N("./nodejs/NodejsStreamInputAdapter"),I=function(B){"/"===B.slice(-1)&&(B=B.substring(0,B.length-1));var j=B.lastIndexOf("/");return 0<j?B.substring(0,j):""},T=function(B){return"/"!==B.slice(-1)&&(B+="/"),B},L=function(B,j){return j=void 0!==j?j:x.createFolders,B=T(B),this.files[B]||O.call(this,B,null,{dir:!0,createFolders:j}),this.files[B]};function Y(B){return"[object RegExp]"===Object.prototype.toString.call(B)}var oe={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(B){var j,z,te;for(j in this.files)te=this.files[j],(z=j.slice(this.root.length,j.length))&&j.slice(0,this.root.length)===this.root&&B(z,te)},filter:function(B){var j=[];return this.forEach(function(z,te){B(z,te)&&j.push(te)}),j},file:function(B,j,z){if(1!==arguments.length)return O.call(this,B=this.root+B,j,z),this;if(Y(B)){var te=B;return this.filter(function(K,Ce){return!Ce.dir&&te.test(K)})}var ne=this.files[this.root+B];return ne&&!ne.dir?ne:null},folder:function(B){if(!B)return this;if(Y(B))return this.filter(function(ne,K){return K.dir&&B.test(ne)});var z=L.call(this,this.root+B),te=this.clone();return te.root=z.name,te},remove:function(B){var j=this.files[B=this.root+B];if(j||("/"!==B.slice(-1)&&(B+="/"),j=this.files[B]),j&&!j.dir)delete this.files[B];else for(var z=this.filter(function(ne,K){return K.name.slice(0,B.length)===B}),te=0;te<z.length;te++)delete this.files[z[te].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(B){var j,z={};try{if((z=f.extend(B||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:D.utf8encode})).type=z.type.toLowerCase(),z.compression=z.compression.toUpperCase(),"binarystring"===z.type&&(z.type="string"),!z.type)throw new Error("No output type specified.");f.checkSupport(z.type),"darwin"!==z.platform&&"freebsd"!==z.platform&&"linux"!==z.platform&&"sunos"!==z.platform||(z.platform="UNIX"),"win32"===z.platform&&(z.platform="DOS"),j=d.generateWorker(this,z,z.comment||this.comment||"")}catch(ne){(j=new p("error")).error(ne)}return new C(j,z.type||"string",z.mimeType)},generateAsync:function(B,j){return this.generateInternalStream(B).accumulate(j)},generateNodeStream:function(B,j){return(B=B||{}).type||(B.type="nodebuffer"),this.generateInternalStream(B).toNodejsStream(j)}};q.exports=oe},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(N,q,M){"use strict";q.exports=N("stream")},{stream:void 0}],17:[function(N,q,M){"use strict";var O=N("./DataReader");function D(f){O.call(this,f);for(var p=0;p<this.data.length;p++)f[p]=255&f[p]}N("../utils").inherits(D,O),D.prototype.byteAt=function(f){return this.data[this.zero+f]},D.prototype.lastIndexOfSignature=function(f){for(var p=f.charCodeAt(0),C=f.charCodeAt(1),x=f.charCodeAt(2),S=f.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===p&&this.data[m+1]===C&&this.data[m+2]===x&&this.data[m+3]===S)return m-this.zero;return-1},D.prototype.readAndCheckSignature=function(f){var p=f.charCodeAt(0),C=f.charCodeAt(1),x=f.charCodeAt(2),S=f.charCodeAt(3),m=this.readData(4);return p===m[0]&&C===m[1]&&x===m[2]&&S===m[3]},D.prototype.readData=function(f){if(this.checkOffset(f),0===f)return[];var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},q.exports=D},{"../utils":32,"./DataReader":18}],18:[function(N,q,M){"use strict";var O=N("../utils");function D(f){this.data=f,this.length=f.length,this.index=0,this.zero=0}D.prototype={checkOffset:function(f){this.checkIndex(this.index+f)},checkIndex:function(f){if(this.length<this.zero+f||f<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+f+"). Corrupted zip ?")},setIndex:function(f){this.checkIndex(f),this.index=f},skip:function(f){this.setIndex(this.index+f)},byteAt:function(){},readInt:function(f){var p,C=0;for(this.checkOffset(f),p=this.index+f-1;p>=this.index;p--)C=(C<<8)+this.byteAt(p);return this.index+=f,C},readString:function(f){return O.transformTo("string",this.readData(f))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var f=this.readInt(4);return new Date(Date.UTC(1980+(f>>25&127),(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(31&f)<<1))}},q.exports=D},{"../utils":32}],19:[function(N,q,M){"use strict";var O=N("./Uint8ArrayReader");function D(f){O.call(this,f)}N("../utils").inherits(D,O),D.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},q.exports=D},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(N,q,M){"use strict";var O=N("./DataReader");function D(f){O.call(this,f)}N("../utils").inherits(D,O),D.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)},D.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero},D.prototype.readAndCheckSignature=function(f){return f===this.readData(4)},D.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},q.exports=D},{"../utils":32,"./DataReader":18}],21:[function(N,q,M){"use strict";var O=N("./ArrayReader");function D(f){O.call(this,f)}N("../utils").inherits(D,O),D.prototype.readData=function(f){if(this.checkOffset(f),0===f)return new Uint8Array(0);var p=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},q.exports=D},{"../utils":32,"./ArrayReader":17}],22:[function(N,q,M){"use strict";var O=N("../utils"),D=N("../support"),f=N("./ArrayReader"),p=N("./StringReader"),C=N("./NodeBufferReader"),x=N("./Uint8ArrayReader");q.exports=function(S){var m=O.getTypeOf(S);return O.checkSupport(m),"string"!==m||D.uint8array?"nodebuffer"===m?new C(S):D.uint8array?new x(O.transformTo("uint8array",S)):new f(O.transformTo("array",S)):new p(S)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(N,q,M){"use strict";M.LOCAL_FILE_HEADER="PK\x03\x04",M.CENTRAL_FILE_HEADER="PK\x01\x02",M.CENTRAL_DIRECTORY_END="PK\x05\x06",M.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",M.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",M.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(N,q,M){"use strict";var O=N("./GenericWorker"),D=N("../utils");function f(p){O.call(this,"ConvertWorker to "+p),this.destType=p}D.inherits(f,O),f.prototype.processChunk=function(p){this.push({data:D.transformTo(this.destType,p.data),meta:p.meta})},q.exports=f},{"../utils":32,"./GenericWorker":28}],25:[function(N,q,M){"use strict";var O=N("./GenericWorker"),D=N("../crc32");function f(){O.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}N("../utils").inherits(f,O),f.prototype.processChunk=function(p){this.streamInfo.crc32=D(p.data,this.streamInfo.crc32||0),this.push(p)},q.exports=f},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(N,q,M){"use strict";var O=N("../utils"),D=N("./GenericWorker");function f(p){D.call(this,"DataLengthProbe for "+p),this.propName=p,this.withStreamInfo(p,0)}O.inherits(f,D),f.prototype.processChunk=function(p){p&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+p.data.length),D.prototype.processChunk.call(this,p)},q.exports=f},{"../utils":32,"./GenericWorker":28}],27:[function(N,q,M){"use strict";var O=N("../utils"),D=N("./GenericWorker");function f(p){D.call(this,"DataWorker");var C=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,p.then(function(x){C.dataIsReady=!0,C.data=x,C.max=x&&x.length||0,C.type=O.getTypeOf(x),C.isPaused||C._tickAndRepeat()},function(x){C.error(x)})}O.inherits(f,D),f.prototype.cleanUp=function(){D.prototype.cleanUp.call(this),this.data=null},f.prototype.resume=function(){return!!D.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,O.delay(this._tickAndRepeat,[],this)),!0)},f.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(O.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},f.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var p=null,C=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,C);break;case"uint8array":p=this.data.subarray(this.index,C);break;case"array":case"nodebuffer":p=this.data.slice(this.index,C)}return this.index=C,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},q.exports=f},{"../utils":32,"./GenericWorker":28}],28:[function(N,q,M){"use strict";function O(D){this.name=D||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}O.prototype={push:function(D){this.emit("data",D)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(D){this.emit("error",D)}return!0},error:function(D){return!this.isFinished&&(this.isPaused?this.generatedError=D:(this.isFinished=!0,this.emit("error",D),this.previous&&this.previous.error(D),this.cleanUp()),!0)},on:function(D,f){return this._listeners[D].push(f),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(D,f){if(this._listeners[D])for(var p=0;p<this._listeners[D].length;p++)this._listeners[D][p].call(this,f)},pipe:function(D){return D.registerPrevious(this)},registerPrevious:function(D){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=D.streamInfo,this.mergeStreamInfo(),this.previous=D;var f=this;return D.on("data",function(p){f.processChunk(p)}),D.on("end",function(){f.end()}),D.on("error",function(p){f.error(p)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var D=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),D=!0),this.previous&&this.previous.resume(),!D},flush:function(){},processChunk:function(D){this.push(D)},withStreamInfo:function(D,f){return this.extraStreamInfo[D]=f,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var D in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,D)&&(this.streamInfo[D]=this.extraStreamInfo[D])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var D="Worker "+this.name;return this.previous?this.previous+" -> "+D:D}},q.exports=O},{}],29:[function(N,q,M){"use strict";var O=N("../utils"),D=N("./ConvertWorker"),f=N("./GenericWorker"),p=N("../base64"),C=N("../support"),x=N("../external"),S=null;if(C.nodestream)try{S=N("../nodejs/NodejsStreamOutputAdapter")}catch(_){}function d(_,v,I){var T=v;switch(v){case"blob":case"arraybuffer":T="uint8array";break;case"base64":T="string"}try{this._internalType=T,this._outputType=v,this._mimeType=I,O.checkSupport(T),this._worker=_.pipe(new D(T)),_.lock()}catch(L){this._worker=new f("error"),this._worker.error(L)}}d.prototype={accumulate:function(_){return function m(_,v){return new x.Promise(function(I,T){var L=[],Y=_._internalType,oe=_._outputType,B=_._mimeType;_.on("data",function(j,z){L.push(j),v&&v(z)}).on("error",function(j){L=[],T(j)}).on("end",function(){try{var j=function(z,te,ne){switch(z){case"blob":return O.newBlob(O.transformTo("arraybuffer",te),ne);case"base64":return p.encode(te);default:return O.transformTo(z,te)}}(oe,function(z,te){var ne,K=0,Ce=null,$=0;for(ne=0;ne<te.length;ne++)$+=te[ne].length;switch(z){case"string":return te.join("");case"array":return Array.prototype.concat.apply([],te);case"uint8array":for(Ce=new Uint8Array($),ne=0;ne<te.length;ne++)Ce.set(te[ne],K),K+=te[ne].length;return Ce;case"nodebuffer":return Buffer.concat(te);default:throw new Error("concat : unsupported type '"+z+"'")}}(Y,L),B);I(j)}catch(z){T(z)}L=[]}).resume()})}(this,_)},on:function(_,v){var I=this;return this._worker.on(_,"data"===_?function(T){v.call(I,T.data,T.meta)}:function(){O.delay(v,arguments,I)}),this},resume:function(){return O.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(O.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new S(this,{objectMode:"nodebuffer"!==this._outputType},_)}},q.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(N,q,M){"use strict";if(M.base64=!0,M.array=!0,M.string=!0,M.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,M.nodebuffer="undefined"!=typeof Buffer,M.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)M.blob=!1;else{var O=new ArrayBuffer(0);try{M.blob=0===new Blob([O],{type:"application/zip"}).size}catch(f){try{var D=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);D.append(O),M.blob=0===D.getBlob("application/zip").size}catch(p){M.blob=!1}}}try{M.nodestream=!!N("readable-stream").Readable}catch(f){M.nodestream=!1}},{"readable-stream":16}],31:[function(N,q,M){"use strict";for(var O=N("./utils"),D=N("./support"),f=N("./nodejsUtils"),p=N("./stream/GenericWorker"),C=new Array(256),x=0;x<256;x++)C[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;function S(){p.call(this,"utf-8 decode"),this.leftOver=null}function m(){p.call(this,"utf-8 encode")}C[254]=C[254]=1,M.utf8encode=function(d){return D.nodebuffer?f.newBufferFrom(d,"utf-8"):function(_){var v,I,T,L,Y,oe=_.length,B=0;for(L=0;L<oe;L++)55296==(64512&(I=_.charCodeAt(L)))&&L+1<oe&&56320==(64512&(T=_.charCodeAt(L+1)))&&(I=65536+(I-55296<<10)+(T-56320),L++),B+=I<128?1:I<2048?2:I<65536?3:4;for(v=D.uint8array?new Uint8Array(B):new Array(B),L=Y=0;Y<B;L++)55296==(64512&(I=_.charCodeAt(L)))&&L+1<oe&&56320==(64512&(T=_.charCodeAt(L+1)))&&(I=65536+(I-55296<<10)+(T-56320),L++),I<128?v[Y++]=I:(I<2048?v[Y++]=192|I>>>6:(I<65536?v[Y++]=224|I>>>12:(v[Y++]=240|I>>>18,v[Y++]=128|I>>>12&63),v[Y++]=128|I>>>6&63),v[Y++]=128|63&I);return v}(d)},M.utf8decode=function(d){return D.nodebuffer?O.transformTo("nodebuffer",d).toString("utf-8"):function(_){var v,I,T,L,Y=_.length,oe=new Array(2*Y);for(v=I=0;v<Y;)if((T=_[v++])<128)oe[I++]=T;else if(4<(L=C[T]))oe[I++]=65533,v+=L-1;else{for(T&=2===L?31:3===L?15:7;1<L&&v<Y;)T=T<<6|63&_[v++],L--;1<L?oe[I++]=65533:T<65536?oe[I++]=T:(oe[I++]=55296|(T-=65536)>>10&1023,oe[I++]=56320|1023&T)}return oe.length!==I&&(oe.subarray?oe=oe.subarray(0,I):oe.length=I),O.applyFromCharCode(oe)}(d=O.transformTo(D.uint8array?"uint8array":"array",d))},O.inherits(S,p),S.prototype.processChunk=function(d){var _=O.transformTo(D.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(D.uint8array){var v=_;(_=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),_.set(v,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var I=function(L,Y){var oe;for((Y=Y||L.length)>L.length&&(Y=L.length),oe=Y-1;0<=oe&&128==(192&L[oe]);)oe--;return oe<0||0===oe?Y:oe+C[L[oe]]>Y?oe:Y}(_),T=_;I!==_.length&&(D.uint8array?(T=_.subarray(0,I),this.leftOver=_.subarray(I,_.length)):(T=_.slice(0,I),this.leftOver=_.slice(I,_.length))),this.push({data:M.utf8decode(T),meta:d.meta})},S.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:M.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},M.Utf8DecodeWorker=S,O.inherits(m,p),m.prototype.processChunk=function(d){this.push({data:M.utf8encode(d.data),meta:d.meta})},M.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(N,q,M){"use strict";var O=N("./support"),D=N("./base64"),f=N("./nodejsUtils"),p=N("./external");function C(v){return v}function x(v,I){for(var T=0;T<v.length;++T)I[T]=255&v.charCodeAt(T);return I}N("setimmediate"),M.newBlob=function(v,I){M.checkSupport("blob");try{return new Blob([v],{type:I})}catch(L){try{var T=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return T.append(v),T.getBlob(I)}catch(Y){throw new Error("Bug : can't construct the Blob.")}}};var S={stringifyByChunk:function(v,I,T){var L=[],Y=0,oe=v.length;if(oe<=T)return String.fromCharCode.apply(null,v);for(;Y<oe;)L.push(String.fromCharCode.apply(null,"array"===I||"nodebuffer"===I?v.slice(Y,Math.min(Y+T,oe)):v.subarray(Y,Math.min(Y+T,oe)))),Y+=T;return L.join("")},stringifyByChar:function(v){for(var I="",T=0;T<v.length;T++)I+=String.fromCharCode(v[T]);return I},applyCanBeUsed:{uint8array:function(){try{return O.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(v){return!1}}(),nodebuffer:function(){try{return O.nodebuffer&&1===String.fromCharCode.apply(null,f.allocBuffer(1)).length}catch(v){return!1}}()}};function m(v){var I=65536,T=M.getTypeOf(v),L=!0;if("uint8array"===T?L=S.applyCanBeUsed.uint8array:"nodebuffer"===T&&(L=S.applyCanBeUsed.nodebuffer),L)for(;1<I;)try{return S.stringifyByChunk(v,T,I)}catch(Y){I=Math.floor(I/2)}return S.stringifyByChar(v)}function d(v,I){for(var T=0;T<v.length;T++)I[T]=v[T];return I}M.applyFromCharCode=m;var _={};_.string={string:C,array:function(v){return x(v,new Array(v.length))},arraybuffer:function(v){return _.string.uint8array(v).buffer},uint8array:function(v){return x(v,new Uint8Array(v.length))},nodebuffer:function(v){return x(v,f.allocBuffer(v.length))}},_.array={string:m,array:C,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(v)}},_.arraybuffer={string:function(v){return m(new Uint8Array(v))},array:function(v){return d(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:C,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(new Uint8Array(v))}},_.uint8array={string:m,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:C,nodebuffer:function(v){return f.newBufferFrom(v)}},_.nodebuffer={string:m,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return _.nodebuffer.uint8array(v).buffer},uint8array:function(v){return d(v,new Uint8Array(v.length))},nodebuffer:C},M.transformTo=function(v,I){if(I=I||"",!v)return I;M.checkSupport(v);var T=M.getTypeOf(I);return _[T][v](I)},M.resolve=function(v){for(var I=v.split("/"),T=[],L=0;L<I.length;L++){var Y=I[L];"."===Y||""===Y&&0!==L&&L!==I.length-1||(".."===Y?T.pop():T.push(Y))}return T.join("/")},M.getTypeOf=function(v){return"string"==typeof v?"string":"[object Array]"===Object.prototype.toString.call(v)?"array":O.nodebuffer&&f.isBuffer(v)?"nodebuffer":O.uint8array&&v instanceof Uint8Array?"uint8array":O.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},M.checkSupport=function(v){if(!O[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},M.MAX_VALUE_16BITS=65535,M.MAX_VALUE_32BITS=-1,M.pretty=function(v){var I,T,L="";for(T=0;T<(v||"").length;T++)L+="\\x"+((I=v.charCodeAt(T))<16?"0":"")+I.toString(16).toUpperCase();return L},M.delay=function(v,I,T){setImmediate(function(){v.apply(T||null,I||[])})},M.inherits=function(v,I){function T(){}T.prototype=I.prototype,v.prototype=new T},M.extend=function(){var v,I,T={};for(v=0;v<arguments.length;v++)for(I in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],I)&&void 0===T[I]&&(T[I]=arguments[v][I]);return T},M.prepareContent=function(v,I,T,L,Y){return p.Promise.resolve(I).then(function(oe){return O.blob&&(oe instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(oe)))&&"undefined"!=typeof FileReader?new p.Promise(function(B,j){var z=new FileReader;z.onload=function(te){B(te.target.result)},z.onerror=function(te){j(te.target.error)},z.readAsArrayBuffer(oe)}):oe}).then(function(oe){var j,B=M.getTypeOf(oe);return B?("arraybuffer"===B?oe=M.transformTo("uint8array",oe):"string"===B&&(Y?oe=D.decode(oe):T&&!0!==L&&(oe=x(j=oe,O.uint8array?new Uint8Array(j.length):new Array(j.length)))),oe):p.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(N,q,M){"use strict";var O=N("./reader/readerFor"),D=N("./utils"),f=N("./signature"),p=N("./zipEntry"),C=N("./support");function x(S){this.files=[],this.loadOptions=S}x.prototype={checkSignature:function(S){if(!this.reader.readAndCheckSignature(S)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+D.pretty(m)+", expected "+D.pretty(S)+")")}},isSignature:function(S,m){var d=this.reader.index;this.reader.setIndex(S);var _=this.reader.readString(4)===m;return this.reader.setIndex(d),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var S=this.reader.readData(this.zipCommentLength),d=D.transformTo(C.uint8array?"uint8array":"array",S);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var S,m,d,_=this.zip64EndOfCentralSize-44;0<_;)S=this.reader.readInt(2),m=this.reader.readInt(4),d=this.reader.readData(m),this.zip64ExtensibleData[S]={id:S,length:m,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var S,m;for(S=0;S<this.files.length;S++)this.reader.setIndex((m=this.files[S]).localHeaderOffset),this.checkSignature(f.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var S;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(f.CENTRAL_FILE_HEADER);)(S=new p({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(S);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var S=this.reader.lastIndexOfSignature(f.CENTRAL_DIRECTORY_END);if(S<0)throw this.isSignature(0,f.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(S);var m=S;if(this.checkSignature(f.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===D.MAX_VALUE_16BITS||this.diskWithCentralDirStart===D.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===D.MAX_VALUE_16BITS||this.centralDirRecords===D.MAX_VALUE_16BITS||this.centralDirSize===D.MAX_VALUE_32BITS||this.centralDirOffset===D.MAX_VALUE_32BITS){if(this.zip64=!0,(S=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(S),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,f.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var _=m-d;if(0<_)this.isSignature(m,f.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(S){this.reader=O(S)},load:function(S){this.prepareReader(S),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},q.exports=x},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(N,q,M){"use strict";var O=N("./reader/readerFor"),D=N("./utils"),f=N("./compressedObject"),p=N("./crc32"),C=N("./utf8"),x=N("./compressions"),S=N("./support");function m(d,_){this.options=d,this.loadOptions=_}m.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(d){var _,v;if(d.skip(22),this.fileNameLength=d.readInt(2),v=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(v),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(_=function(I){for(var T in x)if(Object.prototype.hasOwnProperty.call(x,T)&&x[T].magic===I)return x[T];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+D.pretty(this.compressionMethod)+" unknown (inner file : "+D.transformTo("string",this.fileName)+")");this.decompressed=new f(this.compressedSize,this.uncompressedSize,this.crc32,_,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var _=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(_),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==d&&(this.dosPermissions=63&this.externalFileAttributes),3==d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=O(this.extraFields[1].value);this.uncompressedSize===D.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===D.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===D.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===D.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var _,v,I,T=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<T;)_=d.readInt(2),v=d.readInt(2),I=d.readData(v),this.extraFields[_]={id:_,length:v,value:I};d.setIndex(T)},handleUTF8:function(){var d=S.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=C.utf8decode(this.fileName),this.fileCommentStr=C.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(null!==_)this.fileNameStr=_;else{var v=D.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var I=this.findExtraFieldUnicodeComment();if(null!==I)this.fileCommentStr=I;else{var T=D.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var _=O(d.value);return 1!==_.readInt(1)||p(this.fileName)!==_.readInt(4)?null:C.utf8decode(_.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var _=O(d.value);return 1!==_.readInt(1)||p(this.fileComment)!==_.readInt(4)?null:C.utf8decode(_.readData(d.length-5))}return null}},q.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(N,q,M){"use strict";function O(_,v,I){this.name=_,this.dir=I.dir,this.date=I.date,this.comment=I.comment,this.unixPermissions=I.unixPermissions,this.dosPermissions=I.dosPermissions,this._data=v,this._dataBinary=I.binary,this.options={compression:I.compression,compressionOptions:I.compressionOptions}}var D=N("./stream/StreamHelper"),f=N("./stream/DataWorker"),p=N("./utf8"),C=N("./compressedObject"),x=N("./stream/GenericWorker");O.prototype={internalStream:function(_){var v=null,I="string";try{if(!_)throw new Error("No output type specified.");var T="string"===(I=_.toLowerCase())||"text"===I;"binarystring"!==I&&"text"!==I||(I="string"),v=this._decompressWorker();var L=!this._dataBinary;L&&!T&&(v=v.pipe(new p.Utf8EncodeWorker)),!L&&T&&(v=v.pipe(new p.Utf8DecodeWorker))}catch(Y){(v=new x("error")).error(Y)}return new D(v,I,"")},async:function(_,v){return this.internalStream(_).accumulate(v)},nodeStream:function(_,v){return this.internalStream(_||"nodebuffer").toNodejsStream(v)},_compressWorker:function(_,v){if(this._data instanceof C&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var I=this._decompressWorker();return this._dataBinary||(I=I.pipe(new p.Utf8EncodeWorker)),C.createWorkerFrom(I,_,v)},_decompressWorker:function(){return this._data instanceof C?this._data.getContentWorker():this._data instanceof x?this._data:new f(this._data)}};for(var S=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<S.length;d++)O.prototype[S[d]]=m;q.exports=O},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(N,q,M){(function(O){"use strict";var D,f,p=O.MutationObserver||O.WebKitMutationObserver;if(p){var C=0,x=new p(_),S=O.document.createTextNode("");x.observe(S,{characterData:!0}),D=function(){S.data=C=++C%2}}else if(O.setImmediate||void 0===O.MessageChannel)D="document"in O&&"onreadystatechange"in O.document.createElement("script")?function(){var v=O.document.createElement("script");v.onreadystatechange=function(){_(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},O.document.documentElement.appendChild(v)}:function(){setTimeout(_,0)};else{var m=new O.MessageChannel;m.port1.onmessage=_,D=function(){m.port2.postMessage(0)}}var d=[];function _(){var v,I;f=!0;for(var T=d.length;T;){for(I=d,d=[],v=-1;++v<T;)I[v]();T=d.length}f=!1}q.exports=function(v){1!==d.push(v)||f||D()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(N,q,M){"use strict";var O=N("immediate");function D(){}var f={},p=["REJECTED"],C=["FULFILLED"],x=["PENDING"];function S(T){if("function"!=typeof T)throw new TypeError("resolver must be a function");this.state=x,this.queue=[],this.outcome=void 0,T!==D&&v(this,T)}function m(T,L,Y){this.promise=T,"function"==typeof L&&(this.onFulfilled=L,this.callFulfilled=this.otherCallFulfilled),"function"==typeof Y&&(this.onRejected=Y,this.callRejected=this.otherCallRejected)}function d(T,L,Y){O(function(){var oe;try{oe=L(Y)}catch(B){return f.reject(T,B)}oe===T?f.reject(T,new TypeError("Cannot resolve promise with itself")):f.resolve(T,oe)})}function _(T){var L=T&&T.then;if(T&&("object"==typeof T||"function"==typeof T)&&"function"==typeof L)return function(){L.apply(T,arguments)}}function v(T,L){var Y=!1;function oe(z){Y||(Y=!0,f.reject(T,z))}function B(z){Y||(Y=!0,f.resolve(T,z))}var j=I(function(){L(B,oe)});"error"===j.status&&oe(j.value)}function I(T,L){var Y={};try{Y.value=T(L),Y.status="success"}catch(oe){Y.status="error",Y.value=oe}return Y}(q.exports=S).prototype.finally=function(T){if("function"!=typeof T)return this;var L=this.constructor;return this.then(function(Y){return L.resolve(T()).then(function(){return Y})},function(Y){return L.resolve(T()).then(function(){throw Y})})},S.prototype.catch=function(T){return this.then(null,T)},S.prototype.then=function(T,L){if("function"!=typeof T&&this.state===C||"function"!=typeof L&&this.state===p)return this;var Y=new this.constructor(D);return this.state!==x?d(Y,this.state===C?T:L,this.outcome):this.queue.push(new m(Y,T,L)),Y},m.prototype.callFulfilled=function(T){f.resolve(this.promise,T)},m.prototype.otherCallFulfilled=function(T){d(this.promise,this.onFulfilled,T)},m.prototype.callRejected=function(T){f.reject(this.promise,T)},m.prototype.otherCallRejected=function(T){d(this.promise,this.onRejected,T)},f.resolve=function(T,L){var Y=I(_,L);if("error"===Y.status)return f.reject(T,Y.value);var oe=Y.value;if(oe)v(T,oe);else{T.state=C,T.outcome=L;for(var B=-1,j=T.queue.length;++B<j;)T.queue[B].callFulfilled(L)}return T},f.reject=function(T,L){T.state=p,T.outcome=L;for(var Y=-1,oe=T.queue.length;++Y<oe;)T.queue[Y].callRejected(L);return T},S.resolve=function(T){return T instanceof this?T:f.resolve(new this(D),T)},S.reject=function(T){var L=new this(D);return f.reject(L,T)},S.all=function(T){var L=this;if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var Y=T.length,oe=!1;if(!Y)return this.resolve([]);for(var B=new Array(Y),j=0,z=-1,te=new this(D);++z<Y;)ne(T[z],z);return te;function ne(K,Ce){L.resolve(K).then(function($){B[Ce]=$,++j!==Y||oe||(oe=!0,f.resolve(te,B))},function($){oe||(oe=!0,f.reject(te,$))})}},S.race=function(T){if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var Y=T.length,oe=!1;if(!Y)return this.resolve([]);for(var B=-1,j=new this(D);++B<Y;)this.resolve(T[B]).then(function(te){oe||(oe=!0,f.resolve(j,te))},function(te){oe||(oe=!0,f.reject(j,te))});return j}},{immediate:36}],38:[function(N,q,M){"use strict";var O={};(0,N("./lib/utils/common").assign)(O,N("./lib/deflate"),N("./lib/inflate"),N("./lib/zlib/constants")),q.exports=O},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(N,q,M){"use strict";var O=N("./zlib/deflate"),D=N("./utils/common"),f=N("./utils/strings"),p=N("./zlib/messages"),C=N("./zlib/zstream"),x=Object.prototype.toString;function v(T){if(!(this instanceof v))return new v(T);this.options=D.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},T||{});var L=this.options;L.raw&&0<L.windowBits?L.windowBits=-L.windowBits:L.gzip&&0<L.windowBits&&L.windowBits<16&&(L.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C,this.strm.avail_out=0;var Y=O.deflateInit2(this.strm,L.level,L.method,L.windowBits,L.memLevel,L.strategy);if(0!==Y)throw new Error(p[Y]);if(L.header&&O.deflateSetHeader(this.strm,L.header),L.dictionary){var oe;if(oe="string"==typeof L.dictionary?f.string2buf(L.dictionary):"[object ArrayBuffer]"===x.call(L.dictionary)?new Uint8Array(L.dictionary):L.dictionary,0!==(Y=O.deflateSetDictionary(this.strm,oe)))throw new Error(p[Y]);this._dict_set=!0}}function I(T,L){var Y=new v(L);if(Y.push(T,!0),Y.err)throw Y.msg||p[Y.err];return Y.result}v.prototype.push=function(T,L){var Y,oe,B=this.strm,j=this.options.chunkSize;if(this.ended)return!1;oe=L===~~L?L:!0===L?4:0,B.input="string"==typeof T?f.string2buf(T):"[object ArrayBuffer]"===x.call(T)?new Uint8Array(T):T,B.next_in=0,B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new D.Buf8(j),B.next_out=0,B.avail_out=j),1!==(Y=O.deflate(B,oe))&&0!==Y)return this.onEnd(Y),!(this.ended=!0);0!==B.avail_out&&(0!==B.avail_in||4!==oe&&2!==oe)||this.onData("string"===this.options.to?f.buf2binstring(D.shrinkBuf(B.output,B.next_out)):D.shrinkBuf(B.output,B.next_out))}while((0<B.avail_in||0===B.avail_out)&&1!==Y);return 4===oe?(Y=O.deflateEnd(this.strm),this.onEnd(Y),this.ended=!0,0===Y):2!==oe||(this.onEnd(0),!(B.avail_out=0))},v.prototype.onData=function(T){this.chunks.push(T)},v.prototype.onEnd=function(T){0===T&&(this.result="string"===this.options.to?this.chunks.join(""):D.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},M.Deflate=v,M.deflate=I,M.deflateRaw=function(T,L){return(L=L||{}).raw=!0,I(T,L)},M.gzip=function(T,L){return(L=L||{}).gzip=!0,I(T,L)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(N,q,M){"use strict";var O=N("./zlib/inflate"),D=N("./utils/common"),f=N("./utils/strings"),p=N("./zlib/constants"),C=N("./zlib/messages"),x=N("./zlib/zstream"),S=N("./zlib/gzheader"),m=Object.prototype.toString;function d(v){if(!(this instanceof d))return new d(v);this.options=D.assign({chunkSize:16384,windowBits:0,to:""},v||{});var I=this.options;I.raw&&0<=I.windowBits&&I.windowBits<16&&(I.windowBits=-I.windowBits,0===I.windowBits&&(I.windowBits=-15)),!(0<=I.windowBits&&I.windowBits<16)||v&&v.windowBits||(I.windowBits+=32),15<I.windowBits&&I.windowBits<48&&0==(15&I.windowBits)&&(I.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var T=O.inflateInit2(this.strm,I.windowBits);if(T!==p.Z_OK)throw new Error(C[T]);this.header=new S,O.inflateGetHeader(this.strm,this.header)}function _(v,I){var T=new d(I);if(T.push(v,!0),T.err)throw T.msg||C[T.err];return T.result}d.prototype.push=function(v,I){var T,L,Y,oe,B,j,z=this.strm,te=this.options.chunkSize,ne=this.options.dictionary,K=!1;if(this.ended)return!1;L=I===~~I?I:!0===I?p.Z_FINISH:p.Z_NO_FLUSH,z.input="string"==typeof v?f.binstring2buf(v):"[object ArrayBuffer]"===m.call(v)?new Uint8Array(v):v,z.next_in=0,z.avail_in=z.input.length;do{if(0===z.avail_out&&(z.output=new D.Buf8(te),z.next_out=0,z.avail_out=te),(T=O.inflate(z,p.Z_NO_FLUSH))===p.Z_NEED_DICT&&ne&&(j="string"==typeof ne?f.string2buf(ne):"[object ArrayBuffer]"===m.call(ne)?new Uint8Array(ne):ne,T=O.inflateSetDictionary(this.strm,j)),T===p.Z_BUF_ERROR&&!0===K&&(T=p.Z_OK,K=!1),T!==p.Z_STREAM_END&&T!==p.Z_OK)return this.onEnd(T),!(this.ended=!0);z.next_out&&(0!==z.avail_out&&T!==p.Z_STREAM_END&&(0!==z.avail_in||L!==p.Z_FINISH&&L!==p.Z_SYNC_FLUSH)||("string"===this.options.to?(Y=f.utf8border(z.output,z.next_out),oe=z.next_out-Y,B=f.buf2string(z.output,Y),z.next_out=oe,z.avail_out=te-oe,oe&&D.arraySet(z.output,z.output,Y,oe,0),this.onData(B)):this.onData(D.shrinkBuf(z.output,z.next_out)))),0===z.avail_in&&0===z.avail_out&&(K=!0)}while((0<z.avail_in||0===z.avail_out)&&T!==p.Z_STREAM_END);return T===p.Z_STREAM_END&&(L=p.Z_FINISH),L===p.Z_FINISH?(T=O.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===p.Z_OK):L!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),!(z.avail_out=0))},d.prototype.onData=function(v){this.chunks.push(v)},d.prototype.onEnd=function(v){v===p.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):D.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},M.Inflate=d,M.inflate=_,M.inflateRaw=function(v,I){return(I=I||{}).raw=!0,_(v,I)},M.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(N,q,M){"use strict";var O="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;M.assign=function(p){for(var C=Array.prototype.slice.call(arguments,1);C.length;){var x=C.shift();if(x){if("object"!=typeof x)throw new TypeError(x+"must be non-object");for(var S in x)x.hasOwnProperty(S)&&(p[S]=x[S])}}return p},M.shrinkBuf=function(p,C){return p.length===C?p:p.subarray?p.subarray(0,C):(p.length=C,p)};var D={arraySet:function(p,C,x,S,m){if(C.subarray&&p.subarray)p.set(C.subarray(x,x+S),m);else for(var d=0;d<S;d++)p[m+d]=C[x+d]},flattenChunks:function(p){var C,x,S,m,d,_;for(C=S=0,x=p.length;C<x;C++)S+=p[C].length;for(_=new Uint8Array(S),C=m=0,x=p.length;C<x;C++)_.set(d=p[C],m),m+=d.length;return _}},f={arraySet:function(p,C,x,S,m){for(var d=0;d<S;d++)p[m+d]=C[x+d]},flattenChunks:function(p){return[].concat.apply([],p)}};M.setTyped=function(p){p?(M.Buf8=Uint8Array,M.Buf16=Uint16Array,M.Buf32=Int32Array,M.assign(M,D)):(M.Buf8=Array,M.Buf16=Array,M.Buf32=Array,M.assign(M,f))},M.setTyped(O)},{}],42:[function(N,q,M){"use strict";var O=N("./common"),D=!0,f=!0;try{String.fromCharCode.apply(null,[0])}catch(S){D=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(S){f=!1}for(var p=new O.Buf8(256),C=0;C<256;C++)p[C]=252<=C?6:248<=C?5:240<=C?4:224<=C?3:192<=C?2:1;function x(S,m){if(m<65537&&(S.subarray&&f||!S.subarray&&D))return String.fromCharCode.apply(null,O.shrinkBuf(S,m));for(var d="",_=0;_<m;_++)d+=String.fromCharCode(S[_]);return d}p[254]=p[254]=1,M.string2buf=function(S){var m,d,_,v,I,T=S.length,L=0;for(v=0;v<T;v++)55296==(64512&(d=S.charCodeAt(v)))&&v+1<T&&56320==(64512&(_=S.charCodeAt(v+1)))&&(d=65536+(d-55296<<10)+(_-56320),v++),L+=d<128?1:d<2048?2:d<65536?3:4;for(m=new O.Buf8(L),v=I=0;I<L;v++)55296==(64512&(d=S.charCodeAt(v)))&&v+1<T&&56320==(64512&(_=S.charCodeAt(v+1)))&&(d=65536+(d-55296<<10)+(_-56320),v++),d<128?m[I++]=d:(d<2048?m[I++]=192|d>>>6:(d<65536?m[I++]=224|d>>>12:(m[I++]=240|d>>>18,m[I++]=128|d>>>12&63),m[I++]=128|d>>>6&63),m[I++]=128|63&d);return m},M.buf2binstring=function(S){return x(S,S.length)},M.binstring2buf=function(S){for(var m=new O.Buf8(S.length),d=0,_=m.length;d<_;d++)m[d]=S.charCodeAt(d);return m},M.buf2string=function(S,m){var d,_,v,I,T=m||S.length,L=new Array(2*T);for(d=_=0;d<T;)if((v=S[d++])<128)L[_++]=v;else if(4<(I=p[v]))L[_++]=65533,d+=I-1;else{for(v&=2===I?31:3===I?15:7;1<I&&d<T;)v=v<<6|63&S[d++],I--;1<I?L[_++]=65533:v<65536?L[_++]=v:(L[_++]=55296|(v-=65536)>>10&1023,L[_++]=56320|1023&v)}return x(L,_)},M.utf8border=function(S,m){var d;for((m=m||S.length)>S.length&&(m=S.length),d=m-1;0<=d&&128==(192&S[d]);)d--;return d<0||0===d?m:d+p[S[d]]>m?d:m}},{"./common":41}],43:[function(N,q,M){"use strict";q.exports=function(O,D,f,p){for(var C=65535&O|0,x=O>>>16&65535|0,S=0;0!==f;){for(f-=S=2e3<f?2e3:f;x=x+(C=C+D[p++]|0)|0,--S;);C%=65521,x%=65521}return C|x<<16|0}},{}],44:[function(N,q,M){"use strict";q.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(N,q,M){"use strict";var O=function(){for(var D,f=[],p=0;p<256;p++){D=p;for(var C=0;C<8;C++)D=1&D?3988292384^D>>>1:D>>>1;f[p]=D}return f}();q.exports=function(D,f,p,C){var x=O,S=C+p;D^=-1;for(var m=C;m<S;m++)D=D>>>8^x[255&(D^f[m])];return-1^D}},{}],46:[function(N,q,M){"use strict";var O,D=N("../utils/common"),f=N("./trees"),p=N("./adler32"),C=N("./crc32"),x=N("./messages"),_=-2,K=258,Ce=262;function ke(y,ge){return y.msg=x[ge],ge}function _e(y){return(y<<1)-(4<y?9:0)}function xe(y){for(var ge=y.length;0<=--ge;)y[ge]=0}function he(y){var ge=y.state,X=ge.pending;X>y.avail_out&&(X=y.avail_out),0!==X&&(D.arraySet(y.output,ge.pending_buf,ge.pending_out,X,y.next_out),y.next_out+=X,ge.pending_out+=X,y.total_out+=X,y.avail_out-=X,ge.pending-=X,0===ge.pending&&(ge.pending_out=0))}function pe(y,ge){f._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,ge),y.block_start=y.strstart,he(y.strm)}function Je(y,ge){y.pending_buf[y.pending++]=ge}function Ve(y,ge){y.pending_buf[y.pending++]=ge>>>8&255,y.pending_buf[y.pending++]=255&ge}function Re(y,ge){var X,H,V=y.max_chain_length,se=y.strstart,we=y.prev_length,Ee=y.nice_match,de=y.strstart>y.w_size-Ce?y.strstart-(y.w_size-Ce):0,Fe=y.window,je=y.w_mask,Ie=y.prev,lt=y.strstart+K,ln=Fe[se+we-1],Dt=Fe[se+we];y.prev_length>=y.good_match&&(V>>=2),Ee>y.lookahead&&(Ee=y.lookahead);do{if(Fe[(X=ge)+we]===Dt&&Fe[X+we-1]===ln&&Fe[X]===Fe[se]&&Fe[++X]===Fe[se+1]){se+=2,X++;do{}while(Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&Fe[++se]===Fe[++X]&&se<lt);if(H=K-(lt-se),se=lt-K,we<H){if(y.match_start=ge,Ee<=(we=H))break;ln=Fe[se+we-1],Dt=Fe[se+we]}}}while((ge=Ie[ge&je])>de&&0!=--V);return we<=y.lookahead?we:y.lookahead}function Wt(y){var ge,X,H,V,se,we,Ee,de,Fe,je,Ie=y.w_size;do{if(V=y.window_size-y.lookahead-y.strstart,y.strstart>=Ie+(Ie-Ce)){for(D.arraySet(y.window,y.window,Ie,Ie,0),y.match_start-=Ie,y.strstart-=Ie,y.block_start-=Ie,ge=X=y.hash_size;H=y.head[--ge],y.head[ge]=Ie<=H?H-Ie:0,--X;);for(ge=X=Ie;H=y.prev[--ge],y.prev[ge]=Ie<=H?H-Ie:0,--X;);V+=Ie}if(0===y.strm.avail_in)break;if(Ee=y.window,de=y.strstart+y.lookahead,je=void 0,(Fe=V)<(je=(we=y.strm).avail_in)&&(je=Fe),X=0===je?0:(we.avail_in-=je,D.arraySet(Ee,we.input,we.next_in,je,de),1===we.state.wrap?we.adler=p(we.adler,Ee,je,de):2===we.state.wrap&&(we.adler=C(we.adler,Ee,je,de)),we.next_in+=je,we.total_in+=je,je),y.lookahead+=X,y.lookahead+y.insert>=3)for(y.ins_h=y.window[se=y.strstart-y.insert],y.ins_h=(y.ins_h<<y.hash_shift^y.window[se+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[se+3-1])&y.hash_mask,y.prev[se&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=se,se++,y.insert--,!(y.lookahead+y.insert<3)););}while(y.lookahead<Ce&&0!==y.strm.avail_in)}function Le(y,ge){for(var X,H;;){if(y.lookahead<Ce){if(Wt(y),y.lookahead<Ce&&0===ge)return 1;if(0===y.lookahead)break}if(X=0,y.lookahead>=3&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+3-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),0!==X&&y.strstart-X<=y.w_size-Ce&&(y.match_length=Re(y,X)),y.match_length>=3)if(H=f._tr_tally(y,y.strstart-y.match_start,y.match_length-3),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=3){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+3-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,0!=--y.match_length;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else H=f._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(H&&(pe(y,!1),0===y.strm.avail_out))return 1}return y.insert=y.strstart<2?y.strstart:2,4===ge?(pe(y,!0),0===y.strm.avail_out?3:4):y.last_lit&&(pe(y,!1),0===y.strm.avail_out)?1:2}function De(y,ge){for(var X,H,V;;){if(y.lookahead<Ce){if(Wt(y),y.lookahead<Ce&&0===ge)return 1;if(0===y.lookahead)break}if(X=0,y.lookahead>=3&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+3-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=2,0!==X&&y.prev_length<y.max_lazy_match&&y.strstart-X<=y.w_size-Ce&&(y.match_length=Re(y,X),y.match_length<=5&&(1===y.strategy||3===y.match_length&&4096<y.strstart-y.match_start)&&(y.match_length=2)),y.prev_length>=3&&y.match_length<=y.prev_length){for(V=y.strstart+y.lookahead-3,H=f._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-3),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=V&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+3-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),0!=--y.prev_length;);if(y.match_available=0,y.match_length=2,y.strstart++,H&&(pe(y,!1),0===y.strm.avail_out))return 1}else if(y.match_available){if((H=f._tr_tally(y,0,y.window[y.strstart-1]))&&pe(y,!1),y.strstart++,y.lookahead--,0===y.strm.avail_out)return 1}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(H=f._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<2?y.strstart:2,4===ge?(pe(y,!0),0===y.strm.avail_out?3:4):y.last_lit&&(pe(y,!1),0===y.strm.avail_out)?1:2}function Pe(y,ge,X,H,V){this.good_length=y,this.max_lazy=ge,this.nice_length=X,this.max_chain=H,this.func=V}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new D.Buf16(1146),this.dyn_dtree=new D.Buf16(122),this.bl_tree=new D.Buf16(78),xe(this.dyn_ltree),xe(this.dyn_dtree),xe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new D.Buf16(16),this.heap=new D.Buf16(573),xe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new D.Buf16(573),xe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tt(y){var ge;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=2,(ge=y.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?42:113,y.adler=2===ge.wrap?0:1,ge.last_flush=0,f._tr_init(ge),0):ke(y,_)}function Zt(y){var X,ge=tt(y);return 0===ge&&((X=y.state).window_size=2*X.w_size,xe(X.head),X.max_lazy_match=O[X.level].max_lazy,X.good_match=O[X.level].good_length,X.nice_match=O[X.level].nice_length,X.max_chain_length=O[X.level].max_chain,X.strstart=0,X.block_start=0,X.lookahead=0,X.insert=0,X.match_length=X.prev_length=2,X.match_available=0,X.ins_h=0),ge}function bt(y,ge,X,H,V,se){if(!y)return _;var we=1;if(-1===ge&&(ge=6),H<0?(we=0,H=-H):15<H&&(we=2,H-=16),V<1||9<V||8!==X||H<8||15<H||ge<0||9<ge||se<0||4<se)return ke(y,_);8===H&&(H=9);var Ee=new ut;return(y.state=Ee).strm=y,Ee.wrap=we,Ee.gzhead=null,Ee.w_bits=H,Ee.w_size=1<<Ee.w_bits,Ee.w_mask=Ee.w_size-1,Ee.hash_bits=V+7,Ee.hash_size=1<<Ee.hash_bits,Ee.hash_mask=Ee.hash_size-1,Ee.hash_shift=~~((Ee.hash_bits+3-1)/3),Ee.window=new D.Buf8(2*Ee.w_size),Ee.head=new D.Buf16(Ee.hash_size),Ee.prev=new D.Buf16(Ee.w_size),Ee.lit_bufsize=1<<V+6,Ee.pending_buf_size=4*Ee.lit_bufsize,Ee.pending_buf=new D.Buf8(Ee.pending_buf_size),Ee.d_buf=1*Ee.lit_bufsize,Ee.l_buf=3*Ee.lit_bufsize,Ee.level=ge,Ee.strategy=se,Ee.method=X,Zt(y)}O=[new Pe(0,0,0,0,function(y,ge){var X=65535;for(X>y.pending_buf_size-5&&(X=y.pending_buf_size-5);;){if(y.lookahead<=1){if(Wt(y),0===y.lookahead&&0===ge)return 1;if(0===y.lookahead)break}y.strstart+=y.lookahead,y.lookahead=0;var H=y.block_start+X;if((0===y.strstart||y.strstart>=H)&&(y.lookahead=y.strstart-H,y.strstart=H,pe(y,!1),0===y.strm.avail_out)||y.strstart-y.block_start>=y.w_size-Ce&&(pe(y,!1),0===y.strm.avail_out))return 1}return y.insert=0,4===ge?(pe(y,!0),0===y.strm.avail_out?3:4):(y.strstart>y.block_start&&pe(y,!1),1)}),new Pe(4,4,8,4,Le),new Pe(4,5,16,8,Le),new Pe(4,6,32,32,Le),new Pe(4,4,16,16,De),new Pe(8,16,32,32,De),new Pe(8,16,128,128,De),new Pe(8,32,128,256,De),new Pe(32,128,258,1024,De),new Pe(32,258,258,4096,De)],M.deflateInit=function(y,ge){return bt(y,ge,8,15,8,0)},M.deflateInit2=bt,M.deflateReset=Zt,M.deflateResetKeep=tt,M.deflateSetHeader=function(y,ge){return y&&y.state?2!==y.state.wrap?_:(y.state.gzhead=ge,0):_},M.deflate=function(y,ge){var X,H,V,se;if(!y||!y.state||5<ge||ge<0)return y?ke(y,_):_;if(H=y.state,!y.output||!y.input&&0!==y.avail_in||666===H.status&&4!==ge)return ke(y,0===y.avail_out?-5:_);if(H.strm=y,X=H.last_flush,H.last_flush=ge,42===H.status)if(2===H.wrap)y.adler=0,Je(H,31),Je(H,139),Je(H,8),H.gzhead?(Je(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),Je(H,255&H.gzhead.time),Je(H,H.gzhead.time>>8&255),Je(H,H.gzhead.time>>16&255),Je(H,H.gzhead.time>>24&255),Je(H,9===H.level?2:2<=H.strategy||H.level<2?4:0),Je(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(Je(H,255&H.gzhead.extra.length),Je(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(y.adler=C(y.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(Je(H,0),Je(H,0),Je(H,0),Je(H,0),Je(H,0),Je(H,9===H.level?2:2<=H.strategy||H.level<2?4:0),Je(H,3),H.status=113);else{var we=8+(H.w_bits-8<<4)<<8;we|=(2<=H.strategy||H.level<2?0:H.level<6?1:6===H.level?2:3)<<6,0!==H.strstart&&(we|=32),we+=31-we%31,H.status=113,Ve(H,we),0!==H.strstart&&(Ve(H,y.adler>>>16),Ve(H,65535&y.adler)),y.adler=1}if(69===H.status)if(H.gzhead.extra){for(V=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>V&&(y.adler=C(y.adler,H.pending_buf,H.pending-V,V)),he(y),V=H.pending,H.pending!==H.pending_buf_size));)Je(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>V&&(y.adler=C(y.adler,H.pending_buf,H.pending-V,V)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(73===H.status)if(H.gzhead.name){V=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>V&&(y.adler=C(y.adler,H.pending_buf,H.pending-V,V)),he(y),V=H.pending,H.pending===H.pending_buf_size)){se=1;break}se=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,Je(H,se)}while(0!==se);H.gzhead.hcrc&&H.pending>V&&(y.adler=C(y.adler,H.pending_buf,H.pending-V,V)),0===se&&(H.gzindex=0,H.status=91)}else H.status=91;if(91===H.status)if(H.gzhead.comment){V=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>V&&(y.adler=C(y.adler,H.pending_buf,H.pending-V,V)),he(y),V=H.pending,H.pending===H.pending_buf_size)){se=1;break}se=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,Je(H,se)}while(0!==se);H.gzhead.hcrc&&H.pending>V&&(y.adler=C(y.adler,H.pending_buf,H.pending-V,V)),0===se&&(H.status=103)}else H.status=103;if(103===H.status&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&he(y),H.pending+2<=H.pending_buf_size&&(Je(H,255&y.adler),Je(H,y.adler>>8&255),y.adler=0,H.status=113)):H.status=113),0!==H.pending){if(he(y),0===y.avail_out)return H.last_flush=-1,0}else if(0===y.avail_in&&_e(ge)<=_e(X)&&4!==ge)return ke(y,-5);if(666===H.status&&0!==y.avail_in)return ke(y,-5);if(0!==y.avail_in||0!==H.lookahead||0!==ge&&666!==H.status){var Ee=2===H.strategy?function(de,Fe){for(var je;;){if(0===de.lookahead&&(Wt(de),0===de.lookahead)){if(0===Fe)return 1;break}if(de.match_length=0,je=f._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++,je&&(pe(de,!1),0===de.strm.avail_out))return 1}return de.insert=0,4===Fe?(pe(de,!0),0===de.strm.avail_out?3:4):de.last_lit&&(pe(de,!1),0===de.strm.avail_out)?1:2}(H,ge):3===H.strategy?function(de,Fe){for(var je,Ie,lt,ln,Dt=de.window;;){if(de.lookahead<=K){if(Wt(de),de.lookahead<=K&&0===Fe)return 1;if(0===de.lookahead)break}if(de.match_length=0,de.lookahead>=3&&0<de.strstart&&(Ie=Dt[lt=de.strstart-1])===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]){ln=de.strstart+K;do{}while(Ie===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]&&Ie===Dt[++lt]&&lt<ln);de.match_length=K-(ln-lt),de.match_length>de.lookahead&&(de.match_length=de.lookahead)}if(de.match_length>=3?(je=f._tr_tally(de,1,de.match_length-3),de.lookahead-=de.match_length,de.strstart+=de.match_length,de.match_length=0):(je=f._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++),je&&(pe(de,!1),0===de.strm.avail_out))return 1}return de.insert=0,4===Fe?(pe(de,!0),0===de.strm.avail_out?3:4):de.last_lit&&(pe(de,!1),0===de.strm.avail_out)?1:2}(H,ge):O[H.level].func(H,ge);if(3!==Ee&&4!==Ee||(H.status=666),1===Ee||3===Ee)return 0===y.avail_out&&(H.last_flush=-1),0;if(2===Ee&&(1===ge?f._tr_align(H):5!==ge&&(f._tr_stored_block(H,0,0,!1),3===ge&&(xe(H.head),0===H.lookahead&&(H.strstart=0,H.block_start=0,H.insert=0))),he(y),0===y.avail_out))return H.last_flush=-1,0}return 4!==ge?0:H.wrap<=0?1:(2===H.wrap?(Je(H,255&y.adler),Je(H,y.adler>>8&255),Je(H,y.adler>>16&255),Je(H,y.adler>>24&255),Je(H,255&y.total_in),Je(H,y.total_in>>8&255),Je(H,y.total_in>>16&255),Je(H,y.total_in>>24&255)):(Ve(H,y.adler>>>16),Ve(H,65535&y.adler)),he(y),0<H.wrap&&(H.wrap=-H.wrap),0!==H.pending?0:1)},M.deflateEnd=function(y){var ge;return y&&y.state?42!==(ge=y.state.status)&&69!==ge&&73!==ge&&91!==ge&&103!==ge&&113!==ge&&666!==ge?ke(y,_):(y.state=null,113===ge?ke(y,-3):0):_},M.deflateSetDictionary=function(y,ge){var X,H,V,se,we,Ee,de,Fe,je=ge.length;if(!y||!y.state||2===(se=(X=y.state).wrap)||1===se&&42!==X.status||X.lookahead)return _;for(1===se&&(y.adler=p(y.adler,ge,je,0)),X.wrap=0,je>=X.w_size&&(0===se&&(xe(X.head),X.strstart=0,X.block_start=0,X.insert=0),Fe=new D.Buf8(X.w_size),D.arraySet(Fe,ge,je-X.w_size,X.w_size,0),ge=Fe,je=X.w_size),we=y.avail_in,Ee=y.next_in,de=y.input,y.avail_in=je,y.next_in=0,y.input=ge,Wt(X);X.lookahead>=3;){for(H=X.strstart,V=X.lookahead-2;X.ins_h=(X.ins_h<<X.hash_shift^X.window[H+3-1])&X.hash_mask,X.prev[H&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=H,H++,--V;);X.strstart=H,X.lookahead=2,Wt(X)}return X.strstart+=X.lookahead,X.block_start=X.strstart,X.insert=X.lookahead,X.lookahead=0,X.match_length=X.prev_length=2,X.match_available=0,y.next_in=Ee,y.input=de,y.avail_in=we,X.wrap=se,0},M.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(N,q,M){"use strict";q.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(N,q,M){"use strict";q.exports=function(O,D){var f,p,C,x,S,m,d,_,v,I,T,L,Y,oe,B,j,z,te,ne,K,Ce,$,ae,b,fe;b=O.input,C=(p=O.next_in)+(O.avail_in-5),fe=O.output,S=(x=O.next_out)-(D-O.avail_out),m=x+(O.avail_out-257),d=(f=O.state).dmax,_=f.wsize,v=f.whave,I=f.wnext,T=f.window,L=f.hold,Y=f.bits,oe=f.lencode,B=f.distcode,j=(1<<f.lenbits)-1,z=(1<<f.distbits)-1;e:do{Y<15&&(L+=b[p++]<<Y,L+=b[p++]<<(Y+=8),Y+=8),te=oe[L&j];t:for(;;){if(L>>>=ne=te>>>24,Y-=ne,0==(ne=te>>>16&255))fe[x++]=65535&te;else{if(!(16&ne)){if(0==(64&ne)){te=oe[(65535&te)+(L&(1<<ne)-1)];continue t}if(32&ne){f.mode=12;break e}O.msg="invalid literal/length code",f.mode=30;break e}K=65535&te,(ne&=15)&&(Y<ne&&(L+=b[p++]<<Y,Y+=8),K+=L&(1<<ne)-1,L>>>=ne,Y-=ne),Y<15&&(L+=b[p++]<<Y,L+=b[p++]<<(Y+=8),Y+=8),te=B[L&z];n:for(;;){if(L>>>=ne=te>>>24,Y-=ne,!(16&(ne=te>>>16&255))){if(0==(64&ne)){te=B[(65535&te)+(L&(1<<ne)-1)];continue n}O.msg="invalid distance code",f.mode=30;break e}if(Ce=65535&te,Y<(ne&=15)&&(L+=b[p++]<<Y,(Y+=8)<ne&&(L+=b[p++]<<Y,Y+=8)),d<(Ce+=L&(1<<ne)-1)){O.msg="invalid distance too far back",f.mode=30;break e}if(L>>>=ne,Y-=ne,(ne=x-S)<Ce){if(v<(ne=Ce-ne)&&f.sane){O.msg="invalid distance too far back",f.mode=30;break e}if(ae=T,($=0)===I){if($+=_-ne,ne<K){for(K-=ne;fe[x++]=T[$++],--ne;);$=x-Ce,ae=fe}}else if(I<ne){if($+=_+I-ne,(ne-=I)<K){for(K-=ne;fe[x++]=T[$++],--ne;);if($=0,I<K){for(K-=ne=I;fe[x++]=T[$++],--ne;);$=x-Ce,ae=fe}}}else if($+=I-ne,ne<K){for(K-=ne;fe[x++]=T[$++],--ne;);$=x-Ce,ae=fe}for(;2<K;)fe[x++]=ae[$++],fe[x++]=ae[$++],fe[x++]=ae[$++],K-=3;K&&(fe[x++]=ae[$++],1<K&&(fe[x++]=ae[$++]))}else{for($=x-Ce;fe[x++]=fe[$++],fe[x++]=fe[$++],fe[x++]=fe[$++],2<(K-=3););K&&(fe[x++]=fe[$++],1<K&&(fe[x++]=fe[$++]))}break}}break}}while(p<C&&x<m);p-=K=Y>>3,L&=(1<<(Y-=K<<3))-1,O.next_in=p,O.next_out=x,O.avail_in=p<C?C-p+5:5-(p-C),O.avail_out=x<m?m-x+257:257-(x-m),f.hold=L,f.bits=Y}},{}],49:[function(N,q,M){"use strict";var O=N("../utils/common"),D=N("./adler32"),f=N("./crc32"),p=N("./inffast"),C=N("./inftrees"),d=-2;function T($){return($>>>24&255)+($>>>8&65280)+((65280&$)<<8)+((255&$)<<24)}function L(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new O.Buf16(320),this.work=new O.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Y($){var ae;return $&&$.state?($.total_in=$.total_out=(ae=$.state).total=0,$.msg="",ae.wrap&&($.adler=1&ae.wrap),ae.mode=1,ae.last=0,ae.havedict=0,ae.dmax=32768,ae.head=null,ae.hold=0,ae.bits=0,ae.lencode=ae.lendyn=new O.Buf32(852),ae.distcode=ae.distdyn=new O.Buf32(592),ae.sane=1,ae.back=-1,0):d}function oe($){var ae;return $&&$.state?((ae=$.state).wsize=0,ae.whave=0,ae.wnext=0,Y($)):d}function B($,ae){var b,fe;return $&&$.state?(fe=$.state,ae<0?(b=0,ae=-ae):(b=1+(ae>>4),ae<48&&(ae&=15)),ae&&(ae<8||15<ae)?d:(null!==fe.window&&fe.wbits!==ae&&(fe.window=null),fe.wrap=b,fe.wbits=ae,oe($))):d}function j($,ae){var b,fe;return $?(fe=new L,($.state=fe).window=null,0!==(b=B($,ae))&&($.state=null),b):d}var z,te,ne=!0;function K($){if(ne){var ae;for(z=new O.Buf32(512),te=new O.Buf32(32),ae=0;ae<144;)$.lens[ae++]=8;for(;ae<256;)$.lens[ae++]=9;for(;ae<280;)$.lens[ae++]=7;for(;ae<288;)$.lens[ae++]=8;for(C(1,$.lens,0,288,z,0,$.work,{bits:9}),ae=0;ae<32;)$.lens[ae++]=5;C(2,$.lens,0,32,te,0,$.work,{bits:5}),ne=!1}$.lencode=z,$.lenbits=9,$.distcode=te,$.distbits=5}function Ce($,ae,b,fe){var Ne,ce=$.state;return null===ce.window&&(ce.wsize=1<<ce.wbits,ce.wnext=0,ce.whave=0,ce.window=new O.Buf8(ce.wsize)),fe>=ce.wsize?(O.arraySet(ce.window,ae,b-ce.wsize,ce.wsize,0),ce.wnext=0,ce.whave=ce.wsize):(fe<(Ne=ce.wsize-ce.wnext)&&(Ne=fe),O.arraySet(ce.window,ae,b-fe,Ne,ce.wnext),(fe-=Ne)?(O.arraySet(ce.window,ae,b-fe,fe,0),ce.wnext=fe,ce.whave=ce.wsize):(ce.wnext+=Ne,ce.wnext===ce.wsize&&(ce.wnext=0),ce.whave<ce.wsize&&(ce.whave+=Ne))),0}M.inflateReset=oe,M.inflateReset2=B,M.inflateResetKeep=Y,M.inflateInit=function($){return j($,15)},M.inflateInit2=j,M.inflate=function($,ae){var b,fe,Ne,ce,ke,_e,xe,he,pe,Je,Ve,Re,Wt,Le,De,Pe,ut,tt,Zt,bt,y,ge,X,H,V=0,se=new O.Buf8(4),we=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&0!==$.avail_in)return d;12===(b=$.state).mode&&(b.mode=13),ke=$.next_out,Ne=$.output,ce=$.next_in,fe=$.input,he=b.hold,pe=b.bits,Je=_e=$.avail_in,Ve=xe=$.avail_out,ge=0;e:for(;;)switch(b.mode){case 1:if(0===b.wrap){b.mode=13;break}for(;pe<16;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(2&b.wrap&&35615===he){se[b.check=0]=255&he,se[1]=he>>>8&255,b.check=f(b.check,se,2,0),pe=he=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&he)<<8)+(he>>8))%31){$.msg="incorrect header check",b.mode=30;break}if(8!=(15&he)){$.msg="unknown compression method",b.mode=30;break}if(pe-=4,y=8+(15&(he>>>=4)),0===b.wbits)b.wbits=y;else if(y>b.wbits){$.msg="invalid window size",b.mode=30;break}b.dmax=1<<y,$.adler=b.check=1,b.mode=512&he?10:12,pe=he=0;break;case 2:for(;pe<16;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(b.flags=he,8!=(255&b.flags)){$.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){$.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=he>>8&1),512&b.flags&&(se[0]=255&he,se[1]=he>>>8&255,b.check=f(b.check,se,2,0)),pe=he=0,b.mode=3;case 3:for(;pe<32;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}b.head&&(b.head.time=he),512&b.flags&&(se[0]=255&he,se[1]=he>>>8&255,se[2]=he>>>16&255,se[3]=he>>>24&255,b.check=f(b.check,se,4,0)),pe=he=0,b.mode=4;case 4:for(;pe<16;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}b.head&&(b.head.xflags=255&he,b.head.os=he>>8),512&b.flags&&(se[0]=255&he,se[1]=he>>>8&255,b.check=f(b.check,se,2,0)),pe=he=0,b.mode=5;case 5:if(1024&b.flags){for(;pe<16;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}b.length=he,b.head&&(b.head.extra_len=he),512&b.flags&&(se[0]=255&he,se[1]=he>>>8&255,b.check=f(b.check,se,2,0)),pe=he=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(_e<(Re=b.length)&&(Re=_e),Re&&(b.head&&(y=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),O.arraySet(b.head.extra,fe,ce,Re,y)),512&b.flags&&(b.check=f(b.check,fe,Re,ce)),_e-=Re,ce+=Re,b.length-=Re),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(0===_e)break e;for(Re=0;y=fe[ce+Re++],b.head&&y&&b.length<65536&&(b.head.name+=String.fromCharCode(y)),y&&Re<_e;);if(512&b.flags&&(b.check=f(b.check,fe,Re,ce)),_e-=Re,ce+=Re,y)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(0===_e)break e;for(Re=0;y=fe[ce+Re++],b.head&&y&&b.length<65536&&(b.head.comment+=String.fromCharCode(y)),y&&Re<_e;);if(512&b.flags&&(b.check=f(b.check,fe,Re,ce)),_e-=Re,ce+=Re,y)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;pe<16;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(he!==(65535&b.check)){$.msg="header crc mismatch",b.mode=30;break}pe=he=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),$.adler=b.check=0,b.mode=12;break;case 10:for(;pe<32;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}$.adler=b.check=T(he),pe=he=0,b.mode=11;case 11:if(0===b.havedict)return $.next_out=ke,$.avail_out=xe,$.next_in=ce,$.avail_in=_e,b.hold=he,b.bits=pe,2;$.adler=b.check=1,b.mode=12;case 12:if(5===ae||6===ae)break e;case 13:if(b.last){he>>>=7&pe,pe-=7&pe,b.mode=27;break}for(;pe<3;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}switch(b.last=1&he,pe-=1,3&(he>>>=1)){case 0:b.mode=14;break;case 1:if(K(b),b.mode=20,6!==ae)break;he>>>=2,pe-=2;break e;case 2:b.mode=17;break;case 3:$.msg="invalid block type",b.mode=30}he>>>=2,pe-=2;break;case 14:for(he>>>=7&pe,pe-=7&pe;pe<32;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if((65535&he)!=(he>>>16^65535)){$.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&he,pe=he=0,b.mode=15,6===ae)break e;case 15:b.mode=16;case 16:if(Re=b.length){if(_e<Re&&(Re=_e),xe<Re&&(Re=xe),0===Re)break e;O.arraySet(Ne,fe,ce,Re,ke),_e-=Re,ce+=Re,xe-=Re,ke+=Re,b.length-=Re;break}b.mode=12;break;case 17:for(;pe<14;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(b.nlen=257+(31&he),pe-=5,b.ndist=1+(31&(he>>>=5)),pe-=5,b.ncode=4+(15&(he>>>=5)),he>>>=4,pe-=4,286<b.nlen||30<b.ndist){$.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;pe<3;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}b.lens[we[b.have++]]=7&he,he>>>=3,pe-=3}for(;b.have<19;)b.lens[we[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,ge=C(0,b.lens,0,19,b.lencode,0,b.work,X={bits:b.lenbits}),b.lenbits=X.bits,ge){$.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;Pe=(V=b.lencode[he&(1<<b.lenbits)-1])>>>16&255,ut=65535&V,!((De=V>>>24)<=pe);){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(ut<16)he>>>=De,pe-=De,b.lens[b.have++]=ut;else{if(16===ut){for(H=De+2;pe<H;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(he>>>=De,pe-=De,0===b.have){$.msg="invalid bit length repeat",b.mode=30;break}y=b.lens[b.have-1],Re=3+(3&he),he>>>=2,pe-=2}else if(17===ut){for(H=De+3;pe<H;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}pe-=De,y=0,Re=3+(7&(he>>>=De)),he>>>=3,pe-=3}else{for(H=De+7;pe<H;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}pe-=De,y=0,Re=11+(127&(he>>>=De)),he>>>=7,pe-=7}if(b.have+Re>b.nlen+b.ndist){$.msg="invalid bit length repeat",b.mode=30;break}for(;Re--;)b.lens[b.have++]=y}}if(30===b.mode)break;if(0===b.lens[256]){$.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,ge=C(1,b.lens,0,b.nlen,b.lencode,0,b.work,X={bits:b.lenbits}),b.lenbits=X.bits,ge){$.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,ge=C(2,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,X={bits:b.distbits}),b.distbits=X.bits,ge){$.msg="invalid distances set",b.mode=30;break}if(b.mode=20,6===ae)break e;case 20:b.mode=21;case 21:if(6<=_e&&258<=xe){$.next_out=ke,$.avail_out=xe,$.next_in=ce,$.avail_in=_e,b.hold=he,b.bits=pe,p($,Ve),ke=$.next_out,Ne=$.output,xe=$.avail_out,ce=$.next_in,fe=$.input,_e=$.avail_in,he=b.hold,pe=b.bits,12===b.mode&&(b.back=-1);break}for(b.back=0;Pe=(V=b.lencode[he&(1<<b.lenbits)-1])>>>16&255,ut=65535&V,!((De=V>>>24)<=pe);){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(Pe&&0==(240&Pe)){for(tt=De,Zt=Pe,bt=ut;Pe=(V=b.lencode[bt+((he&(1<<tt+Zt)-1)>>tt)])>>>16&255,ut=65535&V,!(tt+(De=V>>>24)<=pe);){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}he>>>=tt,pe-=tt,b.back+=tt}if(he>>>=De,pe-=De,b.back+=De,b.length=ut,0===Pe){b.mode=26;break}if(32&Pe){b.back=-1,b.mode=12;break}if(64&Pe){$.msg="invalid literal/length code",b.mode=30;break}b.extra=15&Pe,b.mode=22;case 22:if(b.extra){for(H=b.extra;pe<H;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}b.length+=he&(1<<b.extra)-1,he>>>=b.extra,pe-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;Pe=(V=b.distcode[he&(1<<b.distbits)-1])>>>16&255,ut=65535&V,!((De=V>>>24)<=pe);){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(0==(240&Pe)){for(tt=De,Zt=Pe,bt=ut;Pe=(V=b.distcode[bt+((he&(1<<tt+Zt)-1)>>tt)])>>>16&255,ut=65535&V,!(tt+(De=V>>>24)<=pe);){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}he>>>=tt,pe-=tt,b.back+=tt}if(he>>>=De,pe-=De,b.back+=De,64&Pe){$.msg="invalid distance code",b.mode=30;break}b.offset=ut,b.extra=15&Pe,b.mode=24;case 24:if(b.extra){for(H=b.extra;pe<H;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}b.offset+=he&(1<<b.extra)-1,he>>>=b.extra,pe-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){$.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(0===xe)break e;if(b.offset>(Re=Ve-xe)){if((Re=b.offset-Re)>b.whave&&b.sane){$.msg="invalid distance too far back",b.mode=30;break}Wt=Re>b.wnext?b.wsize-(Re-=b.wnext):b.wnext-Re,Re>b.length&&(Re=b.length),Le=b.window}else Le=Ne,Wt=ke-b.offset,Re=b.length;for(xe<Re&&(Re=xe),xe-=Re,b.length-=Re;Ne[ke++]=Le[Wt++],--Re;);0===b.length&&(b.mode=21);break;case 26:if(0===xe)break e;Ne[ke++]=b.length,xe--,b.mode=21;break;case 27:if(b.wrap){for(;pe<32;){if(0===_e)break e;_e--,he|=fe[ce++]<<pe,pe+=8}if($.total_out+=Ve-=xe,b.total+=Ve,Ve&&($.adler=b.check=b.flags?f(b.check,Ne,Ve,ke-Ve):D(b.check,Ne,Ve,ke-Ve)),Ve=xe,(b.flags?he:T(he))!==b.check){$.msg="incorrect data check",b.mode=30;break}pe=he=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;pe<32;){if(0===_e)break e;_e--,he+=fe[ce++]<<pe,pe+=8}if(he!==(4294967295&b.total)){$.msg="incorrect length check",b.mode=30;break}pe=he=0}b.mode=29;case 29:ge=1;break e;case 30:ge=-3;break e;case 31:return-4;default:return d}return $.next_out=ke,$.avail_out=xe,$.next_in=ce,$.avail_in=_e,b.hold=he,b.bits=pe,(b.wsize||Ve!==$.avail_out&&b.mode<30&&(b.mode<27||4!==ae))&&Ce($,$.output,$.next_out,Ve-$.avail_out)?(b.mode=31,-4):(Ve-=$.avail_out,$.total_in+=Je-=$.avail_in,$.total_out+=Ve,b.total+=Ve,b.wrap&&Ve&&($.adler=b.check=b.flags?f(b.check,Ne,Ve,$.next_out-Ve):D(b.check,Ne,Ve,$.next_out-Ve)),$.data_type=b.bits+(b.last?64:0)+(12===b.mode?128:0)+(20===b.mode||15===b.mode?256:0),(0==Je&&0===Ve||4===ae)&&0===ge&&(ge=-5),ge)},M.inflateEnd=function($){if(!$||!$.state)return d;var ae=$.state;return ae.window&&(ae.window=null),$.state=null,0},M.inflateGetHeader=function($,ae){var b;return $&&$.state?0==(2&(b=$.state).wrap)?d:((b.head=ae).done=!1,0):d},M.inflateSetDictionary=function($,ae){var b,fe=ae.length;return $&&$.state?0!==(b=$.state).wrap&&11!==b.mode?d:11===b.mode&&D(1,ae,fe,0)!==b.check?-3:Ce($,ae,fe,fe)?(b.mode=31,-4):(b.havedict=1,0):d},M.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(N,q,M){"use strict";var O=N("../utils/common"),D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],C=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];q.exports=function(x,S,m,d,_,v,I,T){var L,Y,oe,B,j,z,te,ne,K,Ce=T.bits,$=0,ae=0,b=0,fe=0,Ne=0,ce=0,ke=0,_e=0,xe=0,he=0,pe=null,Je=0,Ve=new O.Buf16(16),Re=new O.Buf16(16),Wt=null,Le=0;for($=0;$<=15;$++)Ve[$]=0;for(ae=0;ae<d;ae++)Ve[S[m+ae]]++;for(Ne=Ce,fe=15;1<=fe&&0===Ve[fe];fe--);if(fe<Ne&&(Ne=fe),0===fe)return _[v++]=20971520,_[v++]=20971520,T.bits=1,0;for(b=1;b<fe&&0===Ve[b];b++);for(Ne<b&&(Ne=b),$=_e=1;$<=15;$++)if(_e<<=1,(_e-=Ve[$])<0)return-1;if(0<_e&&(0===x||1!==fe))return-1;for(Re[1]=0,$=1;$<15;$++)Re[$+1]=Re[$]+Ve[$];for(ae=0;ae<d;ae++)0!==S[m+ae]&&(I[Re[S[m+ae]]++]=ae);if(z=0===x?(pe=Wt=I,19):1===x?(pe=D,Je-=257,Wt=f,Le-=257,256):(pe=p,Wt=C,-1),$=b,j=v,ke=ae=he=0,oe=-1,B=(xe=1<<(ce=Ne))-1,1===x&&852<xe||2===x&&592<xe)return 1;for(;;){for(te=$-ke,K=I[ae]<z?(ne=0,I[ae]):I[ae]>z?(ne=Wt[Le+I[ae]],pe[Je+I[ae]]):(ne=96,0),L=1<<$-ke,b=Y=1<<ce;_[j+(he>>ke)+(Y-=L)]=te<<24|ne<<16|K|0,0!==Y;);for(L=1<<$-1;he&L;)L>>=1;if(0!==L?(he&=L-1,he+=L):he=0,ae++,0==--Ve[$]){if($===fe)break;$=S[m+I[ae]]}if(Ne<$&&(he&B)!==oe){for(0===ke&&(ke=Ne),j+=b,_e=1<<(ce=$-ke);ce+ke<fe&&!((_e-=Ve[ce+ke])<=0);)ce++,_e<<=1;if(xe+=1<<ce,1===x&&852<xe||2===x&&592<xe)return 1;_[oe=he&B]=Ne<<24|ce<<16|j-v|0}}return 0!==he&&(_[j+he]=$-ke<<24|64<<16|0),T.bits=Ne,0}},{"../utils/common":41}],51:[function(N,q,M){"use strict";q.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(N,q,M){"use strict";var O=N("../utils/common");function p(V){for(var se=V.length;0<=--se;)V[se]=0}var S=256,m=286,d=30,I=15,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ce=new Array(576);p(Ce);var $=new Array(60);p($);var ae=new Array(512);p(ae);var b=new Array(256);p(b);var fe=new Array(29);p(fe);var Ne,ce,ke,_e=new Array(d);function xe(V,se,we,Ee,de){this.static_tree=V,this.extra_bits=se,this.extra_base=we,this.elems=Ee,this.max_length=de,this.has_stree=V&&V.length}function he(V,se){this.dyn_tree=V,this.max_code=0,this.stat_desc=se}function pe(V){return V<256?ae[V]:ae[256+(V>>>7)]}function Je(V,se){V.pending_buf[V.pending++]=255&se,V.pending_buf[V.pending++]=se>>>8&255}function Ve(V,se,we){V.bi_valid>16-we?(V.bi_buf|=se<<V.bi_valid&65535,Je(V,V.bi_buf),V.bi_buf=se>>16-V.bi_valid,V.bi_valid+=we-16):(V.bi_buf|=se<<V.bi_valid&65535,V.bi_valid+=we)}function Re(V,se,we){Ve(V,we[2*se],we[2*se+1])}function Wt(V,se){for(var we=0;we|=1&V,V>>>=1,we<<=1,0<--se;);return we>>>1}function Le(V,se,we){var Ee,de,Fe=new Array(16),je=0;for(Ee=1;Ee<=I;Ee++)Fe[Ee]=je=je+we[Ee-1]<<1;for(de=0;de<=se;de++){var Ie=V[2*de+1];0!==Ie&&(V[2*de]=Wt(Fe[Ie]++,Ie))}}function De(V){var se;for(se=0;se<m;se++)V.dyn_ltree[2*se]=0;for(se=0;se<d;se++)V.dyn_dtree[2*se]=0;for(se=0;se<19;se++)V.bl_tree[2*se]=0;V.dyn_ltree[512]=1,V.opt_len=V.static_len=0,V.last_lit=V.matches=0}function Pe(V){8<V.bi_valid?Je(V,V.bi_buf):0<V.bi_valid&&(V.pending_buf[V.pending++]=V.bi_buf),V.bi_buf=0,V.bi_valid=0}function ut(V,se,we,Ee){var de=2*se,Fe=2*we;return V[de]<V[Fe]||V[de]===V[Fe]&&Ee[se]<=Ee[we]}function tt(V,se,we){for(var Ee=V.heap[we],de=we<<1;de<=V.heap_len&&(de<V.heap_len&&ut(se,V.heap[de+1],V.heap[de],V.depth)&&de++,!ut(se,Ee,V.heap[de],V.depth));)V.heap[we]=V.heap[de],we=de,de<<=1;V.heap[we]=Ee}function Zt(V,se,we){var Ee,de,Fe,je,Ie=0;if(0!==V.last_lit)for(;Ee=V.pending_buf[V.d_buf+2*Ie]<<8|V.pending_buf[V.d_buf+2*Ie+1],de=V.pending_buf[V.l_buf+Ie],Ie++,0===Ee?Re(V,de,se):(Re(V,(Fe=b[de])+S+1,se),0!==(je=z[Fe])&&Ve(V,de-=fe[Fe],je),Re(V,Fe=pe(--Ee),we),0!==(je=te[Fe])&&Ve(V,Ee-=_e[Fe],je)),Ie<V.last_lit;);Re(V,256,se)}function bt(V,se){var we,Ee,de,Fe=se.dyn_tree,je=se.stat_desc.static_tree,Ie=se.stat_desc.has_stree,lt=se.stat_desc.elems,ln=-1;for(V.heap_len=0,V.heap_max=573,we=0;we<lt;we++)0!==Fe[2*we]?(V.heap[++V.heap_len]=ln=we,V.depth[we]=0):Fe[2*we+1]=0;for(;V.heap_len<2;)Fe[2*(de=V.heap[++V.heap_len]=ln<2?++ln:0)]=1,V.depth[de]=0,V.opt_len--,Ie&&(V.static_len-=je[2*de+1]);for(se.max_code=ln,we=V.heap_len>>1;1<=we;we--)tt(V,Fe,we);for(de=lt;we=V.heap[1],V.heap[1]=V.heap[V.heap_len--],tt(V,Fe,1),Ee=V.heap[1],V.heap[--V.heap_max]=we,V.heap[--V.heap_max]=Ee,Fe[2*de]=Fe[2*we]+Fe[2*Ee],V.depth[de]=(V.depth[we]>=V.depth[Ee]?V.depth[we]:V.depth[Ee])+1,Fe[2*we+1]=Fe[2*Ee+1]=de,V.heap[1]=de++,tt(V,Fe,1),2<=V.heap_len;);V.heap[--V.heap_max]=V.heap[1],function(Dt,Mi){var ms,Vi,Yo,pn,_s,qo,er=Mi.dyn_tree,wc=Mi.max_code,od=Mi.stat_desc.static_tree,Xa=Mi.stat_desc.has_stree,Ka=Mi.stat_desc.extra_bits,ia=Mi.stat_desc.extra_base,hr=Mi.stat_desc.max_length,Xo=0;for(pn=0;pn<=I;pn++)Dt.bl_count[pn]=0;for(er[2*Dt.heap[Dt.heap_max]+1]=0,ms=Dt.heap_max+1;ms<573;ms++)hr<(pn=er[2*er[2*(Vi=Dt.heap[ms])+1]+1]+1)&&(pn=hr,Xo++),er[2*Vi+1]=pn,wc<Vi||(Dt.bl_count[pn]++,_s=0,ia<=Vi&&(_s=Ka[Vi-ia]),Dt.opt_len+=(qo=er[2*Vi])*(pn+_s),Xa&&(Dt.static_len+=qo*(od[2*Vi+1]+_s)));if(0!==Xo){do{for(pn=hr-1;0===Dt.bl_count[pn];)pn--;Dt.bl_count[pn]--,Dt.bl_count[pn+1]+=2,Dt.bl_count[hr]--,Xo-=2}while(0<Xo);for(pn=hr;0!==pn;pn--)for(Vi=Dt.bl_count[pn];0!==Vi;)wc<(Yo=Dt.heap[--ms])||(er[2*Yo+1]!==pn&&(Dt.opt_len+=(pn-er[2*Yo+1])*er[2*Yo],er[2*Yo+1]=pn),Vi--)}}(V,se),Le(Fe,ln,V.bl_count)}function y(V,se,we){var Ee,de,Fe=-1,je=se[1],Ie=0,lt=7,ln=4;for(0===je&&(lt=138,ln=3),se[2*(we+1)+1]=65535,Ee=0;Ee<=we;Ee++)de=je,je=se[2*(Ee+1)+1],++Ie<lt&&de===je||(Ie<ln?V.bl_tree[2*de]+=Ie:0!==de?(de!==Fe&&V.bl_tree[2*de]++,V.bl_tree[32]++):Ie<=10?V.bl_tree[34]++:V.bl_tree[36]++,Fe=de,ln=(Ie=0)===je?(lt=138,3):de===je?(lt=6,3):(lt=7,4))}function ge(V,se,we){var Ee,de,Fe=-1,je=se[1],Ie=0,lt=7,ln=4;for(0===je&&(lt=138,ln=3),Ee=0;Ee<=we;Ee++)if(de=je,je=se[2*(Ee+1)+1],!(++Ie<lt&&de===je)){if(Ie<ln)for(;Re(V,de,V.bl_tree),0!=--Ie;);else 0!==de?(de!==Fe&&(Re(V,de,V.bl_tree),Ie--),Re(V,16,V.bl_tree),Ve(V,Ie-3,2)):Ie<=10?(Re(V,17,V.bl_tree),Ve(V,Ie-3,3)):(Re(V,18,V.bl_tree),Ve(V,Ie-11,7));Fe=de,ln=(Ie=0)===je?(lt=138,3):de===je?(lt=6,3):(lt=7,4)}}p(_e);var X=!1;function H(V,se,we,Ee){var de,Fe,je;Ve(V,0+(Ee?1:0),3),Fe=se,je=we,Pe(de=V),Je(de,je),Je(de,~je),O.arraySet(de.pending_buf,de.window,Fe,je,de.pending),de.pending+=je}M._tr_init=function(V){X||(function(){var se,we,Ee,de,Fe,je=new Array(16);for(de=Ee=0;de<28;de++)for(fe[de]=Ee,se=0;se<1<<z[de];se++)b[Ee++]=de;for(b[Ee-1]=de,de=Fe=0;de<16;de++)for(_e[de]=Fe,se=0;se<1<<te[de];se++)ae[Fe++]=de;for(Fe>>=7;de<d;de++)for(_e[de]=Fe<<7,se=0;se<1<<te[de]-7;se++)ae[256+Fe++]=de;for(we=0;we<=I;we++)je[we]=0;for(se=0;se<=143;)Ce[2*se+1]=8,se++,je[8]++;for(;se<=255;)Ce[2*se+1]=9,se++,je[9]++;for(;se<=279;)Ce[2*se+1]=7,se++,je[7]++;for(;se<=287;)Ce[2*se+1]=8,se++,je[8]++;for(Le(Ce,287,je),se=0;se<d;se++)$[2*se+1]=5,$[2*se]=Wt(se,5);Ne=new xe(Ce,z,257,m,I),ce=new xe($,te,0,d,I),ke=new xe(new Array(0),ne,0,19,7)}(),X=!0),V.l_desc=new he(V.dyn_ltree,Ne),V.d_desc=new he(V.dyn_dtree,ce),V.bl_desc=new he(V.bl_tree,ke),V.bi_buf=0,V.bi_valid=0,De(V)},M._tr_stored_block=H,M._tr_flush_block=function(V,se,we,Ee){var de,Fe,je=0;0<V.level?(2===V.strm.data_type&&(V.strm.data_type=function(Ie){var lt,ln=4093624447;for(lt=0;lt<=31;lt++,ln>>>=1)if(1&ln&&0!==Ie.dyn_ltree[2*lt])return 0;if(0!==Ie.dyn_ltree[18]||0!==Ie.dyn_ltree[20]||0!==Ie.dyn_ltree[26])return 1;for(lt=32;lt<S;lt++)if(0!==Ie.dyn_ltree[2*lt])return 1;return 0}(V)),bt(V,V.l_desc),bt(V,V.d_desc),je=function(Ie){var lt;for(y(Ie,Ie.dyn_ltree,Ie.l_desc.max_code),y(Ie,Ie.dyn_dtree,Ie.d_desc.max_code),bt(Ie,Ie.bl_desc),lt=18;3<=lt&&0===Ie.bl_tree[2*K[lt]+1];lt--);return Ie.opt_len+=3*(lt+1)+5+5+4,lt}(V),(Fe=V.static_len+3+7>>>3)<=(de=V.opt_len+3+7>>>3)&&(de=Fe)):de=Fe=we+5,we+4<=de&&-1!==se?H(V,se,we,Ee):4===V.strategy||Fe===de?(Ve(V,2+(Ee?1:0),3),Zt(V,Ce,$)):(Ve(V,4+(Ee?1:0),3),function(Ie,lt,ln,Dt){var Mi;for(Ve(Ie,lt-257,5),Ve(Ie,ln-1,5),Ve(Ie,Dt-4,4),Mi=0;Mi<Dt;Mi++)Ve(Ie,Ie.bl_tree[2*K[Mi]+1],3);ge(Ie,Ie.dyn_ltree,lt-1),ge(Ie,Ie.dyn_dtree,ln-1)}(V,V.l_desc.max_code+1,V.d_desc.max_code+1,je+1),Zt(V,V.dyn_ltree,V.dyn_dtree)),De(V),Ee&&Pe(V)},M._tr_tally=function(V,se,we){return V.pending_buf[V.d_buf+2*V.last_lit]=se>>>8&255,V.pending_buf[V.d_buf+2*V.last_lit+1]=255&se,V.pending_buf[V.l_buf+V.last_lit]=255&we,V.last_lit++,0===se?V.dyn_ltree[2*we]++:(V.matches++,se--,V.dyn_ltree[2*(b[we]+S+1)]++,V.dyn_dtree[2*pe(se)]++),V.last_lit===V.lit_bufsize-1},M._tr_align=function(V){var se;Ve(V,2,3),Re(V,256,Ce),16===(se=V).bi_valid?(Je(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}},{"../utils/common":41}],53:[function(N,q,M){"use strict";q.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(N,q,M){(function(O){!function(D,f){"use strict";if(!D.setImmediate){var p,C,x,S,m=1,d={},_=!1,v=D.document,I=Object.getPrototypeOf&&Object.getPrototypeOf(D);I=I&&I.setTimeout?I:D,p="[object process]"==={}.toString.call(D.process)?function(oe){process.nextTick(function(){L(oe)})}:function(){if(D.postMessage&&!D.importScripts){var oe=!0,B=D.onmessage;return D.onmessage=function(){oe=!1},D.postMessage("","*"),D.onmessage=B,oe}}()?(S="setImmediate$"+Math.random()+"$",D.addEventListener?D.addEventListener("message",Y,!1):D.attachEvent("onmessage",Y),function(oe){D.postMessage(S+oe,"*")}):D.MessageChannel?((x=new MessageChannel).port1.onmessage=function(oe){L(oe.data)},function(oe){x.port2.postMessage(oe)}):v&&"onreadystatechange"in v.createElement("script")?(C=v.documentElement,function(oe){var B=v.createElement("script");B.onreadystatechange=function(){L(oe),B.onreadystatechange=null,C.removeChild(B),B=null},C.appendChild(B)}):function(oe){setTimeout(L,0,oe)},I.setImmediate=function(oe){"function"!=typeof oe&&(oe=new Function(""+oe));for(var B=new Array(arguments.length-1),j=0;j<B.length;j++)B[j]=arguments[j+1];return d[m]={callback:oe,args:B},p(m),m++},I.clearImmediate=T}function T(oe){delete d[oe]}function L(oe){if(_)setTimeout(L,0,oe);else{var B=d[oe];if(B){_=!0;try{!function(j){var z=j.callback,te=j.args;switch(te.length){case 0:z();break;case 1:z(te[0]);break;case 2:z(te[0],te[1]);break;case 3:z(te[0],te[1],te[2]);break;default:z.apply(undefined,te)}}(B)}finally{T(oe),_=!1}}}}function Y(oe){oe.source===D&&"string"==typeof oe.data&&0===oe.data.indexOf(S)&&L(+oe.data.slice(S.length))}}("undefined"==typeof self?void 0===O?this:O:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9263:(Xe,N,q)=>{var M=q(9209),O=q(966);function D(f){this._init(f)}D.prototype={_init:function(f){f=f||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=f.onData,this._onEndCallback=f.onEnd},_createTable:function(){for(var f=O.createBuffer(8,M.TABLE_LENGTH),p=0;p<M.TABLE_LENGTH;p++)f[p]=M.BASE62TABLE.charCodeAt(p);return f},_onData:function(f,p){var C=O.bufferToString_fast(f,p);this._onDataCallback?this._onDataCallback(C):this._result+=C},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var f=2,p=this._data,C=this._offset,x=M.BUFFER_MAX;if(this._dataLen-C<x&&(x=this._dataLen-C),f>x)return!1;var _,v,I,T,L,S=C-M.WINDOW_BUFFER_MAX,m=p.substring(S,C+x),d=C+f-3-S;do{if(2===f){if(v=p.charAt(C)+p.charAt(C+1),!~(I=m.indexOf(v))||I>d)break}else 3===f?v+=p.charAt(C+2):v=p.substr(C,f);if(!~(T=M.STRING_LASTINDEXOF_BUG?p.substring(S,C+f-1).lastIndexOf(v):m.lastIndexOf(v,d)))break;L=T,_=S+T;do{if(p.charCodeAt(C+f)!==p.charCodeAt(_+f))break}while(++f<x);if(I===T){f++;break}}while(++f<x);return 2!==f&&(this._index=M.WINDOW_BUFFER_MAX-L,this._length=f-1,!0)},compress:function(f){if(null==f||0===f.length)return"";var p,C=this._createTable(),x=O.createWindow(),S=O.createBuffer(8,M.COMPRESS_CHUNK_SIZE),m=0;this._result="",this._offset=x.length,this._data=x+f,this._dataLen=this._data.length,x=f=null;for(var v,I,T,L,Y,d=-1,_=-1;this._offset<this._dataLen;)this._search()?(this._index<M.BUFFER_MAX?(I=this._index,T=0):T=(this._index-(I=this._index%M.BUFFER_MAX))/M.BUFFER_MAX,2===this._length?(S[m++]=C[T+M.COMPRESS_FIXED_START],S[m++]=C[I]):(S[m++]=C[T+M.COMPRESS_START],S[m++]=C[I],S[m++]=C[this._length]),this._offset+=this._length,~_&&(_=-1)):(v=this._data.charCodeAt(this._offset++))<M.LATIN_BUFFER_MAX?(v<M.UNICODE_CHAR_MAX?(I=v,T=0,d=M.LATIN_INDEX):d=(T=(v-(I=v%M.UNICODE_CHAR_MAX))/M.UNICODE_CHAR_MAX)+M.LATIN_INDEX,_===d?S[m++]=C[I]:(S[m++]=C[d-M.LATIN_INDEX_START],S[m++]=C[I],_=d)):(v<M.UNICODE_BUFFER_MAX?(I=v,T=0,d=M.UNICODE_INDEX):d=(T=(v-(I=v%M.UNICODE_BUFFER_MAX))/M.UNICODE_BUFFER_MAX)+M.UNICODE_INDEX,I<M.UNICODE_CHAR_MAX?(L=I,Y=0):Y=(I-(L=I%M.UNICODE_CHAR_MAX))/M.UNICODE_CHAR_MAX,_===d?(S[m++]=C[L],S[m++]=C[Y]):(S[m++]=C[M.CHAR_START],S[m++]=C[d-M.TABLE_LENGTH],S[m++]=C[L],S[m++]=C[Y],_=d)),m>=M.COMPRESS_CHUNK_MAX&&(this._onData(S,m),m=0);return m>0&&this._onData(S,m),this._onEnd(),p=this._result,this._result=null,null===p?"":p}},Xe.exports=D},9209:(Xe,N)=>{var q=N.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,M=!1,O=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(M=!0)}catch(oe){}if(q)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(O=!0)}catch(oe){}N.CAN_CHARCODE_APPLY=M,N.CAN_CHARCODE_APPLY_TYPED=O;var D=N.APPLY_BUFFER_SIZE=65533;N.APPLY_BUFFER_SIZE_OK=null;var f=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(f=!0),N.STRING_LASTINDEXOF_BUG=f;var p=N.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",C=N.TABLE_LENGTH=p.length,x=Math.max(C,62)-Math.min(C,62);N.BUFFER_MAX=C-1;var S=N.WINDOW_MAX=1024;N.WINDOW_BUFFER_MAX=304;var m=N.COMPRESS_CHUNK_SIZE=D;N.COMPRESS_CHUNK_MAX=m-C;var d=N.DECOMPRESS_CHUNK_SIZE=D;N.DECOMPRESS_CHUNK_MAX=d+2*S,N.LATIN_BUFFER_MAX=132;var v=N.UNICODE_CHAR_MAX=40;N.UNICODE_BUFFER_MAX=v*(v+1),N.LATIN_INDEX=C+1,N.LATIN_INDEX_START=x+20,N.UNICODE_INDEX=C+5,N.DECODE_MAX=C-x-19;var I=N.LATIN_DECODE_MAX=v+7,T=N.CHAR_START=I+1,L=N.COMPRESS_START=T+1,Y=N.COMPRESS_FIXED_START=L+5;N.COMPRESS_INDEX=Y+5},9727:(Xe,N,q)=>{var M=q(9209),O=q(966);function D(f){this._init(f)}D.prototype={_init:function(f){f=f||{},this._result=null,this._onDataCallback=f.onData,this._onEndCallback=f.onEnd},_createTable:function(){for(var f={},p=0;p<M.TABLE_LENGTH;p++)f[M.BASE62TABLE.charAt(p)]=p;return f},_onData:function(f){var p;if(this._onDataCallback){if(f)p=this._result,this._result=[];else{var C=M.DECOMPRESS_CHUNK_SIZE-M.WINDOW_MAX;p=this._result.slice(M.WINDOW_MAX,M.WINDOW_MAX+C),this._result=this._result.slice(0,M.WINDOW_MAX).concat(this._result.slice(M.WINDOW_MAX+C))}p.length>0&&this._onDataCallback(O.bufferToString_fast(p))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(f){if(null==f||0===f.length)return"";this._result=O.stringToArray(O.createWindow());for(var p,_,v,I,L,Y,oe,B,j,z,C=this._createTable(),x=!1,S=null,m=f.length,d=0;d<m;d++)if(void 0!==(v=C[f.charAt(d)])){if(v<M.DECODE_MAX)L=x?C[f.charAt(++d)]*M.UNICODE_CHAR_MAX+v+M.UNICODE_BUFFER_MAX*S:S*M.UNICODE_CHAR_MAX+v,this._result[this._result.length]=L;else if(v<M.LATIN_DECODE_MAX)S=v-M.DECODE_MAX,x=!1;else if(v===M.CHAR_START)S=(I=C[f.charAt(++d)])-5,x=!0;else if(v<M.COMPRESS_INDEX){if(I=C[f.charAt(++d)],v<M.COMPRESS_FIXED_START?(Y=(v-M.COMPRESS_START)*M.BUFFER_MAX+I,oe=C[f.charAt(++d)]):(Y=(v-M.COMPRESS_FIXED_START)*M.BUFFER_MAX+I,oe=2),(B=this._result.slice(-Y)).length>oe&&(B.length=oe),j=B.length,B.length>0)for(z=0;z<oe;)for(_=0;_<j&&(this._result[this._result.length]=B[_],!(++z>=oe));_++);S=null}this._result.length>=M.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(M.WINDOW_MAX),this._onData(!0),this._onEnd(),p=O.bufferToString_fast(this._result),this._result=null,p}},Xe.exports=D},8497:(Xe,N,q)=>{var M=q(9263),O=q(9727);q(1014),N.n=function(D,f){return new M(f).compress(D)},N.L=function(D,f){return new O(f).decompress(D)}},966:(Xe,N,q)=>{var M=q(9209),O=String.fromCharCode;N.createBuffer=function(C,x){if(!M.HAS_TYPED)return new Array(x);switch(C){case 8:return new Uint8Array(x);case 16:return new Uint16Array(x)}};var D=N.truncateBuffer=function(C,x){return C.length===x?C:C.subarray?C.subarray(0,x):(C.length=x,C)};N.bufferToString_fast=function(C,x){if(null==x?x=C.length:C=D(C,x),M.CAN_CHARCODE_APPLY&&M.CAN_CHARCODE_APPLY_TYPED){var S=C.length;if(S<M.APPLY_BUFFER_SIZE&&M.APPLY_BUFFER_SIZE_OK)return O.apply(null,C);if(null===M.APPLY_BUFFER_SIZE_OK)try{var m=O.apply(null,C);return S>M.APPLY_BUFFER_SIZE&&(M.APPLY_BUFFER_SIZE_OK=!0),m}catch(d){M.APPLY_BUFFER_SIZE_OK=!1}}return f(C)};var f=N.bufferToString_chunked=function(C){for(var d,x="",S=C.length,m=0;m<S;){if(d=C.subarray?C.subarray(m,m+M.APPLY_BUFFER_SIZE):C.slice(m,m+M.APPLY_BUFFER_SIZE),m+=M.APPLY_BUFFER_SIZE,!M.APPLY_BUFFER_SIZE_OK){if(null===M.APPLY_BUFFER_SIZE_OK)try{x+=O.apply(null,d),d.length>M.APPLY_BUFFER_SIZE&&(M.APPLY_BUFFER_SIZE_OK=!0);continue}catch(_){M.APPLY_BUFFER_SIZE_OK=!1}return p(C)}x+=O.apply(null,d)}return x},p=N.bufferToString_slow=function(C){for(var x="",S=C.length,m=0;m<S;m++)x+=O(C[m]);return x};N.stringToArray=function(C){for(var x=[],S=C&&C.length,m=0;m<S;m++)x[m]=C.charCodeAt(m);return x},N.createWindow=function(){for(var C=M.WINDOW_MAX>>7,x="        ";!(C&M.WINDOW_MAX);)x+=x,C<<=1;return x}},2391:(Xe,N,q)=>{N.encode=q(8048).encode,N.decode=q(9175).decode,q(7704),q(8131),q(1490),q(9234)},2295:function(Xe){function N(q){return q&&q.isBuffer&&q}Xe.exports=N("undefined"!=typeof Buffer&&Buffer)||N(this.Buffer)||N("undefined"!=typeof window&&window.Buffer)||this.Buffer},7625:(Xe,N)=>{N.copy=function D(f,p,C,x){var S;C||(C=0),!x&&0!==x&&(x=this.length),p||(p=0);var m=x-C;if(f===this&&C<p&&p<x)for(S=m-1;S>=0;S--)f[S+p]=this[S+C];else for(S=0;S<m;S++)f[S+p]=this[S+C];return m},N.toString=function O(f,p,C){var x=this,S=0|p;C||(C=x.length);for(var m="",d=0;S<C;)(d=x[S++])<128?m+=String.fromCharCode(d):(192==(224&d)?d=(31&d)<<6|63&x[S++]:224==(240&d)?d=(15&d)<<12|(63&x[S++])<<6|63&x[S++]:240==(248&d)&&(d=(7&d)<<18|(63&x[S++])<<12|(63&x[S++])<<6|63&x[S++]),d>=65536?(d-=65536,m+=String.fromCharCode(55296+(d>>>10),56320+(1023&d))):m+=String.fromCharCode(d));return m},N.write=function M(f,p){for(var C=this,x=p||(p|=0),S=f.length,m=0,d=0;d<S;)(m=f.charCodeAt(d++))<128?C[x++]=m:m<2048?(C[x++]=192|m>>>6,C[x++]=128|63&m):m<55296||m>57343?(C[x++]=224|m>>>12,C[x++]=128|m>>>6&63,C[x++]=128|63&m):(m=65536+(m-55296<<10|f.charCodeAt(d++)-56320),C[x++]=240|m>>>18,C[x++]=128|m>>>12&63,C[x++]=128|m>>>6&63,C[x++]=128|63&m);return x-p}},1864:(Xe,N,q)=>{var M=q(6093),O=Xe.exports=D(0);function D(p){return new Array(p)}O.alloc=D,O.concat=M.concat,O.from=function f(p){if(!M.isBuffer(p)&&M.isView(p))p=M.Uint8Array.from(p);else if(M.isArrayBuffer(p))p=new Uint8Array(p);else{if("string"==typeof p)return M.from.call(O,p);if("number"==typeof p)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(p)}},1884:(Xe,N,q)=>{var M=q(6093),O=M.global,D=Xe.exports=M.hasBuffer?f(0):[];function f(C){return new O(C)}D.alloc=M.hasBuffer&&O.alloc||f,D.concat=M.concat,D.from=function p(C){if(!M.isBuffer(C)&&M.isView(C))C=M.Uint8Array.from(C);else if(M.isArrayBuffer(C))C=new Uint8Array(C);else{if("string"==typeof C)return M.from.call(D,C);if("number"==typeof C)throw new TypeError('"value" argument must not be a number')}return O.from&&1!==O.from.length?O.from(C):new O(C)}},5364:(Xe,N,q)=>{var M=q(7625);N.copy=C,N.slice=x,N.toString=function S(d,_,v){var I=!f&&O.isBuffer(this)?this.toString:M.toString;return I.apply(this,arguments)},N.write=function m(d){return function _(){return(this[d]||M[d]).apply(this,arguments)}}("write");var O=q(6093),D=O.global,f=O.hasBuffer&&"TYPED_ARRAY_SUPPORT"in D,p=f&&!D.TYPED_ARRAY_SUPPORT;function C(d,_,v,I){var T=O.isBuffer(this),L=O.isBuffer(d);if(T&&L)return this.copy(d,_,v,I);if(p||T||L||!O.isView(this)||!O.isView(d))return M.copy.call(this,d,_,v,I);var Y=v||null!=I?x.call(this,v,I):this;return d.set(Y,_),Y.length}function x(d,_){var v=this.slice||!p&&this.subarray;if(v)return v.call(this,d,_);var I=O.alloc.call(this,_-d);return C.call(this,I,0,d,_),I}},5321:(Xe,N,q)=>{var M=q(6093),O=Xe.exports=M.hasArrayBuffer?D(0):[];function D(p){return new Uint8Array(p)}O.alloc=D,O.concat=M.concat,O.from=function f(p){if(M.isView(p)){var C=p.byteOffset,x=p.byteLength;(p=p.buffer).byteLength!==x&&(p.slice?p=p.slice(C,C+x):(p=new Uint8Array(p)).byteLength!==x&&(p=Array.prototype.slice.call(p,C,C+x)))}else{if("string"==typeof p)return M.from.call(O,p);if("number"==typeof p)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(p)}},6093:(Xe,N,q)=>{var M=N.global=q(2295),O=N.hasBuffer=M&&!!M.isBuffer,D=N.hasArrayBuffer="undefined"!=typeof ArrayBuffer,f=N.isArray=q(6425);N.isArrayBuffer=D?function L(z){return z instanceof ArrayBuffer||T(z)}:B;var p=N.isBuffer=O?M.isBuffer:B,C=N.isView=D?ArrayBuffer.isView||j("ArrayBuffer","buffer"):B;N.alloc=v,N.concat=function I(z,te){te||(te=0,Array.prototype.forEach.call(z,function $(b){te+=b.length}));var K=v.call(this!==N&&this||z[0],te),Ce=0;return Array.prototype.forEach.call(z,function ae(b){Ce+=d.copy.call(b,K,Ce)}),K},N.from=function _(z){return"string"==typeof z?Y.call(this,z):oe(this).from(z)};var x=N.Array=q(1864),S=N.Buffer=q(1884),m=N.Uint8Array=q(5321),d=N.prototype=q(5364);function v(z){return oe(this).alloc(z)}var T=j("ArrayBuffer");function Y(z){var te=3*z.length,ne=v.call(this,te),K=d.write.call(ne,z);return te!==K&&(ne=d.slice.call(ne,0,K)),ne}function oe(z){return p(z)?S:C(z)?m:f(z)?x:O?S:D?m:x}function B(){return!1}function j(z,te){return z="[object "+z+"]",function(ne){return null!=ne&&{}.toString.call(te?ne[te]:ne)===z}}},5166:(Xe,N,q)=>{var M=q(6425);N.createCodec=S,N.install=function f(m){for(var d in m)D.prototype[d]=p(D.prototype[d],m[d])},N.filter=function x(m){return M(m)?function C(m){return m=m.slice(),function(_){return m.reduce(d,_)};function d(_,v){return v(_)}}(m):m};var O=q(6093);function D(m){if(!(this instanceof D))return new D(m);this.options=m,this.init()}function p(m,d){return m&&d?function _(){return m.apply(this,arguments),d.apply(this,arguments)}:m||d}function S(m){return new D(m)}D.prototype.init=function(){var m=this.options;return m&&m.uint8array&&(this.bufferish=O.Uint8Array),this},N.preset=S({preset:!0})},9234:(Xe,N,q)=>{q(8334),q(2732),q(5166)},5333:(Xe,N,q)=>{N.T=D;var M=q(8334).preset;function D(f){if(!(this instanceof D))return new D(f);if(f&&(this.options=f,f.codec)){var p=this.codec=f.codec;p.bufferish&&(this.bufferish=p.bufferish)}}q(6473).k.mixin(D.prototype),D.prototype.codec=M,D.prototype.fetch=function(){return this.codec.decode(this)}},9175:(Xe,N,q)=>{N.decode=function O(D,f){var p=new M(f);return p.write(D),p.read()};var M=q(5333).T},8131:(Xe,N,q)=>{var O=q(6654),D=q(5333).T;function f(p){if(!(this instanceof f))return new f(p);D.call(this,p)}f.prototype=new D,O.mixin(f.prototype),f.prototype.decode=function(p){arguments.length&&this.write(p),this.flush()},f.prototype.push=function(p){this.emit("data",p)},f.prototype.end=function(p){this.decode(p),this.emit("end")}},8400:(Xe,N,q)=>{N.F=D;var M=q(2732).preset;function D(f){if(!(this instanceof D))return new D(f);if(f&&(this.options=f,f.codec)){var p=this.codec=f.codec;p.bufferish&&(this.bufferish=p.bufferish)}}q(6473).I.mixin(D.prototype),D.prototype.codec=M,D.prototype.write=function(f){this.codec.encode(this,f)}},8048:(Xe,N,q)=>{N.encode=function O(D,f){var p=new M(f);return p.write(D),p.read()};var M=q(8400).F},7704:(Xe,N,q)=>{var O=q(6654),D=q(8400).F;function f(p){if(!(this instanceof f))return new f(p);D.call(this,p)}f.prototype=new D,O.mixin(f.prototype),f.prototype.encode=function(p){this.write(p),this.emit("data",this.read())},f.prototype.end=function(p){arguments.length&&this.encode(p),this.flush(),this.emit("end")}},7846:(Xe,N,q)=>{N.S=function O(D,f){if(!(this instanceof O))return new O(D,f);this.buffer=M.from(D),this.type=f};var M=q(6093)},4106:(Xe,N,q)=>{N.setExtPackers=function C(_){_.addExtPacker(14,Error,[d,x]),_.addExtPacker(1,EvalError,[d,x]),_.addExtPacker(2,RangeError,[d,x]),_.addExtPacker(3,ReferenceError,[d,x]),_.addExtPacker(4,SyntaxError,[d,x]),_.addExtPacker(5,TypeError,[d,x]),_.addExtPacker(6,URIError,[d,x]),_.addExtPacker(10,RegExp,[m,x]),_.addExtPacker(11,Boolean,[S,x]),_.addExtPacker(12,String,[S,x]),_.addExtPacker(13,Date,[Number,x]),_.addExtPacker(15,Number,[S,x]),"undefined"!=typeof Uint8Array&&(_.addExtPacker(17,Int8Array,D),_.addExtPacker(18,Uint8Array,D),_.addExtPacker(19,Int16Array,D),_.addExtPacker(20,Uint16Array,D),_.addExtPacker(21,Int32Array,D),_.addExtPacker(22,Uint32Array,D),_.addExtPacker(23,Float32Array,D),"undefined"!=typeof Float64Array&&_.addExtPacker(24,Float64Array,D),"undefined"!=typeof Uint8ClampedArray&&_.addExtPacker(25,Uint8ClampedArray,D),_.addExtPacker(26,ArrayBuffer,D),_.addExtPacker(29,DataView,D)),M.hasBuffer&&_.addExtPacker(27,O,M.from)};var f,M=q(6093),O=M.global,D=M.Uint8Array.from,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function x(_){return f||(f=q(8048).encode),f(_)}function S(_){return _.valueOf()}function m(_){(_=RegExp.prototype.toString.call(_).split("/")).shift();var v=[_.pop()];return v.unshift(_.join("/")),v}function d(_){var v={};for(var I in p)v[I]=_[I];return v}},9146:(Xe,N,q)=>{N.setExtUnpackers=function p(_){_.addExtUnpacker(14,[C,S(Error)]),_.addExtUnpacker(1,[C,S(EvalError)]),_.addExtUnpacker(2,[C,S(RangeError)]),_.addExtUnpacker(3,[C,S(ReferenceError)]),_.addExtUnpacker(4,[C,S(SyntaxError)]),_.addExtUnpacker(5,[C,S(TypeError)]),_.addExtUnpacker(6,[C,S(URIError)]),_.addExtUnpacker(10,[C,x]),_.addExtUnpacker(11,[C,m(Boolean)]),_.addExtUnpacker(12,[C,m(String)]),_.addExtUnpacker(13,[C,m(Date)]),_.addExtUnpacker(15,[C,m(Number)]),"undefined"!=typeof Uint8Array&&(_.addExtUnpacker(17,m(Int8Array)),_.addExtUnpacker(18,m(Uint8Array)),_.addExtUnpacker(19,[d,m(Int16Array)]),_.addExtUnpacker(20,[d,m(Uint16Array)]),_.addExtUnpacker(21,[d,m(Int32Array)]),_.addExtUnpacker(22,[d,m(Uint32Array)]),_.addExtUnpacker(23,[d,m(Float32Array)]),"undefined"!=typeof Float64Array&&_.addExtUnpacker(24,[d,m(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&_.addExtUnpacker(25,m(Uint8ClampedArray)),_.addExtUnpacker(26,d),_.addExtUnpacker(29,[d,m(DataView)])),M.hasBuffer&&_.addExtUnpacker(27,m(O))};var D,M=q(6093),O=M.global,f={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function C(_){return D||(D=q(9175).decode),D(_)}function x(_){return RegExp.apply(null,_)}function S(_){return function(v){var I=new _;for(var T in f)I[T]=v[T];return I}}function m(_){return function(v){return new _(v)}}function d(_){return new Uint8Array(_).buffer}},1490:(Xe,N,q)=>{q(8334),q(2732),q(5166)},6473:(Xe,N,q)=>{N.k=p,N.I=C;var M=q(6093),f="BUFFER_SHORTAGE";function p(){if(!(this instanceof p))return new p}function C(){if(!(this instanceof C))return new C}function m(){throw new Error("method not implemented: write()")}function d(){throw new Error("method not implemented: fetch()")}function _(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function v(L){(this.buffers||(this.buffers=[])).push(L)}function I(){return(this.buffers||(this.buffers=[])).shift()}function T(L){return function Y(oe){for(var B in L)oe[B]=L[B];return oe}}p.mixin=T(function x(){return{bufferish:M,write:function L(B){var j=this.offset?M.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=j?B?this.bufferish.concat([j,B]):j:B,this.offset=0},fetch:d,flush:function Y(){for(;this.offset<this.buffer.length;){var j,B=this.offset;try{j=this.fetch()}catch(z){if(z&&z.message!=f)throw z;this.offset=B;break}this.push(j)}},push:v,pull:I,read:_,reserve:function oe(B){var j=this.offset,z=j+B;if(z>this.buffer.length)throw new Error(f);return this.offset=z,j},offset:0}}()),p.mixin(p.prototype),C.mixin=T(function S(){return{bufferish:M,write:m,fetch:function L(){var z=this.start;if(z<this.offset){var te=this.start=this.offset;return M.prototype.slice.call(this.buffer,z,te)}},flush:function Y(){for(;this.start<this.offset;){var z=this.fetch();z&&this.push(z)}},push:v,pull:function oe(){var z=this.buffers||(this.buffers=[]),te=z.length>1?this.bufferish.concat(z):z[0];return z.length=0,te},read:_,reserve:function B(z){var te=0|z;if(this.buffer){var ne=this.buffer.length,K=0|this.offset,Ce=K+te;if(Ce<ne)return this.offset=Ce,K;this.flush(),z=Math.max(z,Math.min(2*ne,this.maxBufferSize))}return z=Math.max(z,this.minBufferSize),this.buffer=this.bufferish.alloc(z),this.start=0,this.offset=te,0},send:function j(z){var te=z.length;if(te>this.minBufferSize)this.flush(),this.push(z);else{var ne=this.reserve(te);M.prototype.copy.call(z,this.buffer,ne)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),C.mixin(C.prototype)},8334:(Xe,N,q)=>{var M=q(7846).S,O=q(9146),D=q(4613).readUint8,f=q(1788),p=q(5166);function x(){var d=this.options;return this.decode=function C(d){var _=f.getReadToken(d);return function v(I){var T=D(I),L=_[T];if(!L)throw new Error("Invalid type: "+(T&&"0x"+T.toString(16)));return L(I)}}(d),d&&d.preset&&O.setExtUnpackers(this),this}p.install({addExtUnpacker:function S(d,_){(this.extUnpackers||(this.extUnpackers=[]))[d]=p.filter(_)},getExtUnpacker:function m(d){return(this.extUnpackers||(this.extUnpackers=[]))[d]||function v(I){return new M(I,d)}},init:x}),N.preset=x.call(p.preset)},4613:(Xe,N,q)=>{var M=q(8461),O=q(6256),D=O.Uint64BE,f=O.Int64BE;N.getReadFormat=function m(ce){var _e=ce&&ce.int64;return{map:x&&ce&&ce.usemap?_:d,array:v,str:I,bin:p.hasArrayBuffer&&ce&&ce.binarraybuffer?L:T,ext:Y,uint8:oe,uint16:j,uint32:te,uint64:K(8,_e?ae:Ce),int8:B,int16:z,int32:ne,int64:K(8,_e?b:$),float32:K(4,fe),float64:K(8,Ne)}},N.readUint8=oe;var p=q(6093),C=q(5364),x="undefined"!=typeof Map;function d(ce,ke){var xe,_e={},he=new Array(ke),pe=new Array(ke),Je=ce.codec.decode;for(xe=0;xe<ke;xe++)he[xe]=Je(ce),pe[xe]=Je(ce);for(xe=0;xe<ke;xe++)_e[he[xe]]=pe[xe];return _e}function _(ce,ke){var xe,_e=new Map,he=new Array(ke),pe=new Array(ke),Je=ce.codec.decode;for(xe=0;xe<ke;xe++)he[xe]=Je(ce),pe[xe]=Je(ce);for(xe=0;xe<ke;xe++)_e.set(he[xe],pe[xe]);return _e}function v(ce,ke){for(var _e=new Array(ke),xe=ce.codec.decode,he=0;he<ke;he++)_e[he]=xe(ce);return _e}function I(ce,ke){var _e=ce.reserve(ke);return C.toString.call(ce.buffer,"utf-8",_e,_e+ke)}function T(ce,ke){var _e=ce.reserve(ke),he=C.slice.call(ce.buffer,_e,_e+ke);return p.from(he)}function L(ce,ke){var _e=ce.reserve(ke),he=C.slice.call(ce.buffer,_e,_e+ke);return p.Uint8Array.from(he).buffer}function Y(ce,ke){var _e=ce.reserve(ke+1),xe=ce.buffer[_e++],he=_e+ke,pe=ce.codec.getExtUnpacker(xe);if(!pe)throw new Error("Invalid ext type: "+(xe&&"0x"+xe.toString(16)));return pe(C.slice.call(ce.buffer,_e,he))}function oe(ce){var ke=ce.reserve(1);return ce.buffer[ke]}function B(ce){var ke=ce.reserve(1),_e=ce.buffer[ke];return 128&_e?_e-256:_e}function j(ce){var ke=ce.reserve(2),_e=ce.buffer;return _e[ke++]<<8|_e[ke]}function z(ce){var ke=ce.reserve(2),_e=ce.buffer,xe=_e[ke++]<<8|_e[ke];return 32768&xe?xe-65536:xe}function te(ce){var ke=ce.reserve(4),_e=ce.buffer;return 16777216*_e[ke++]+(_e[ke++]<<16)+(_e[ke++]<<8)+_e[ke]}function ne(ce){var ke=ce.reserve(4),_e=ce.buffer;return _e[ke++]<<24|_e[ke++]<<16|_e[ke++]<<8|_e[ke]}function K(ce,ke){return function(_e){var xe=_e.reserve(ce);return ke.call(_e.buffer,xe,!0)}}function Ce(ce){return new D(this,ce).toNumber()}function $(ce){return new f(this,ce).toNumber()}function ae(ce){return new D(this,ce)}function b(ce){return new f(this,ce)}function fe(ce){return M.read(this,ce,!1,23,4)}function Ne(ce){return M.read(this,ce,!1,52,8)}},1788:(Xe,N,q)=>{var M=q(4613);function D(S){var m,d=new Array(256);for(m=0;m<=127;m++)d[m]=p(m);for(m=128;m<=143;m++)d[m]=x(m-128,S.map);for(m=144;m<=159;m++)d[m]=x(m-144,S.array);for(m=160;m<=191;m++)d[m]=x(m-160,S.str);for(d[192]=p(null),d[193]=null,d[194]=p(!1),d[195]=p(!0),d[196]=C(S.uint8,S.bin),d[197]=C(S.uint16,S.bin),d[198]=C(S.uint32,S.bin),d[199]=C(S.uint8,S.ext),d[200]=C(S.uint16,S.ext),d[201]=C(S.uint32,S.ext),d[202]=S.float32,d[203]=S.float64,d[204]=S.uint8,d[205]=S.uint16,d[206]=S.uint32,d[207]=S.uint64,d[208]=S.int8,d[209]=S.int16,d[210]=S.int32,d[211]=S.int64,d[212]=x(1,S.ext),d[213]=x(2,S.ext),d[214]=x(4,S.ext),d[215]=x(8,S.ext),d[216]=x(16,S.ext),d[217]=C(S.uint8,S.str),d[218]=C(S.uint16,S.str),d[219]=C(S.uint32,S.str),d[220]=C(S.uint16,S.array),d[221]=C(S.uint32,S.array),d[222]=C(S.uint16,S.map),d[223]=C(S.uint32,S.map),m=224;m<=255;m++)d[m]=p(m-256);return d}function p(S){return function(){return S}}function C(S,m){return function(d){var _=S(d);return m(d,_)}}function x(S,m){return function(d){return m(d,S)}}N.getReadToken=function O(S){var m=M.getReadFormat(S);return S&&S.useraw?function f(S){var m,d=D(S).slice();for(d[217]=d[196],d[218]=d[197],d[219]=d[198],m=160;m<=191;m++)d[m]=x(m-160,S.bin);return d}(m):D(m)}},2732:(Xe,N,q)=>{var M=q(7846).S,O=q(4106),D=q(9118),f=q(5166);function C(){var m=this.options;return this.encode=function p(m){var d=D.getWriteType(m);return function _(v,I){var T=d[typeof I];if(!T)throw new Error('Unsupported type "'+typeof I+'": '+I);T(v,I)}}(m),m&&m.preset&&O.setExtPackers(this),this}f.install({addExtPacker:function x(m,d,_){_=f.filter(_);var v=d.name;function L(Y){return _&&(Y=_(Y)),new M(Y,m)}v&&"Object"!==v?(this.extPackers||(this.extPackers={}))[v]=L:(this.extEncoderList||(this.extEncoderList=[])).unshift([d,L])},getExtPacker:function S(m){var d=this.extPackers||(this.extPackers={}),_=m.constructor,v=_&&_.name&&d[_.name];if(v)return v;for(var I=this.extEncoderList||(this.extEncoderList=[]),T=I.length,L=0;L<T;L++){var Y=I[L];if(_===Y[0])return Y[1]}},init:C}),N.preset=C.call(f.preset)},3041:(Xe,N,q)=>{var M=q(8461),O=q(6256),D=O.Uint64BE,f=O.Int64BE,p=q(8323).w,C=q(6093),x=C.global,m=C.hasBuffer&&"TYPED_ARRAY_SUPPORT"in x&&!x.TYPED_ARRAY_SUPPORT,d=C.hasBuffer&&x.prototype||{};function I(){var K=p.slice();return K[196]=L(196),K[197]=Y(197),K[198]=oe(198),K[199]=L(199),K[200]=Y(200),K[201]=oe(201),K[202]=B(202,4,d.writeFloatBE||te,!0),K[203]=B(203,8,d.writeDoubleBE||ne,!0),K[204]=L(204),K[205]=Y(205),K[206]=oe(206),K[207]=B(207,8,j),K[208]=L(208),K[209]=Y(209),K[210]=oe(210),K[211]=B(211,8,z),K[217]=L(217),K[218]=Y(218),K[219]=oe(219),K[220]=Y(220),K[221]=oe(221),K[222]=Y(222),K[223]=oe(223),K}function L(K){return function(Ce,$){var ae=Ce.reserve(2),b=Ce.buffer;b[ae++]=K,b[ae]=$}}function Y(K){return function(Ce,$){var ae=Ce.reserve(3),b=Ce.buffer;b[ae++]=K,b[ae++]=$>>>8,b[ae]=$}}function oe(K){return function(Ce,$){var ae=Ce.reserve(5),b=Ce.buffer;b[ae++]=K,b[ae++]=$>>>24,b[ae++]=$>>>16,b[ae++]=$>>>8,b[ae]=$}}function B(K,Ce,$,ae){return function(b,fe){var Ne=b.reserve(Ce+1);b.buffer[Ne++]=K,$.call(b.buffer,fe,Ne,ae)}}function j(K,Ce){new D(this,Ce,K)}function z(K,Ce){new f(this,Ce,K)}function te(K,Ce){M.write(this,K,Ce,!1,23,4)}function ne(K,Ce){M.write(this,K,Ce,!1,52,8)}N.getWriteToken=function _(K){return K&&K.uint8array?function v(){var K=I();return K[202]=B(202,4,te),K[203]=B(203,8,ne),K}():m||C.hasBuffer&&K&&K.safe?function T(){var K=p.slice();return K[196]=B(196,1,x.prototype.writeUInt8),K[197]=B(197,2,x.prototype.writeUInt16BE),K[198]=B(198,4,x.prototype.writeUInt32BE),K[199]=B(199,1,x.prototype.writeUInt8),K[200]=B(200,2,x.prototype.writeUInt16BE),K[201]=B(201,4,x.prototype.writeUInt32BE),K[202]=B(202,4,x.prototype.writeFloatBE),K[203]=B(203,8,x.prototype.writeDoubleBE),K[204]=B(204,1,x.prototype.writeUInt8),K[205]=B(205,2,x.prototype.writeUInt16BE),K[206]=B(206,4,x.prototype.writeUInt32BE),K[207]=B(207,8,j),K[208]=B(208,1,x.prototype.writeInt8),K[209]=B(209,2,x.prototype.writeInt16BE),K[210]=B(210,4,x.prototype.writeInt32BE),K[211]=B(211,8,z),K[217]=B(217,1,x.prototype.writeUInt8),K[218]=B(218,2,x.prototype.writeUInt16BE),K[219]=B(219,4,x.prototype.writeUInt32BE),K[220]=B(220,2,x.prototype.writeUInt16BE),K[221]=B(221,4,x.prototype.writeUInt32BE),K[222]=B(222,2,x.prototype.writeUInt16BE),K[223]=B(223,4,x.prototype.writeUInt32BE),K}():I()}},9118:(Xe,N,q)=>{var M=q(6425),O=q(6256),D=O.Uint64BE,f=O.Int64BE,p=q(6093),C=q(5364),x=q(3041),S=q(8323).w,m=q(7846).S,d="undefined"!=typeof Uint8Array,_="undefined"!=typeof Map,v=[];v[1]=212,v[2]=213,v[4]=214,v[8]=215,v[16]=216,N.getWriteType=function I(T){var L=x.getWriteToken(T),Y=T&&T.useraw,oe=d&&T&&T.binarraybuffer,B=oe?p.isArrayBuffer:p.isBuffer,j=oe?function pe(Le,De){he(Le,new Uint8Array(De))}:he,te=_&&T&&T.usemap?function Re(Le,De){if(!(De instanceof Map))return Ve(Le,De);var Pe=De.size;L[Pe<16?128+Pe:Pe<=65535?222:223](Le,Pe);var tt=Le.codec.encode;De.forEach(function(Zt,bt,y){tt(Le,bt),tt(Le,Zt)})}:Ve;return{boolean:function K(Le,De){L[De?195:194](Le,De)},function:_e,number:function Ce(Le,De){var Pe=0|De;De===Pe?L[-32<=Pe&&Pe<=127?255&Pe:0<=Pe?Pe<=255?204:Pe<=65535?205:206:-128<=Pe?208:-32768<=Pe?209:210](Le,Pe):L[203](Le,De)},object:Y?function ke(Le,De){if(B(De))return function Wt(Le,De){var Pe=De.length;L[Pe<32?160+Pe:Pe<=65535?218:219](Le,Pe),Le.send(De)}(Le,De);ce(Le,De)}:ce,string:function Ne(Le){return function De(Pe,ut){var tt=ut.length;Pe.offset=Pe.reserve(5+3*tt);var bt=Pe.buffer,y=Le(tt),ge=Pe.offset+y;tt=C.write.call(bt,ut,ge);var X=Le(tt);y!==X&&C.copy.call(bt,bt,ge+X-y,ge,ge+tt),L[1===X?160+tt:X<=3?215+X:219](Pe,tt),Pe.offset+=tt}}(Y?function fe(Le){return Le<32?1:Le<=65535?3:5}:function b(Le){return Le<32?1:Le<=255?2:Le<=65535?3:5}),symbol:_e,undefined:_e};function ce(Le,De){if(null===De)return _e(Le,De);if(B(De))return j(Le,De);if(M(De))return function xe(Le,De){var Pe=De.length;L[Pe<16?144+Pe:Pe<=65535?220:221](Le,Pe);for(var tt=Le.codec.encode,Zt=0;Zt<Pe;Zt++)tt(Le,De[Zt])}(Le,De);if(D.isUint64BE(De))return function $(Le,De){L[207](Le,De.toArray())}(Le,De);if(f.isInt64BE(De))return function ae(Le,De){L[211](Le,De.toArray())}(Le,De);var Pe=Le.codec.getExtPacker(De);if(Pe&&(De=Pe(De)),De instanceof m)return function Je(Le,De){var Pe=De.buffer,ut=Pe.length;L[v[ut]||(ut<255?199:ut<=65535?200:201)](Le,ut),S[De.type](Le),Le.send(Pe)}(Le,De);te(Le,De)}function _e(Le,De){L[192](Le,De)}function he(Le,De){var Pe=De.length;L[Pe<255?196:Pe<=65535?197:198](Le,Pe),Le.send(De)}function Ve(Le,De){var Pe=Object.keys(De),ut=Pe.length;L[ut<16?128+ut:ut<=65535?222:223](Le,ut);var Zt=Le.codec.encode;Pe.forEach(function(bt){Zt(Le,bt),Zt(Le,De[bt])})}}},8323:(Xe,N)=>{for(var q=N.w=new Array(256),M=0;M<=255;M++)q[M]=O(M);function O(D){return function(f){var p=f.reserve(1);f.buffer[p]=D}}},1203:Xe=>{function N(D){var f="    ";if(isNaN(parseInt(D)))f=D;else switch(D){case 1:f=" ";break;case 2:f="  ";break;case 3:f="   ";break;case 4:f="    ";break;case 5:f="     ";break;case 6:f="      ";break;case 7:f="       ";break;case 8:f="        ";break;case 9:f="         ";break;case 10:f="          ";break;case 11:f="           ";break;case 12:f="            "}for(var p=["\n"],C=0;C<100;C++)p.push(p[C]+f);return p}function q(){this.step="    ",this.shift=N(this.step)}function M(D,f){return f-(D.replace(/\(/g,"").length-D.replace(/\)/g,"").length)}function O(D,f){return D.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+f+f+"AND ").replace(/ BETWEEN /gi,"~::~"+f+"BETWEEN ").replace(/ CASE /gi,"~::~"+f+"CASE ").replace(/ ELSE /gi,"~::~"+f+"ELSE ").replace(/ END /gi,"~::~"+f+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+f+"ON ").replace(/ OR /gi,"~::~"+f+f+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+f+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+f).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+f+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}q.prototype.xml=function(D,f){var p=D.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),C=p.length,x=!1,S=0,m="",d=0,_=f?N(f):this.shift;for(d=0;d<C;d++)p[d].search(/<!/)>-1?(m+=_[S]+p[d],x=!0,(p[d].search(/-->/)>-1||p[d].search(/\]>/)>-1||p[d].search(/!DOCTYPE/)>-1)&&(x=!1)):p[d].search(/-->/)>-1||p[d].search(/\]>/)>-1?(m+=p[d],x=!1):/^<\w/.exec(p[d-1])&&/^<\/\w/.exec(p[d])&&/^<[\w:\-\.\,]+/.exec(p[d-1])==/^<\/[\w:\-\.\,]+/.exec(p[d])[0].replace("/","")?(m+=p[d],x||S--):p[d].search(/<\w/)>-1&&-1==p[d].search(/<\//)&&-1==p[d].search(/\/>/)?m=m+=x?p[d]:_[S++]+p[d]:p[d].search(/<\w/)>-1&&p[d].search(/<\//)>-1?m=m+=x?p[d]:_[S]+p[d]:p[d].search(/<\//)>-1?m=m+=x?p[d]:_[--S]+p[d]:p[d].search(/\/>/)>-1?m=m+=x?p[d]:_[S]+p[d]:p[d].search(/<\?/)>-1||p[d].search(/xmlns\:/)>-1||p[d].search(/xmlns\=/)>-1?m+=_[S]+p[d]:m+=p[d];return"\n"==m[0]?m.slice(1):m},q.prototype.json=function(D,p){return p=p||this.step,"undefined"==typeof JSON?D:"string"==typeof D?JSON.stringify(JSON.parse(D),null,p):"object"==typeof D?JSON.stringify(D,null,p):D},q.prototype.css=function(D,f){var p=D.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),C=p.length,x=0,S="",m=0,d=f?N(f):this.shift;for(m=0;m<C;m++)/\{/.exec(p[m])?S+=d[x++]+p[m]:/\}/.exec(p[m])?S+=d[--x]+p[m]:(/\*\\/.exec(p[m]),S+=d[x]+p[m]);return S.replace(/^\n{1,}/,"")},q.prototype.sql=function(D,f){var p=D.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),C=p.length,x=[],S=0,m=this.step,v=0,I="",T=0,L=f?N(f):this.shift;for(T=0;T<C;T++)x=x.concat(T%2?p[T]:O(p[T],m));for(C=x.length,T=0;T<C;T++)v=M(x[T],v),/\s{0,}\s{0,}SELECT\s{0,}/.exec(x[T])&&(x[T]=x[T].replace(/\,/g,",\n"+m+m)),/\s{0,}\s{0,}SET\s{0,}/.exec(x[T])&&(x[T]=x[T].replace(/\,/g,",\n"+m+m)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(x[T])?I+=L[++S]+x[T]:/\'/.exec(x[T])?(v<1&&S&&S--,I+=x[T]):(I+=L[S]+x[T],v<1&&S&&S--);return I.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},q.prototype.xmlmin=function(D,f){return(f?D:D.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},q.prototype.jsonmin=function(D){return"undefined"==typeof JSON?D:JSON.stringify(JSON.parse(D),null,0)},q.prototype.cssmin=function(D,f){return(f?D:D.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},q.prototype.sqlmin=function(D){return D.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},Xe.exports=new q},2480:()=>{},5861:(Xe,N,q)=>{"use strict";function M(D,f,p,C,x,S,m){try{var d=D[S](m),_=d.value}catch(v){return void p(v)}d.done?f(_):Promise.resolve(_).then(C,x)}function O(D){return function(){var f=this,p=arguments;return new Promise(function(C,x){var S=D.apply(f,p);function m(_){M(S,C,x,m,d,"next",_)}function d(_){M(S,C,x,m,d,"throw",_)}m(void 0)})}}q.d(N,{Z:()=>O})},1014:Xe=>{"use strict";Xe.exports={}}},Xe=>{Xe(Xe.s=2745)}]);